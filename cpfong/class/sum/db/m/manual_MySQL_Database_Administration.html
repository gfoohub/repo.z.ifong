  <HTML>
  <HEAD>
  
  <TITLE>MySQL Reference Manual for version 5.0.3-alpha - 5  Database Administration</TITLE>
   <style> code {color:purple} tt {color:green} samp {color:navy} pre {color:maroon} </style>
  </HEAD>
  <BODY BGCOLOR=silver TEXT=#000000 LINK=#101090 VLINK=#7030B0>
Go to the <A HREF="manual_Introduction.html">first</A>, <A HREF="manual_Using_MySQL_Programs.html">previous</A>, <A HREF="manual_Replication.html">next</A>, <A HREF="manual_Concept_Index.html">last</A> section, <A HREF="manual_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="MySQL_Database_Administration" HREF="manual_toc.html#MySQL_Database_Administration">5  Database Administration</A></H1>

<P>
This chapter covers topics that deal with administering a MySQL installation,
such as configuring the server, managing user accounts, and performing backups.

</P>



<H2><A NAME="Server-Side_Scripts" HREF="manual_toc.html#Server-Side_Scripts">5.1  The MySQL Server and Server Startup Scripts</A></H2>

<P>
The MySQL server, <code>mysqld</code>, is the main program that does most of the
work in a MySQL installation. The server is accompanied by several related
scripts that perform setup operations when you install MySQL or that are
helper programs to assist you in starting and stopping the server.

</P>
<P>
This section provides an overview of the server and related programs, and
information about server startup scripts. Information about configuring the
server itself is given in section <A HREF="manual_MySQL_Database_Administration.html#Configuring_MySQL">5.2  Configuring the MySQL Server</A>.

</P>



<H3><A NAME="Server-Side_Overview" HREF="manual_toc.html#Server-Side_Overview">5.1.1  Overview of the Server-Side Scripts and Utilities</A></H3>

<P>
<A NAME="IDX423"></A>

</P>
<P>
All MySQL programs take many different options. However, every
MySQL program provides a <code>--help</code> option that you can use
to get a description of the program's options. For example, try
<code>mysqld --help</code>.

</P>
<P>
You can override default options for all standard programs by specifying
options on the command line or in an option file.
section <A HREF="manual_Using_MySQL_Programs.html#Program_Options">4.3  Specifying Program Options</A>.

</P>
<P>
The following list briefly describes the MySQL server and server-related
programs:

</P>
<DL COMPACT>

<DT><code>mysqld</code>
<DD>
<A NAME="IDX424"></A>
The SQL daemon (that is, the MySQL server). To use client programs, this
program must be running, because clients gain access to databases by
connecting to the server.
See section <A HREF="manual_MySQL_Database_Administration.html#Configuring_MySQL">5.2  Configuring the MySQL Server</A>.

<DT><code>mysqld-max</code>
<DD>
<A NAME="IDX425"></A>
A version of the server that includes additional features.
See section <A HREF="manual_MySQL_Database_Administration.html#mysqld-max">5.1.2  The <code>mysqld-max</code> Extended MySQL Server</A>.

<DT><code>mysqld_safe</code>
<DD>
<A NAME="IDX426"></A>
A server startup script.
<code>mysqld_safe</code> attempts to start <code>mysqld-max</code> if it exists, and
<code>mysqld</code> otherwise.
See section <A HREF="manual_MySQL_Database_Administration.html#mysqld_safe">5.1.3  The <code>mysqld_safe</code> Server Startup Script</A>.

<DT><code>mysql.server</code>
<DD>
<A NAME="IDX427"></A>
A server startup script.
This script is used on systems that use run directories containing scripts
that start system services for particular run levels. It invokes
<code>mysqld_safe</code> to start the MySQL server.
See section <A HREF="manual_MySQL_Database_Administration.html#mysql.server">5.1.4  The <code>mysql.server</code> Server Startup Script</A>.

<DT><code>mysqld_multi</code>
<DD>
<A NAME="IDX428"></A>
A server startup script that can start or stop multiple servers installed
on the system.
See section <A HREF="manual_MySQL_Database_Administration.html#mysqld_multi">5.1.5  The <code>mysqld_multi</code> Program for Managing Multiple MySQL Servers</A>.

<DT><code>mysql_install_db</code>
<DD>
<A NAME="IDX429"></A>
This script creates the MySQL grant tables with default privileges. It is
usually executed only once, when first installing MySQL on a system.

<DT><code>mysql_fix_privilege_tables</code>
<DD>
<A NAME="IDX430"></A>
This script is used after an upgrade install operation, to update the grant
tables with any changes that have been made in newer versions of MySQL.

</DL>

<P>
There are several other programs that also are run on the server host:

</P>

<DL COMPACT>

<DT><code>myisamchk</code>
<DD>
<A NAME="IDX431"></A>
A utility to describe, check, optimize, and repair <code>MyISAM</code> tables.
<code>myisamchk</code> is described in
section <A HREF="manual_MySQL_Database_Administration.html#Table_maintenance">5.7.2  Table Maintenance and Crash Recovery</A>.

<DT><code>make_binary_distribution</code>
<DD>
<A NAME="IDX432"></A>
This program makes a binary release of a compiled MySQL. This could be sent
by FTP to <tt>`/pub/mysql/upload/'</tt> on <code>ftp.mysql.com</code> for the
convenience of other MySQL users.

<DT><code>mysqlbug</code>
<DD>
<A NAME="IDX433"></A>
The MySQL bug reporting script.  It can be used to
send a bug report to the MySQL mailing list. (You can also visit
<a HREF="http://bugs.mysql.com/">http://bugs.mysql.com/</a> to file a bug report online.)

</DL>



<H3><A NAME="mysqld-max" HREF="manual_toc.html#mysqld-max">5.1.2  The <code>mysqld-max</code> Extended MySQL Server</A></H3>

<P>
<A NAME="IDX434"></A>

</P>
<P>
A MySQL-Max server is a version of the <code>mysqld</code> MySQL server that
has been built to include additional features.

</P>
<P>
The distribution to use depends on your platform:

</P>

<UL>
<LI>

For Windows, MySQL binary distributions include both the standard server
(<code>mysqld.exe</code>) and the MySQL-Max server (<code>mysqld-max.exe</code>), so you
need not get a special distribution. Just use a regular Windows
distribution, available at
<a HREF="http://dev.mysql.com/downloads/">http://dev.mysql.com/downloads/</a>.
See section <A HREF="manual_Installing.html#Windows_installation">2.3  Installing MySQL on Windows</A>.

<LI>

For Linux, if you install MySQL using RPM distributions, use the regular
<code>MySQL-server</code> RPM first to install a standard server named
<code>mysqld</code>.  Then use the <code>MySQL-Max</code> RPM to install a server named
<code>mysqld-max</code>.  The <code>MySQL-Max</code> RPM presupposes that you have
already installed the regular server RPM.  See section <A HREF="manual_Installing.html#Linux-RPM">2.4  Installing MySQL on Linux</A> for more
information on the Linux RPM packages.

<LI>

All other MySQL-Max distributions contain a single server that is named
<code>mysqld</code> but that has the additional features included.

</UL>

<P>
You can find the MySQL-Max binaries on the MySQL AB Web site at
<a HREF="http://dev.mysql.com/downloads/mysql-4.0.html">http://dev.mysql.com/downloads/mysql-4.0.html</a>.

</P>
<P>
MySQL AB builds the MySQL-Max servers by using the following
<code>configure</code> options:

</P>
<DL COMPACT>

<DT><code>--with-server-suffix=-max</code>
<DD>
This option adds a <code>-max</code> suffix to the <code>mysqld</code> version string.

<DT><code>--with-innodb</code>
<DD>
This option enables support for the <code>InnoDB</code> storage engine.  MySQL-Max
servers always include <code>InnoDB</code> support, but this option actually is
needed only for MySQL 3.23.  From MySQL 4 on, <code>InnoDB</code> is included by
default in binary distributions, so you do not need a MySQL-Max server to
obtain <code>InnoDB</code> support.

<DT><code>--with-bdb</code>
<DD>
This option enables support for the Berkeley DB (<code>BDB</code>) storage engine.

<DT><code>CFLAGS=-DUSE_SYMDIR</code>
<DD>
This define enables symbolic link support for Windows.

</DL>

<P>
MySQL-Max binary distributions are a convenience for those who wish to install
precompiled programs. If you build MySQL using a source distribution, you can
build your own Max-like server by enabling the same features at configuration
time that the MySQL-Max binary distributions are built with.

</P>
<P>
MySQL-Max servers include the BerkeleyDB (<code>BDB</code>) storage engine
whenever possible, but not all platforms support <code>BDB</code>.  The following
table shows which platforms allow MySQL-Max binaries to include <code>BDB</code>:

</P>
<TABLE BORDER>
<TR><TD><strong>System</strong> </TD><TD> <code>BDB</code> <strong>Support</strong>
</TD></TR>
<TR><TD>AIX 4.3 </TD><TD> N
</TD></TR>
<TR><TD>HP-UX 11.0 </TD><TD> N
</TD></TR>
<TR><TD>Linux-Alpha </TD><TD> N
</TD></TR>
<TR><TD>Linux-IA-64 </TD><TD> N
</TD></TR>
<TR><TD>Linux-Intel </TD><TD> Y
</TD></TR>
<TR><TD>Mac OS X </TD><TD> N
</TD></TR>
<TR><TD>NetWare </TD><TD> N
</TD></TR>
<TR><TD>SCO OSR5 </TD><TD> Y
</TD></TR>
<TR><TD>Solaris-Intel </TD><TD> N
</TD></TR>
<TR><TD>Solaris-SPARC </TD><TD> Y
</TD></TR>
<TR><TD>UnixWare </TD><TD> Y
</TD></TR>
<TR><TD>Windows/NT </TD><TD> Y
</TD></TR>
</TABLE>

<P>
To find out which storage engines your server supports, issue the following
statement:

</P>

<PRE>
mysql&#62; SHOW ENGINES;
</PRE>

<P>
Before MySQL 4.1.2, <code>SHOW ENGINES</code> is unavailable. Use the following
statement instead and check the value of the variable for the storage engine
in which you are interested:

</P>

<PRE>
mysql&#62; SHOW VARIABLES LIKE 'have_%';
+------------------+----------+
| Variable_name    | Value    |
+------------------+----------+
| have_bdb         | NO       |
| have_crypt       | YES      |
| have_innodb      | YES      |
| have_isam        | NO       |
| have_raid        | NO       |
| have_symlink     | DISABLED |
| have_openssl     | NO       |
| have_query_cache | YES      |
+------------------+----------+
</PRE>

<P>
The values in the second column indicate the server's level of support for
each feature:

</P>
<TABLE BORDER>
<TR><TD><strong>Value</strong> </TD><TD> <strong>Meaning</strong>
</TD></TR>
<TR><TD><code>YES</code> </TD><TD> The feature is supported and is active.
</TD></TR>
<TR><TD><code>NO</code> </TD><TD> The feature is not supported.
</TD></TR>
<TR><TD><code>DISABLED</code> </TD><TD> The feature is supported but has been disabled.
</TD></TR>
</TABLE>

<P>
A value of <code>NO</code> means that the server was compiled without support
for the feature, so it cannot be activated at runtime.

</P>
<P>
A value of <code>DISABLED</code> occurs either because the server was
started with an option that disables the feature, or because not
all options required to enable it were given. In the latter case, the
<code><var>host_name</var>.err</code> error log file should contain a reason indicating why
the option is disabled.

</P>
<P>
One situation in which you might see <code>DISABLED</code> occurs with MySQL 3.23
when the <code>InnoDB</code> storage engine is compiled in. In MySQL 3.23, you
must supply at least the <code>innodb_data_file_path</code> option at runtime to
set up the <code>InnoDB</code> tablespace. Without this option, <code>InnoDB</code>
disables itself.
See section <A HREF="manual_InnoDB.html#InnoDB_in_MySQL_3.23">15.3  <code>InnoDB</code> in MySQL 3.23</A>.
You can specify configuration options for the <code>BDB</code> storage engine, too,
but <code>BDB</code> will not disable itself if you do not provide them.
See section <A HREF="manual_Storage_engines.html#BDB_start">14.4.3  <code>BDB</code> Startup Options</A>.

</P>
<P>
You might also see <code>DISABLED</code> for the <code>InnoDB</code>, <code>BDB</code>, or
<code>ISAM</code> storage engines if the server was compiled to support them, but
was started with the <code>--skip-innodb</code>, <code>--skip-bdb</code>, or
<code>--skip-isam</code> options at runtime.

</P>
<P>
As of Version 3.23, all MySQL servers support <code>MyISAM</code> tables, because
<code>MyISAM</code> is the default storage engine.

</P>



<H3><A NAME="mysqld_safe" HREF="manual_toc.html#mysqld_safe">5.1.3  The <code>mysqld_safe</code> Server Startup Script</A></H3>

<P>
<A NAME="IDX435"></A>
<A NAME="IDX436"></A>
<A NAME="IDX437"></A>
<A NAME="IDX438"></A>
<A NAME="IDX439"></A>

</P>
<P>
<code>mysqld_safe</code> is the recommended way to start a <code>mysqld</code>
server on Unix and NetWare.  <code>mysqld_safe</code> adds some safety features
such as restarting the server when an error occurs and logging runtime
information to an error log file. NetWare-specific behaviors are listed
later in this section.

</P>
<P>
<strong>Note</strong>:
Before MySQL 4.0, <code>mysqld_safe</code> is named <code>safe_mysqld</code>.
To preserve backward compatibility, MySQL binary distributions for
some time will include <code>safe_mysqld</code> as a symbolic link to
<code>mysqld_safe</code>.

</P>
<P>
By default, <code>mysqld_safe</code> tries to start an executable named
<code>mysqld-max</code> if it exists, or <code>mysqld</code> otherwise.
Be aware of the implications of this behavior:

</P>

<UL>

<LI>

On Linux, the <code>MySQL-Max</code> RPM relies on this <code>mysqld_safe</code>
behavior. The RPM installs an executable named <code>mysqld-max</code>, which
causes <code>mysqld_safe</code> to automatically use that executable from that
point on.

<LI>

If you install a MySQL-Max distribution that includes a server named
<code>mysqld-max</code>, then upgrade later to a non-Max version of MySQL,
<code>mysqld_safe</code> will still attempt to run the old <code>mysqld-max</code>
server.  If you perform such an upgrade, you should manually remove the old
<code>mysqld-max</code> server to ensure that <code>mysqld_safe</code> runs the new
<code>mysqld</code> server.

</UL>

<P>
To override the default behavior and specify explicitly which server you
want to run, specify a <code>--mysqld</code> or <code>--mysqld-version</code> option to
<code>mysqld_safe</code>.

</P>
<P>
Many of the options to <code>mysqld_safe</code> are the same as the options to
<code>mysqld</code>. See section <A HREF="manual_MySQL_Database_Administration.html#Server_options">5.2.1  <code>mysqld</code> Command-Line Options</A>.

</P>
<P>
All options specified to <code>mysqld_safe</code> on the command line are
passed to <code>mysqld</code>.  If you want to use any options that are specific
to <code>mysqld_safe</code> and that <code>mysqld</code> doesn't support, do not specify
them on the command line. Instead, list them in the <code>[mysqld_safe]</code> group
of an option file.
See section <A HREF="manual_Using_MySQL_Programs.html#Option_files">4.3.2  Using Option Files</A>.

</P>
<P>
<code>mysqld_safe</code> reads all options from the <code>[mysqld]</code>,
<code>[server]</code>, and <code>[mysqld_safe]</code> sections in option files.
For backward compatibility, it also reads <code>[safe_mysqld]</code>
sections, although you should rename such sections to <code>[mysqld_safe]</code>
when you begin using MySQL 4.0 or later.

</P>
<P>
<code>mysqld_safe</code> supports the following options:

</P>

<DL COMPACT>

<DT><code>--basedir=<var>path</var></code>
<DD>
The path to the MySQL installation directory.

<DT><code>--core-file-size=<var>size</var></code>
<DD>
The size of the core file <code>mysqld</code> should be able to create. The option
value is passed to <code>ulimit -c</code>.

<DT><code>--datadir=<var>path</var></code>
<DD>
The path to the data directory.

<DT><code>--defaults-extra-file=<var>path</var></code>
<DD>
The name of an option file to be read in addition to the usual option files.

<DT><code>--defaults-file=<var>path</var></code>
<DD>
The name of an option file to be read instead of the usual option files.

<DT><code>--err-log=<var>path</var></code>
<DD>
The old form of the <code>--log-error</code> option, to be used before MySQL 4.0.

<DT><code>--ledir=<var>path</var></code>
<DD>
The path to the directory containing the <code>mysqld</code> program.
Use this option to explicitly indicate the location of the server.

<DT><code>--log-error=<var>path</var></code>
<DD>
Write the error log to the given file. See section <A HREF="manual_MySQL_Database_Administration.html#Error_log">5.9.1  The Error Log</A>.

<DT><code>--mysqld=<var>prog_name</var></code>
<DD>
The name of the server program (in the <code>ledir</code> directory) that you
want to start. This option is needed if you use the MySQL binary distribution
but have the data directory outside of the binary distribution.

<DT><code>--mysqld-version=<var>suffix</var></code>
<DD>
This option is similar to the <code>--mysqld</code> option, but you specify only
the suffix for the server program name. The basename is assumed to be
<code>mysqld</code>.  For example, if you use <code>--mysqld-version=max</code>,
<code>mysqld_safe</code> will start the <code>mysqld-max</code> program in the
<code>ledir</code> directory.  If the argument to <code>--mysqld-version</code> is
empty, <code>mysqld_safe</code> uses <code>mysqld</code> in the <code>ledir</code> directory.

<DT><code>--nice=<var>priority</var></code>
<DD>
Use the <code>nice</code> program to set the server's scheduling priority to the
given value.  This option was added in MySQL 4.0.14.

<DT><code>--no-defaults</code>
<DD>
Do not read any option files.

<DT><code>--open-files-limit=<var>count</var></code>
<DD>
The number of files <code>mysqld</code> should be able to open. The option value
is passed to <code>ulimit -n</code>. Note that you need to start
<code>mysqld_safe</code> as <code>root</code> for this to work properly!

<DT><code>--pid-file=<var>path</var></code>
<DD>
The path to the process ID file.

<DT><code>--port=<var>port_num</var></code>
<DD>
The port number to use when listening for TCP/IP connections.

<DT><code>--socket=<var>path</var></code>
<DD>
The Unix socket file to use for local connections.

<DT><code>--timezone=<var>zone</var></code>
<DD>
Set the <code>TZ</code> time zone environment variable to the given option value.
Consult your operating system documentation for legal time zone
specification formats.

<DT><code>--user={<var>user_name</var> | <var>user_id</var>}</code>
<DD>
Run the <code>mysqld</code> server as the user having the name <var>user_name</var> or
the numeric user ID <var>user_id</var>.
(``User'' in this context refers to a system login account, not a MySQL user
listed in the grant tables.)

</DL>

<P>
The <code>mysqld_safe</code> script is written so that it normally can start a
server that was installed from either a source or a binary distribution of
MySQL, even though these types of distributions typically install the server
in slightly different locations.
(See section <A HREF="manual_Installing.html#Installation_layouts">2.1.5  Installation Layouts</A>.)
<code>mysqld_safe</code> expects one of the following conditions to be true:

</P>

<UL>
<LI>

The server and databases can be found relative to the directory from which
<code>mysqld_safe</code> is invoked.  For binary distributions, <code>mysqld_safe</code>
looks under its working directory for <tt>`bin'</tt> and <tt>`data'</tt>
directories.  For source distributions, it looks for <tt>`libexec'</tt> and
<tt>`var'</tt> directories.  This condition should be met if you execute
<code>mysqld_safe</code> from your MySQL installation directory (for example,
<tt>`/usr/local/mysql'</tt> for a binary distribution).

<LI>

If the server and databases cannot be found relative to the working
directory, <code>mysqld_safe</code> attempts to locate them by absolute pathnames.
Typical locations are <tt>`/usr/local/libexec'</tt> and <tt>`/usr/local/var'</tt>.
The actual locations are determined from the values configured into the
distribution at the time it was built.  They should be correct if MySQL
is installed in the location specified at configuration time.
</UL>

<P>
Because <code>mysqld_safe</code> will try to find the server and databases relative
to its own working directory, you can install a binary distribution of
MySQL anywhere, as long as you run <code>mysqld_safe</code> from the
MySQL installation directory:

</P>

<PRE>
shell&#62; cd mysql_installation_directory
shell&#62; bin/mysqld_safe &#38;
</PRE>

<P>
If <code>mysqld_safe</code> fails, even when invoked from the MySQL
installation directory, you can specify the <code>--ledir</code> and
<code>--datadir</code> options to indicate the directories in which the server and
databases are located on your system.

</P>
<P>
Normally, you should not edit the <code>mysqld_safe</code> script.  Instead,
configure <code>mysqld_safe</code> by using command-line options or options in the
<code>[mysqld_safe]</code> section of a <tt>`my.cnf'</tt> option file.  In rare cases,
it might be necessary to edit <code>mysqld_safe</code> to get it to start the server
properly. However, if you do this, your modified version of
<code>mysqld_safe</code> might be overwritten if you upgrade MySQL in the future, so
you should make a copy of your edited version that you can reinstall.

</P>
<P>
On NetWare, <code>mysqld_safe</code> is a NetWare Loadable Module (NLM) that is
ported from the original Unix shell script.  It does the following:

</P>

<OL>
<LI>

Runs a number of system and option checks.

<LI>

Runs a check on <code>MyISAM</code> and <code>ISAM</code> tables.

<LI>

Provides a screen presence for the MySQL server.

<LI>

Starts <code>mysqld</code>, monitors it, and restarts it if it terminates in error.

<LI>

Sends error messages from <code>mysqld</code> to the <tt>`<var>host_name</var>.err'</tt> file in the
data directory.

<LI>

Sends <code>mysqld_safe</code> screen output to the <tt>`<var>host_name</var>.safe'</tt> file in the
data directory.

</OL>



<H3><A NAME="mysql.server" HREF="manual_toc.html#mysql.server">5.1.4  The <code>mysql.server</code> Server Startup Script</A></H3>

<P>
MySQL distributions on Unix include a script named <code>mysql.server</code>.
It can be used on systems such as Linux and Solaris that use System V-style
run directories to start and stop system services. It is also used by the Mac
OS X Startup Item for MySQL.

</P>
<P>
<code>mysql.server</code> can be found in the <tt>`support-files'</tt> directory under
your MySQL installation directory or in a MySQL source tree.

</P>
<P>
If you use the Linux server RPM package (<code>MySQL-server-<var>VERSION</var>.rpm</code>),
the <code>mysql.server</code> script will already have been installed in the
<tt>`/etc/init.d'</tt> directory with the name <tt>`mysql'</tt>. You need not
install it manually. See section <A HREF="manual_Installing.html#Linux-RPM">2.4  Installing MySQL on Linux</A> for more information on the Linux
RPM packages.

</P>
<P>
Some vendors provide RPM packages that install a startup script under a
different name such as <code>mysqld</code>.

</P>
<P>
If you install MySQL from a source distribution or using a binary distribution
format that does not install <code>mysql.server</code> automatically, you can
install it manually. Instructions are provided in section <A HREF="manual_Installing.html#Automatic_start">2.9.2.2  Starting and Stopping MySQL Automatically</A>.

</P>
<P>
<code>mysql.server</code> reads options from the <code>[mysql.server]</code> and
<code>[mysqld]</code> sections of option files.  (For backward compatibility,
it also reads <code>[mysql_server]</code> sections, although you should rename such
sections to <code>[mysql.server]</code> when you begin using MySQL 4.0 or later.)

</P>



<H3><A NAME="mysqld_multi" HREF="manual_toc.html#mysqld_multi">5.1.5  The <code>mysqld_multi</code> Program for Managing Multiple MySQL Servers</A></H3>

<P>
<A NAME="IDX440"></A>
<A NAME="IDX441"></A>
<A NAME="IDX442"></A>
<A NAME="IDX443"></A>

</P>
<P>
<code>mysqld_multi</code> is meant for managing several <code>mysqld</code>
processes that listen for connections on different Unix socket files and
TCP/IP ports.  It can start or stop servers, or report their current status.

</P>
<P>
The program searches for groups named <code>[mysqld#]</code> in <tt>`my.cnf'</tt> (or
in the file named by the <code>--config-file</code> option).  <code>#</code> can be any
positive integer.  This number is referred to in the following discussion as
the option group number, or <var>GNR</var>.  Group numbers distinguish option groups
from one another and are used as arguments to <code>mysqld_multi</code> to specify
which servers you want to start, stop, or obtain a status report for.
Options listed in these groups are the same that you would use in the
<code>[mysqld]</code> group used for starting <code>mysqld</code>.  (See, for example,
section <A HREF="manual_Installing.html#Automatic_start">2.9.2.2  Starting and Stopping MySQL Automatically</A>.) However, when using multiple servers it is necessary
that each one use its own value for options such as the Unix socket file and
TCP/IP port number. For more information on which options must be unique per
server in a multiple-server environment, see section <A HREF="manual_MySQL_Database_Administration.html#Multiple_servers">5.10  Running Multiple MySQL Servers on the Same Machine</A>.

</P>
<P>
To invoke <code>mysqld_multi</code>, use the following syntax:

</P>

<PRE>
shell&#62; mysqld_multi [<var>options</var>] {start|stop|report} [<var>GNR</var>[,<var>GNR</var>]...]
</PRE>

<P>
<code>start</code>, <code>stop</code>, and <code>report</code> indicate which operation you
want to perform. You can perform the designated operation on a single server
or multiple servers, depending on the <var>GNR</var> list that follows the option name.
If there is no list, <code>mysqld_multi</code> performs the operation for all
servers in the option file.

</P>
<P>
Each <var>GNR</var> value represents an option group number or range of group numbers.
The value should be the number at the end of the group name in the
option file.  For example, the <var>GNR</var> for a group named <code>[mysqld17]</code>
is <code>17</code>.  To specify a range of numbers, separate the first and last
numbers by a dash.  The <var>GNR</var> value <code>10-13</code> represents groups
<code>[mysqld10]</code> through <code>[mysqld13]</code>.  Multiple groups or group
ranges can be specified on the command line, separated by commas.  There
must be no whitespace characters (spaces or tabs) in the <var>GNR</var> list; anything
after a whitespace character is ignored.

</P>
<P>
This command starts a single server using option group <code>[mysqld17]</code>:

</P>

<PRE>
shell&#62; mysqld_multi start 17
</PRE>

<P>
This command stops several servers, using option groups <code>[mysql8]</code>
and <code>[mysqld10]</code> through <code>[mysqld13]</code>:

</P>

<PRE>
shell&#62; mysqld_multi stop 8,10-13
</PRE>

<P>
For an example of how you might set up an option file, use this command:

</P>

<PRE>
shell&#62; mysqld_multi --example
</PRE>

<P>
<code>mysqld_multi</code> supports the following options:

</P>
<DL COMPACT>

<DT><code>--config-file=<var>name</var></code>
<DD>
<A NAME="IDX444"></A>
Specify the name of an alternative option file. This affects where
<code>mysqld_multi</code> looks for <code>[mysqld#]</code> option groups.  Without this
option, all options are read from the usual <tt>`my.cnf'</tt> file.  The option
does not affect where <code>mysqld_multi</code> reads its own options, which are
always taken from the <code>[mysqld_multi]</code> group in the usual <tt>`my.cnf'</tt>
file.

<DT><code>--example</code>
<DD>
<A NAME="IDX445"></A>
Display a sample option file.

<DT><code>--help</code>
<DD>
<A NAME="IDX446"></A>
Display a help message and exit.

<DT><code>--log=<var>name</var></code>
<DD>
<A NAME="IDX447"></A>
Specify the name of the log file. If the file exists, log output is appended
to it.

<DT><code>--mysqladmin=<var>prog_name</var></code>
<DD>
<A NAME="IDX448"></A>
The <code>mysqladmin</code> binary to be used to stop servers.

<DT><code>--mysqld=<var>prog_name</var></code>
<DD>
<A NAME="IDX449"></A>
The <code>mysqld</code> binary to be used. Note that you can specify
<code>mysqld_safe</code> as the value for this option also. The options are passed
to <code>mysqld</code>. Just make sure that you have the directory where <code>mysqld</code> is
located in your <code>PATH</code>
environment variable setting or fix <code>mysqld_safe</code>.

<DT><code>--no-log</code>
<DD>
<A NAME="IDX450"></A>
Print log information to stdout rather than to the log file. By default,
output goes to the log file.

<DT><code>--password=<var>password</var></code>
<DD>
<A NAME="IDX451"></A>
The password of the MySQL account to use when invoking <code>mysqladmin</code>.
Note that the password value is not optional for this option, unlike for other
MySQL programs.

<DT><code>--silent</code>
<DD>
<A NAME="IDX452"></A>
Disable warnings.  This option was added in MySQL 4.1.6.

<DT><code>--tcp-ip</code>
<DD>
<A NAME="IDX453"></A>
Connect to each MySQL server via the TCP/IP port instead of the Unix socket
file.  (If a socket file is missing, the server might still be running,
but accessible only via the TCP/IP port.)  By default, connections are
made using the Unix socket file.  This option affects <code>stop</code> and
<code>report</code> operations.

<DT><code>--user=<var>user_name</var></code>
<DD>
<A NAME="IDX454"></A>
The username of the MySQL account to use when invoking <code>mysqladmin</code>.

<DT><code>--verbose</code>
<DD>
<A NAME="IDX455"></A>
Be more verbose.  This option was added in MySQL 4.1.6.

<DT><code>--version</code>
<DD>
<A NAME="IDX456"></A>
Display version information and exit.

</DL>

<P>
Some notes about <code>mysqld_multi</code>:

</P>

<UL>
<LI>

Make sure that the MySQL account used for stopping the <code>mysqld</code> servers
(with the <code>mysqladmin</code> program) has the same username and password for
each server. Also, make sure that the account has the <code>SHUTDOWN</code>
privilege. If the servers that you want to manage have many different
usernames or passwords for the administrative accounts, you might want to
create an account on each server that has the same username and password.
For example, you might set up a common <code>multi_admin</code> account by
executing the following commands for each server:


<PRE>
shell&#62; mysql -u root -S /tmp/mysql.sock -p<var>root_password</var>
mysql&#62; GRANT SHUTDOWN ON *.*
    -&#62; TO 'multi_admin'@'localhost' IDENTIFIED BY 'multipass';
</PRE>

See section <A HREF="manual_MySQL_Database_Administration.html#Privileges">5.5.2  How the Privilege System Works</A>.
You will have to do this for each <code>mysqld</code> server. Change the
connection parameters appropriately when connecting to each one.  Note that
the host part of the account name must allow you to connect as
<code>multi_admin</code> from the host where you want to run <code>mysqld_multi</code>.

<LI>

The
<code>--pid-file</code> option is very important if you are using <code>mysqld_safe</code>
to start <code>mysqld</code> (for example, <code>--mysqld=mysqld_safe</code>) Every
<code>mysqld</code> should have its own process ID file. The advantage of
using <code>mysqld_safe</code> instead of <code>mysqld</code> is
that <code>mysqld_safe</code> ``guards'' its <code>mysqld</code> process and will
restart it if the process terminates due to a signal
sent using <code>kill -9</code>, or for other reasons, such as a segmentation
fault. Please note that the
<code>mysqld_safe</code> script might require that you start it from a certain
place. This means that you might have to change location to a certain directory
before running <code>mysqld_multi</code>. If you have problems starting,
please see the <code>mysqld_safe</code> script. Check especially the lines:


<PRE>
----------------------------------------------------------------
MY_PWD=`pwd`
# Check if we are starting this relative (for the binary release)
if test -d $MY_PWD/data/mysql -a -f ./share/mysql/english/errmsg.sys -a \
 -x ./bin/mysqld
----------------------------------------------------------------
</PRE>

See section <A HREF="manual_MySQL_Database_Administration.html#mysqld_safe">5.1.3  The <code>mysqld_safe</code> Server Startup Script</A>.
The test performed by these lines should be successful, or you might encounter
problems.

<LI>

The Unix socket file and the TCP/IP port number must be different for every
<code>mysqld</code>.

<LI>

You might want to use the <code>--user</code> option for <code>mysqld</code>, but in order
to do this you need to run the <code>mysqld_multi</code> script as the Unix
<code>root</code> user. Having the option in the option file doesn't matter; you
will just get a warning, if you are not the superuser and the <code>mysqld</code>
processes are started under your own Unix account.

<LI>

<strong>Important</strong>: Make
sure that the data directory is fully accessible to the Unix account that
the specific <code>mysqld</code> process is started as. <em>Do not</em> use the
Unix root account for this, unless you <em>know</em> what you are doing.

<LI>

<strong>Most important</strong>: Before using <code>mysqld_multi</code> be sure that you
understand the meanings of the options that are passed to the <code>mysqld</code>
servers and <em>why</em> you would want to have separate <code>mysqld</code>
processes.  Beware of the dangers of using multiple <code>mysqld</code> servers
with the same data directory.  Use separate data directories, unless you
<em>know</em> what you are doing.  Starting multiple servers with the same
data directory <em>will not</em> give you extra performance in a threaded
system.
See section <A HREF="manual_MySQL_Database_Administration.html#Multiple_servers">5.10  Running Multiple MySQL Servers on the Same Machine</A>.

</UL>

<P>
The following example shows how you might set up an option file for use with
<code>mysqld_multi</code>.  The first and fifth <code>[mysqld#]</code> group were
intentionally left out from the example to illustrate that you can have
``gaps'' in the option file. This gives you more flexibility.  The order in
which the <code>mysqld</code> programs are started or stopped depends on the order
in which they appear in the option file.

</P>

<PRE>
# This file should probably be in your home dir (~/.my.cnf)
# or /etc/my.cnf
# Version 2.1 by Jani Tolonen

[mysqld_multi]
mysqld     = /usr/local/bin/mysqld_safe
mysqladmin = /usr/local/bin/mysqladmin
user       = multi_admin
password   = multipass

[mysqld2]
socket     = /tmp/mysql.sock2
port       = 3307
pid-file   = /usr/local/mysql/var2/hostname.pid2
datadir    = /usr/local/mysql/var2
language   = /usr/local/share/mysql/english
user       = john

[mysqld3]
socket     = /tmp/mysql.sock3
port       = 3308
pid-file   = /usr/local/mysql/var3/hostname.pid3
datadir    = /usr/local/mysql/var3
language   = /usr/local/share/mysql/swedish
user       = monty

[mysqld4]
socket     = /tmp/mysql.sock4
port       = 3309
pid-file   = /usr/local/mysql/var4/hostname.pid4
datadir    = /usr/local/mysql/var4
language   = /usr/local/share/mysql/estonia
user       = tonu

[mysqld6]
socket     = /tmp/mysql.sock6
port       = 3311
pid-file   = /usr/local/mysql/var6/hostname.pid6
datadir    = /usr/local/mysql/var6
language   = /usr/local/share/mysql/japanese
user       = jani
</PRE>

<P>
See section <A HREF="manual_Using_MySQL_Programs.html#Option_files">4.3.2  Using Option Files</A>.

</P>



<H2><A NAME="Configuring_MySQL" HREF="manual_toc.html#Configuring_MySQL">5.2  Configuring the MySQL Server</A></H2>

<P>
This section discusses MySQL server configuration topics:

</P>

<UL>
<LI>

Startup options that the server supports
<LI>

How to set the server SQL mode
<LI>

Server system variables
<LI>

Server status variables
</UL>



<H3><A NAME="Server_options" HREF="manual_toc.html#Server_options">5.2.1  <code>mysqld</code> Command-Line Options</A></H3>

<P>
<A NAME="IDX457"></A>
<A NAME="IDX458"></A>
<A NAME="IDX459"></A>

</P>
<P>
When you start the <code>mysqld</code> server, you can specify program options
using any of the methods described in section <A HREF="manual_Using_MySQL_Programs.html#Program_Options">4.3  Specifying Program Options</A>. The most
common methods are to provide options in an option file or on the command
line. However, in most cases it is desirable to make sure that the server uses
the same options each time it runs. The best way to ensure this is to
list them in an option file.
See section <A HREF="manual_Using_MySQL_Programs.html#Option_files">4.3.2  Using Option Files</A>.

</P>
<P>
<code>mysqld</code> reads options from the <code>[mysqld]</code> and <code>[server]</code>
groups.  <code>mysqld_safe</code> reads options from the <code>[mysqld]</code>,
<code>[server]</code>, <code>[mysqld_safe]</code>, and <code>[safe_mysqld]</code>
groups.  <code>mysql.server</code> reads options from the <code>[mysqld]</code>
and <code>[mysql.server]</code> groups.  An embedded MySQL server usually reads
options from the <code>[server]</code>, <code>[embedded]</code>, and <code>[<var>xxxxx</var>_SERVER]</code>
groups, where <var>xxxxx</var> is the name of the application into which the
server is embedded.

</P>
<P>
<code>mysqld</code> accepts many command-line options.
For a list, execute <code>mysqld --help</code>. Before MySQL 4.1.1, <code>--help</code>
prints the full help message. As of 4.1.1, it prints a brief message; to see
the full list, use <code>mysqld --verbose --help</code>.

</P>
<P>
The following list shows some of the most common server options.
Additional options are described elsewhere:

</P>

<UL>

<LI>

Options that affect security:
See section <A HREF="manual_MySQL_Database_Administration.html#Privileges_options">5.4.3  Startup Options for <code>mysqld</code> Concerning Security</A>.

<LI>

SSL-related options:
See section <A HREF="manual_MySQL_Database_Administration.html#SSL_options">5.6.7.5  SSL Command-Line Options</A>.

<LI>

Binary log control options:
See section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>.

<LI>

Replication-related options:
See section <A HREF="manual_Replication.html#Replication_Options">6.8  Replication Startup Options</A>.

<LI>

Options specific to particular storage engines:
See section <A HREF="manual_Storage_engines.html#MyISAM_start">14.1.1  <code>MyISAM</code> Startup Options</A>,
section <A HREF="manual_Storage_engines.html#BDB_start">14.4.3  <code>BDB</code> Startup Options</A>,
section <A HREF="manual_InnoDB.html#InnoDB_start">15.5  <code>InnoDB</code> Startup Options</A>.

</UL>

<P>
You can also set the value of a server system variable by using the variable
name as an option, as described later in this section.

</P>
<DL COMPACT>

<DT><code>--help, -?</code>
<DD>
Display a short help message and exit.
Before MySQL 4.1.1, <code>--help</code> displays the full help message.
As of 4.1.1, it displays an abbreviated message only.  Use both the
<code>--verbose</code> and <code>--help</code> options to see the full message.

<DT><code>--ansi</code>
<DD>
Use standard SQL syntax instead of MySQL syntax.  See section <A HREF="manual_Introduction.html#ANSI_mode">1.5.3  Running MySQL in ANSI Mode</A>.
For more precise control over the server SQL mode, use the <code>--sql-mode</code>
option instead.

<DT><code>--basedir=<var>path</var>, -b <var>path</var></code>
<DD>
The path to the MySQL installation directory. All paths are usually resolved
relative to this.

<DT><code>--big-tables</code>
<DD>
Allow large result sets by saving all temporary sets in files.  This option
prevents most ``table full'' errors, but also slows down queries for which
in-memory tables would suffice.  Since MySQL 3.23.2, the server is able to
handle large result sets automatically by using memory for small temporary
tables and switching to disk tables where necessary.

<DT><code>--bind-address=<var>IP</var></code>
<DD>
The IP address to bind to.

<DT><code>--console</code>
<DD>
Write the error log messages to stderr/stdout even if <code>--log-error</code>
is specified.  On Windows, <code>mysqld</code> will not close the console screen if
this option is used.

<DT><code>--character-sets-dir=<var>path</var></code>
<DD>
The directory where character sets are installed.  See section <A HREF="manual_MySQL_Database_Administration.html#Character_sets">5.8.1  The Character Set Used for Data and Sorting</A>.

<DT><code>--chroot=<var>path</var></code>
<DD>
Put the <code>mysqld</code> server in a closed environment during startup by using the
<code>chroot()</code> system call. This is a recommended security measure as of
MySQL 4.0. (MySQL 3.23 is not able to provide a <code>chroot()</code> jail that is
100% closed.)  Note that use of this option somewhat limits <code>LOAD
DATA INFILE</code> and <code>SELECT ... INTO OUTFILE</code>.

<DT><code>--character-set-server=<var>charset</var></code>
<DD>
Use <var>charset</var> as the default server character set.
This option is available as of MySQL 4.1.3.
See section <A HREF="manual_MySQL_Database_Administration.html#Character_sets">5.8.1  The Character Set Used for Data and Sorting</A>.

<DT><code>--core-file</code>
<DD>
Write a core file if <code>mysqld</code> dies.  For some systems, you must also
specify the <code>--core-file-size</code> option to <code>mysqld_safe</code>.
See section <A HREF="manual_MySQL_Database_Administration.html#mysqld_safe">5.1.3  The <code>mysqld_safe</code> Server Startup Script</A>.
Note that on some systems, such as Solaris, you will
not get a core file if you are also using the <code>--user</code> option.

<DT><code>--collation-server=<var>collation</var></code>
<DD>
Use <var>collation</var> as the default server collation.
This option is available as of MySQL 4.1.3.
See section <A HREF="manual_MySQL_Database_Administration.html#Character_sets">5.8.1  The Character Set Used for Data and Sorting</A>.

<DT><code>--datadir=<var>path</var>, -h <var>path</var></code>
<DD>
The path to the data directory.

<DT><code>--debug[=<var>debug_options</var>], -# [<var>debug_options</var>]</code>
<DD>
If MySQL is configured with <code>--with-debug</code>, you can use this
option to get a trace file of what <code>mysqld</code> is doing.
The <var>debug_options</var> string often is <code>'d:t:o,<var>file_name</var>'</code>.
See section <A HREF="manual_Porting.html#Making_trace_files">E.1.2  Creating Trace Files</A>.

<DT><code>--default-character-set=<var>charset</var></code>
<DD>
Use <var>charset</var> as the default character set.  This option is deprecated
in favor of <code>--character-set-server</code> as of MySQL 4.1.3.
See section <A HREF="manual_MySQL_Database_Administration.html#Character_sets">5.8.1  The Character Set Used for Data and Sorting</A>.

<DT><code>--default-collation=<var>collation</var></code>
<DD>
Use <var>collation</var> as the default collation.  This option is deprecated in
favor of <code>--collation-server</code> as of MySQL 4.1.3.
See section <A HREF="manual_MySQL_Database_Administration.html#Character_sets">5.8.1  The Character Set Used for Data and Sorting</A>.

<DT><code>--default-storage-engine=<var>type</var></code>
<DD>
This option is a synonym for <code>--default-table-type</code>.
It is available as of MySQL 4.1.2.

<DT><code>--default-table-type=<var>type</var></code>
<DD>
Set the default table type for tables.  See section <A HREF="manual_Storage_engines.html#Storage_engines">14  MySQL Storage Engines and Table Types</A>.

<DT><code>--default-time-zone=<var>type</var></code>
<DD>
Set the default server time zone.  This option sets the global
<code>time_zone</code> system variable.  If this option is not given, the default
time zone will be the same as the system time zone (given by the value of
the <code>system_time_zone</code> system variable.
This option is available as of MySQL 4.1.3.

<DT><code>--delay-key-write[= OFF | ON | ALL]</code>
<DD>
How the <code>DELAYED KEYS</code> option should be used.
Delayed key writing causes key buffers not to be flushed between writes for
<code>MyISAM</code> tables.
<code>OFF</code> disables delayed key writes.
<code>ON</code> enables delayed key writes for those tables that were created with
the <code>DELAYED KEYS</code> option.
<code>ALL</code> delays key writes for all <code>MyISAM</code> tables.
Available as of MySQL 4.0.3.
See section <A HREF="manual_MySQL_Optimization.html#Server_parameters">7.5.2  Tuning Server Parameters</A>. See section <A HREF="manual_Storage_engines.html#MyISAM_start">14.1.1  <code>MyISAM</code> Startup Options</A>.

<strong>Note</strong>: If you set this variable to <code>ALL</code>, you should not use
<code>MyISAM</code> tables from within another program (such as from another MySQL server or
with <code>myisamchk</code>) when the table is in use. Doing so will lead to index
corruption.

<DT><code>--delay-key-write-for-all-tables</code>
<DD>
Old form of <code>--delay-key-write=ALL</code> for use prior to MySQL 4.0.3.
As of 4.0.3, use <code>--delay-key-write</code> instead.

<DT><code>--des-key-file=<var>file_name</var></code>
<DD>
Read the default keys used by <code>DES_ENCRYPT()</code> and <code>DES_DECRYPT()</code>
from this file.

<DT><code>--enable-named-pipe</code>
<DD>
Enable support for named pipes.
This option applies only on Windows NT, 2000, XP, and 2003 systems, and can be used
only with the <code>mysqld-nt</code> and <code>mysqld-max-nt</code> servers that support
named pipe connections.

<DT><code>--exit-info[=<var>flags</var>], -T [<var>flags</var>]</code>
<DD>
This is a bit mask of different flags you can use for debugging the
<code>mysqld</code> server. Do not use this option unless you know
exactly what it does!

<DT><code>--external-locking</code>
<DD>
Enable system locking.  Note that if you use this option on a system on
which <code>lockd</code> does not fully work (as on Linux), you will easily get
<code>mysqld</code> to deadlock.
This option previously was named <code>--enable-locking</code>.

<strong>Note</strong>: If you use this option to enable updates to <code>MyISAM</code>
tables from many MySQL processes, you have to ensure that these conditions are
satisfied:


<UL>
<LI>

You should not use the query cache for queries that use tables that are
updated by another process.
<LI>

You should not use <code>--delay-key-write=ALL</code> or <code>DELAY_KEY_WRITE=1</code>
on any shared tables.
</UL>

The easiest way to ensure this is to always use <code>--external-locking</code>
together with <code>--delay-key-write=OFF --query-cache-size=0</code>.

(This is not done by default because in many setups it's useful to have a
mixture of the above options.)

<DT><code>--flush</code>
<DD>
Flush all changes to disk after each SQL statement.  Normally MySQL
does a write of all changes to disk only after each SQL statement and lets
the operating system handle the synching to disk.
See section <A HREF="manual_Problems.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A>.

<DT><code>--init-file=<var>file</var></code>
<DD>
Read SQL statements from this file at startup.
Each statement must be on a single line and should not include comments.

<DT><code>--innodb-safe-binlog</code>
<DD>
Adds consistency guarantees between the content of <code>InnoDB</code> tables and
the binary log.
See section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>.

<DT><code>--language=<var>lang_name</var>, -L <var>lang_name</var></code>
<DD>
Client error messages in given language.  <var>lang_name</var> can be given as the
language name or as the full pathname to the directory where the language
files are installed.
See section <A HREF="manual_MySQL_Database_Administration.html#Languages">5.8.2  Setting the Error Message Language</A>.

<DT><code>--log[=<var>file</var>], -l [<var>file</var>]</code>
<DD>
Log connections and queries to this file. See section <A HREF="manual_MySQL_Database_Administration.html#Query_log">5.9.2  The General Query Log</A>. If you don't
specify a filename, MySQL will use <code><var>host_name</var>.log</code> as the filename.

<DT><code>--log-bin=[<var>file</var>]</code>
<DD>
The binary log file.
Log all queries that change data to this file. Used for backup and
replication.  See section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>.  If you don't specify a filename,
MySQL will use <code><var>host_name</var>-bin</code> as the log file basename.

<DT><code>--log-bin-index[=<var>file</var>]</code>
<DD>
The index file for binary log filenames. See section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>.
If you don't specify a filename, MySQL will use <code><var>host_name</var>-bin.index</code> as
the filename.

<DT><code>--log-error[=<var>file</var>]</code>
<DD>
Log errors and startup messages to this file. See section <A HREF="manual_MySQL_Database_Administration.html#Error_log">5.9.1  The Error Log</A>.
If you don't specify a filename, MySQL will use <code><var>host_name</var>.err</code> as the filename.

<DT><code>--log-isam[=<var>file</var>]</code>
<DD>
Log all <code>ISAM</code>/<code>MyISAM</code> changes to this file (used only when
debugging <code>ISAM</code>/<code>MyISAM</code>).

<DT><code>--log-long-format</code>
<DD>
Log some extra information to the log files (update log, binary update log,
and slow queries log, whatever log has been activated). For example, 
username and timestamp are logged for queries. If you are using 
<code>--log-slow-queries</code> and <code>--log-long-format</code>,
queries that are not using indexes also are logged to the slow query log.
Note that <code>--log-long-format</code> is deprecated as of MySQL version
4.1, when <code>--log-short-format</code> was introduced (the long log format
is the default setting since version 4.1). Also note that starting with 
MySQL 4.1, the <code>--log-queries-not-using-indexes</code> option is available 
for the purpose of logging queries that do not use indexes to the slow 
query log.

<DT><code>--log-queries-not-using-indexes</code>
<DD>
If you are using this option with <code>--log-slow-queries</code>, then
queries that are not using indexes also  are logged to the slow query log. This 
option is available as of MySQL 4.1. See section <A HREF="manual_MySQL_Database_Administration.html#Slow_query_log">5.9.5  The Slow Query Log</A>.

<DT><code>--log-short-format</code>
<DD>
Log less information to the log files (update log, binary update log, 
and slow queries log, whatever log has been activated). For example, 
username and timestamp are not logged for queries. This option was 
introduced in MySQL 4.1.

<DT><code>--log-slow-queries[=<var>file</var>]</code>
<DD>
Log all queries that have taken more than <code>long_query_time</code> seconds 
to execute to this file.
See section <A HREF="manual_MySQL_Database_Administration.html#Slow_query_log">5.9.5  The Slow Query Log</A>.
Note that the default for the amount of information 
logged has changed in MySQL 4.1. See the <code>--log-long-format</code> and 
<code>--log-short-format</code> options for details.

<DT><code>--log-update[=<var>file</var>]</code>
<DD>
Log updates to <var>file#</var> where <var>#</var> is a unique number if not
given. See section <A HREF="manual_MySQL_Database_Administration.html#Update_log">5.9.3  The Update Log</A>. The update log is deprecated and is
removed in MySQL 5.0.0; you should use the binary log instead
(<code>--log-bin</code>). See section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>. Starting from version 5.0.0,
using <code>--log-update</code> will just turn on the binary log instead
(see section <A HREF="manual_News.html#News-5.0.0">D.1.4  Changes in release 5.0.0 (22 Dec 2003: Alpha)</A>).

<DT><code>--log-warnings, -W</code>
<DD>
Print out warnings such as <code>Aborted connection...</code> to the error log.
Enabling this option is recommended, for example, if you
use replication (you will get more information about what is happening,
such as messages about network failures and reconnections).
This option is enabled by default as of MySQL 4.0.19 and 4.1.2; to disable it,
use <code>--skip-log-warnings</code>.
As of MySQL 4.0.21 and 4.1.3, aborted connections are not logged to the error
log unless the value is greater than 1.
See section <A HREF="manual_Problems.html#Communication_errors">A.2.10  Communication Errors and Aborted Connections</A>.

This option was named <code>--warnings</code> before MySQL 4.0.

<DT><code>--low-priority-updates</code>
<DD>
Table-modifying operations (<code>INSERT</code>, <code>REPLACE</code>, <code>DELETE</code>, <code>UPDATE</code>)
will have lower priority than selects.  This can also be done via
<code>{INSERT | REPLACE | DELETE | UPDATE} LOW_PRIORITY ...</code> to lower
the priority of only one query, or by
<code>SET LOW_PRIORITY_UPDATES=1</code> to change the priority in one
thread.  See section <A HREF="manual_MySQL_Optimization.html#Table_locking">7.3.2  Table Locking Issues</A>.

<DT><code>--memlock</code>
<DD>
Lock the <code>mysqld</code> process in memory.  This works on systems such as
Solaris that support the <code>mlockall()</code> system call.  This
might help if you have a problem where the operating system is causing
<code>mysqld</code> to swap on disk.
Note that use of this option requires that you run the server as <code>root</code>,
which is normally not a good idea for security reasons.

<DT><code>--myisam-recover [=<var>option</var>[,<var>option</var>...]]]</code>
<DD>
Set the <code>MyISAM</code> storage engine recovery mode.
The option value is any combination of the values
of <code>DEFAULT</code>, <code>BACKUP</code>, <code>FORCE</code>, or <code>QUICK</code>.
If you specify multiple values, separate them by commas.
You can also use a value of <code>""</code> to disable this
option. If this option is used, <code>mysqld</code> will, when it opens a
<code>MyISAM</code> table, open check whether the
table is marked as crashed or wasn't closed properly.
(The last option works only if you are running with
<code>--skip-external-locking</code>.)  If this is the case, <code>mysqld</code> will run
a check on the table. If the table was corrupted, <code>mysqld</code> will
attempt to repair it.

The following options affect how the repair works:

<TABLE BORDER>
<TR><TD><strong>Option</strong> </TD><TD> <strong>Description</strong>

</TD></TR>
<TR><TD><code>DEFAULT</code> </TD><TD> The same as not giving any option to
                    <code>--myisam-recover</code>.

</TD></TR>
<TR><TD><code>BACKUP</code> </TD><TD> If the data file was changed during recovery, save a
                    backup of the <tt>`<var>tbl_name</var>.MYD'</tt> file as
                    <tt>`<var>tbl_name-datetime</var>.BAK'</tt>.

</TD></TR>
<TR><TD><code>FORCE</code> </TD><TD> Run recovery even if we will lose more than one row
                    from the <tt>`.MYD'</tt> file.

</TD></TR>
<TR><TD><code>QUICK</code> </TD><TD> Don't check the rows in the table if there aren't any
                    delete blocks.

</TD></TR>
</TABLE>

Before a table is automatically repaired, MySQL will add a note
about this in the error log.  If you want to be able to recover from most
problems without user intervention, you should use the options
<code>BACKUP,FORCE</code>.  This will force a repair of a table even if some rows
would be deleted, but it will keep the old data file as a backup so that
you can later examine what happened.

This option is available as of MySQL 3.23.25.

<DT><code>--ndb-connectstring=<var>connect_string</var></code>
<DD>
When using the <code>NDB</code> storage engine, it is possible to point out the
management server that distributes the cluster configuration by setting the
connect string option. See section <A HREF="manual_NDBCluster.html#MySQL_Cluster_Connectstring">16.3.4.2  The MySQL Cluster <code>connectstring</code></A> for syntax.

<DT><code>--ndbcluster</code>
<DD>
If the binary includes support for the <code>NDB Cluster</code> storage engine 
(from version 4.1.3, the MySQL-Max binaries are built with <code>NDB Cluster</code> enabled)
the default disabling of support for the <code>NDB Cluster</code> storage engine can be
overruled by using this option. Using the <code>NDB Cluster</code> storage engine is
necessary for using MySQL Cluster.
See section <A HREF="manual_NDBCluster.html#NDBCluster">16  MySQL Cluster</A>.

<DT><code>--new</code>
<DD>
The <code>--new</code> option can be used to make the server
behave as 4.1 in certain respects, easing a 4.0 to 4.1 upgrade:

<UL>
<LI>

Hexadecimal strings such as <code>0xFF</code> are treated as strings by
default rather than as numbers.  (Works in 4.0.12 and up.)
<LI>

<code>TIMESTAMP</code> is returned as a string with the format
<code>'YYYY-MM-DD HH:MM:SS'</code>.  (Works in 4.0.13 and up.)
See section <A HREF="manual_Column_types.html#Column_types">11  Column Types</A>.
</UL>

This option can be used to help you see how your applications will behave in
MySQL 4.1, without actually upgrading to 4.1.

<DT><code>--pid-file=<var>path</var></code>
<DD>
The path to the process ID file used by <code>mysqld_safe</code>.

<DT><code>--port=<var>port_num</var>, -P <var>port_num</var></code>
<DD>
The port number to use when listening for TCP/IP connections.

<DT><code>--old-protocol, -o</code>
<DD>
Use the 3.20 protocol for compatibility with some very old clients.
See section <A HREF="manual_Installing.html#Upgrading-from-3.20">2.10.6  Upgrading from Version 3.20 to 3.21</A>.

<DT><code>--one-thread</code>
<DD>
Only use one thread (for debugging under Linux).
This option is available only if the server is built with debugging enabled.
See section <A HREF="manual_Porting.html#Debugging_server">E.1  Debugging a MySQL Server</A>.

<DT><code>--open-files-limit=<var>count</var></code>
<DD>
To change the number of file descriptors available to <code>mysqld</code>.
If this is not set or set to 0, then <code>mysqld</code> will use this value
to reserve file descriptors to use with <code>setrlimit()</code>.  If this
value is 0 then <code>mysqld</code> will reserve <code>max_connections*5</code> or
<code>max_connections + table_cache*2</code> (whichever is larger) number of
files.  You should try increasing this if <code>mysqld</code> gives you the
error "Too many open files."

<DT><code>--safe-mode</code>
<DD>
Skip some optimization stages.

<DT><code>--safe-show-database</code>
<DD>
With this option, the <code>SHOW DATABASES</code> statement displays only the names
of those databases for which the user has some kind of privilege.
As of MySQL 4.0.2, this option is deprecated and doesn't do anything
(it is enabled by default), because there is now a <code>SHOW DATABASES</code>
privilege that can be used to control access to database
names on a per-account basis.
See section <A HREF="manual_MySQL_Database_Administration.html#Privileges_provided">5.5.3  Privileges Provided by MySQL</A>.

<DT><code>--safe-user-create</code>
<DD>
If this is enabled, a user can't create new users with the <code>GRANT</code>
statement, if the user doesn't have the <code>INSERT</code> privilege for the
<code>mysql.user</code> table or any column in the table.

<DT><code>--secure-auth</code>
<DD>
Disallow authentication for accounts that have old (pre-4.1) passwords.
This option is available as of MySQL 4.1.1.

<DT><code>--shared-memory</code>
<DD>
Enable shared-memory connections by local clients. This option is available
only on Windows. It was added in MySQL 4.1.0.

<DT><code>--shared-memory-base-name=<var>name</var></code>
<DD>
The name to use for shared-memory connections.  This option is available
only on Windows. It was added in MySQL 4.1.0.

<DT><code>--skip-bdb</code>
<DD>
Disable the <code>BDB</code> storage engine. This saves memory and might speed
up some operations.
Do not use this option if you require <code>BDB</code> tables.

<DT><code>--skip-concurrent-insert</code>
<DD>
Turn off the ability to select and insert at the same time on <code>MyISAM</code>
tables. (This is to be used only if you think you have found a bug in this
feature.)

<DT><code>--skip-delay-key-write</code>
<DD>
Ignore the <code>DELAY_KEY_WRITE</code> option for all tables.
As of MySQL 4.0.3, you should use <code>--delay-key-write=OFF</code> instead.
See section <A HREF="manual_MySQL_Optimization.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

<DT><code>--skip-external-locking</code>
<DD>
Don't use system locking.  To use <code>isamchk</code> or <code>myisamchk</code>,
you must shut down the server.  See section <A HREF="manual_Introduction.html#Stability">1.2.3  MySQL Stability</A>.  In MySQL 3.23, you
can use <code>CHECK TABLE</code> and <code>REPAIR TABLE</code> to check and repair
<code>MyISAM</code> tables.
This option previously was named <code>--skip-locking</code>.

<DT><code>--skip-grant-tables</code>
<DD>
This option causes the server not to use the privilege system at all. This
gives everyone <em>full access</em> to all databases!  (You can tell a running
server to start using the grant tables again by executing a <code>mysqladmin
flush-privileges</code> or <code>mysqladmin reload</code> command, or by issuing a
<code>FLUSH PRIVILEGES</code> statement.)

<DT><code>--skip-host-cache</code>
<DD>
Do not use the internal hostname cache for faster name-to-IP resolution.
Instead, query the DNS server every time a client connects.
See section <A HREF="manual_MySQL_Optimization.html#DNS">7.5.6  How MySQL Uses DNS</A>.

<DT><code>--skip-innodb</code>
<DD>
Disable the <code>InnoDB</code> storage engine.  This saves memory and disk
space and might speed up some operations.
Do not use this option if you require <code>InnoDB</code> tables.

<DT><code>--skip-isam</code>
<DD>
Disable the <code>ISAM</code> storage engine.  As of MySQL 4.1, <code>ISAM</code> is
disabled by default, so this option applies only if the server was configured
with support for <code>ISAM</code>.
This option was added in MySQL 4.1.1.

<DT><code>--skip-name-resolve</code>
<DD>
Do not resolve hostnames when checking client connections. Use only IP
numbers. If you use this option, all <code>Host</code> column values in the
grant tables must be IP numbers or <code>localhost</code>.  See section <A HREF="manual_MySQL_Optimization.html#DNS">7.5.6  How MySQL Uses DNS</A>.

<DT><code>--skip-ndbcluster</code>
<DD>
Disable the <code>NDB Cluster</code> storage engine. This is the default for binaries
that were built with <code>NDB Cluster</code> storage engine support, this means that
the system will only allocate memory and other resources for this storage engine
if it is explicitly enabled.

<DT><code>--skip-networking</code>
<DD>
Don't listen for TCP/IP connections at all.  All interaction with
<code>mysqld</code> must be made via named pipes or shared memory (on Windows) or Unix socket files
(on Unix).  This option is highly recommended for systems where only local
clients are allowed.  See section <A HREF="manual_MySQL_Optimization.html#DNS">7.5.6  How MySQL Uses DNS</A>.

<DT><code>--skip-new</code>
<DD>
Don't use new, possibly wrong routines.

<DT><code>--skip-symlink</code>
<DD>
This is the old form of <code>--skip-symbolic-links</code>, for use before MySQL
4.0.13.

<DT><code>--symbolic-links, --skip-symbolic-links</code>
<DD>
Enable or disable symbolic link support. This option has different effects on
Windows and Unix:


<UL>
<LI>

On Windows, enabling symbolic links allows you to establish a symbolic
link to a database directory by creating a
<code>directory.sym</code> file that contains the path to the real directory.
See section <A HREF="manual_MySQL_Optimization.html#Windows_symbolic_links">7.6.1.3  Using Symbolic Links for Databases on Windows</A>.

<LI>

On Unix, enabling symbolic links means that you can link a
<code>MyISAM</code> index file or data file to another directory with
the <code>INDEX DIRECTORY</code> or <code>DATA DIRECTORY</code> options of the
<code>CREATE TABLE</code> statement.  If you delete or rename the table,
the files that its symbolic links point to also are deleted or
renamed. See section <A HREF="manual_SQL_Syntax.html#CREATE_TABLE">13.2.6  <code>CREATE TABLE</code> Syntax</A>.
</UL>

This option was added in MySQL 4.0.13.

<DT><code>--skip-safemalloc</code>
<DD>
If MySQL is configured with <code>--with-debug=full</code>, all MySQL programs
check for memory overruns during each memory allocation and memory
freeing operation.  This checking is very slow, so for the server you
can avoid it when you don't need it by using the <code>--skip-safemalloc</code>
option.

<DT><code>--skip-show-database</code>
<DD>
With this option, the <code>SHOW DATABASES</code> statement is allowed only to
users who have the <code>SHOW DATABASES</code> privilege, and the statement
displays all database names.  Without this option, <code>SHOW DATABASES</code> is
allowed to all users, but displays each database name only if the user has
the <code>SHOW DATABASES</code> privilege or some privilege for the database.

<DT><code>--skip-stack-trace</code>
<DD>
Don't write stack traces.  This option is useful when you are running
<code>mysqld</code> under a debugger. On some systems, you also must use
this option to get a core file. See section <A HREF="manual_Porting.html#Debugging_server">E.1  Debugging a MySQL Server</A>.

<DT><code>--skip-thread-priority</code>
<DD>
Disable using thread priorities for faster response time.

<DT><code>--socket=<var>path</var></code>
<DD>
On Unix, this option specifies the Unix socket file to
use for local connections. The default value is <tt>`/tmp/mysql.sock'</tt>.
On Windows, the option specifies the pipe name to use for local connections
that use a named pipe. The default value is <code>MySQL</code>.

<DT><code>--sql-mode=<var>value</var>[,<var>value</var>[,<var>value</var>...]]</code>
<DD>
Set the SQL mode for MySQL. See section <A HREF="manual_MySQL_Database_Administration.html#Server_SQL_mode">5.2.2  The Server SQL Mode</A>. This option was added in 3.23.41.

<DT><code>--temp-pool</code>
<DD>
This option causes most temporary files created by the
server to use a small set of names, rather than a unique name for
each new file. This works around a problem in the Linux kernel
dealing with creating many
new files with different names. With the old behavior, Linux seems to
``leak'' memory, because it's being allocated to the directory entry cache
rather than to the disk cache.

<DT><code>--transaction-isolation=<var>level</var></code>
<DD>
Sets the default transaction isolation level, which can be
<code>READ-UNCOMMITTED</code>,
<code>READ-COMMITTED</code>,
<code>REPEATABLE-READ</code>, or
<code>SERIALIZABLE</code>.
See section <A HREF="manual_SQL_Syntax.html#SET_TRANSACTION">13.4.6  <code>SET TRANSACTION</code> Syntax</A>.

<DT><code>--tmpdir=<var>path</var>, -t <var>path</var></code>
<DD>
The path of the directory to use for creating temporary files. It might be
useful if your default <code>/tmp</code> directory resides on a partition that
is too small to hold temporary tables.  Starting from MySQL 4.1, this
option accepts several paths that are used in round-robin fashion. Paths
should be separated by colon characters (<samp>`:'</samp>) on Unix and semicolon
characters (<samp>`;'</samp>) on Windows, NetWare, and OS/2.
If the MySQL server is acting as a replication slave, you should not set
<code>--tmpdir</code> to point to a directory on a memory-based filesystem or to a
directory that is cleared when the server host restarts.  A replication
slave needs some of its temporary files to survive a machine restart so that
it can replicate temporary tables or <code>LOAD DATA INFILE</code> operations. If
files in the temporary file directory are lost when the server restarts,
replication will fail.

<DT><code>--user={<var>user_name</var> | <var>user_id</var>}, -u {<var>user_name</var> | <var>user_id</var>}</code>
<DD>
Run the <code>mysqld</code> server as the user having the name <var>user_name</var> or
the numeric user ID <var>user_id</var>.
(``User'' in this context refers to a system login account, not a MySQL user
listed in the grant tables.)

This option is <em>mandatory</em> when starting <code>mysqld</code> as <code>root</code>.
The server will change its user ID during its startup sequence, causing it
to run as that particular user rather than as <code>root</code>.
See section <A HREF="manual_MySQL_Database_Administration.html#Security_guidelines">5.4.1  General Security Guidelines</A>.

Starting from MySQL 3.23.56 and 4.0.12:
To avoid a possible security hole where a user adds a <code>--user=root</code>
option to some <tt>`my.cnf'</tt> file (thus causing the server to run as
<code>root</code>), <code>mysqld</code> uses only the first
<code>--user</code> option specified and produces a warning if there are multiple
<code>--user</code> options. Options in <tt>`/etc/my.cnf'</tt> and
<tt>`datadir/my.cnf'</tt> are processed before
command-line options, so it is recommended that you
put a <code>--user</code> option in <tt>`/etc/my.cnf'</tt> and specify a value other than
<code>root</code>. The option in <tt>`/etc/my.cnf'</tt> will be found before any other
<code>--user</code> options, which ensures that the server runs as a user other
than <code>root</code>, and that a warning results if any other <code>--user</code> option
is found.

<DT><code>--version, -V</code>
<DD>
Display version information and exit.

</DL>

<P>
As of MySQL 4.0,
you can assign a value to a server system variable by using an option of
the form <code>--<var>var_name</var>=<var>value</var></code>. For example, <code>--key_buffer_size=32M</code>
sets the <code>key_buffer_size</code> variable to a value of 32MB.

</P>
<P>
Note that when setting a variable to a value, MySQL might automatically
correct it to stay within a given range, or adjust the value to the
closest allowable value if only certain values are allowed.

</P>
<P>
It is also possible to set variables by using
<code>--set-variable=<var>var_name</var>=<var>value</var></code> or <code>-O <var>var_name</var>=<var>value</var></code>
syntax. However, this syntax is deprecated as of MySQL 4.0.

</P>
<P>
You can find a full description for all variables in section <A HREF="manual_MySQL_Database_Administration.html#Server_system_variables">5.2.3  Server System Variables</A>.  The section on tuning server parameters includes information
on how to optimize them.  See section <A HREF="manual_MySQL_Optimization.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

</P>
<P>
You can change the values of most system variables for a running server with the
<code>SET</code> statement. See section <A HREF="manual_SQL_Syntax.html#SET_OPTION">13.5.3  <code>SET</code> Syntax</A>.

</P>
<P>
If you want to restrict the maximum value that a startup option can be set to
with <code>SET</code>, you can define this by using the
<code>--maximum-<var>var_name</var></code> command-line option.

</P>



<H3><A NAME="Server_SQL_mode" HREF="manual_toc.html#Server_SQL_mode">5.2.2  The Server SQL Mode</A></H3>

<P>
The MySQL server can operate in different SQL modes, and (as of MySQL 4.1)
can apply these modes differentially for different clients. This allows
an application to tailor server operation to its own requirements.

</P>
<P>
Modes define what SQL syntax MySQL should support and what kind of data
validation checks it should perform.  This makes it easier to use MySQL in
different environments and to use MySQL together with other database servers.

</P>
<P>
You can set the default SQL mode by starting <code>mysqld</code> with the
<code>--sql-mode="<var>modes</var>"</code> option.  The value also can be empty
(<code>--sql-mode=""</code>) if you want to reset it.

</P>
<P>
Beginning with MySQL 4.1, you can also change the SQL mode after startup time
by setting the <code>sql_mode</code> variable with a <code>SET [SESSION|GLOBAL]
sql_mode='<var>modes</var>'</code> statement.  Setting the <code>GLOBAL</code> variable
requires the <code>SUPER</code> privilege and affects the operation of all clients
that connect from that time on. Setting the <code>SESSION</code> variable affects
only the current client.  Any client can change its session <code>sql_mode</code>
value.

</P>
<P>
<var>modes</var> is a list of different modes separated
by comma (<samp>`,'</samp>) characters.  You can retrieve the current mode by
issuing a <code>SELECT @@sql_mode</code> statement. The default value is empty
(no modes set).

</P>

<P>
The most important <code>sql_mode</code> values are probably these:

</P>
<DL COMPACT>

<DT><code>ANSI</code>
<DD>
<A NAME="IDX460"></A>
Change syntax and behavior to be more conformant to standard SQL.
(New in MySQL 4.1.1)

<DT><code>STRICT_TRANS_TABLES</code>
<DD>
<A NAME="IDX461"></A>
If a value could not be inserted as given into a transactional table, abort
the statement.  For a non-transactional table, abort the statement if the
value occurs in a single-row statement or the first row of a multiple-row
statement. More detail is given later in this section.
(New in MySQL 5.0.2)

<DT><code>TRADITIONAL</code>
<DD>
<A NAME="IDX462"></A>
Make MySQL behave like a ``traditional'' SQL database system.  A simple
description of this mode is ``give an error instead of a warning''
when inserting an incorrect value into a column.  <strong>Note</strong>: The
<code>INSERT</code>/<code>UPDATE</code> will abort as soon as the error is noticed.
This may not be what you want if you are using a non-transactional storage
engine, because data changes made prior to the error will not be rolled
back, resulting in a ``partially-done'' update.  (New in MySQL 5.0.2)

</DL>

<P>
<A NAME="IDX463"></A>
When this manual refers to ``strict mode,'' it means a mode where at least
one of <code>STRICT_TRANS_TABLES</code> or <code>STRICT_ALL_TABLES</code> is enabled.

</P>
<P>
The following list describes all the supported modes:

</P>

<DL COMPACT>

<DT><code>ALLOW_INVALID_DATES</code>
<DD>
<A NAME="IDX464"></A>
Don't do full checking of dates in strict mode. Check only that the month is
in the range from 1 to 12 and the day is in the range from 1 to 31. This
is very convenient for Web applications where you obtain year, month,
and day in three different fields and you want to store exactly what the
user inserted (without date validation).  This mode applies to <code>DATE</code>
and <code>DATETIME</code> columns. It does not apply <code>TIMESTAMP</code> columns,
which always require a valid date.

This mode is new in MySQL 5.0.2. Before 5.0.2, this was the default MySQL
date-handling mode. As of 5.0.2, enabling strict mode causes the server to
require that month and day values be legal, not just in the range from 1
to 12 and 1 to 31. For example, <code>'2004-04-31'</code> is legal with strict
mode disabled, but illegal with strict mode enabled. To allow such dates
in strict mode, enable <code>ALLOW_INVALID_DATES</code> as well.

<DT><code>ANSI_QUOTES</code>
<DD>
<A NAME="IDX465"></A>
Treat <samp>`"'</samp> as an identifier quote character (like the
<samp>``'</samp> quote character) and not as a string quote character. You can still
use <samp>``'</samp> to quote identifers in ANSI mode. With <code>ANSI_QUOTES</code>
enabled, you cannot use double quotes to quote a literal string, because it
will be interpreted as an identifier.
(New in MySQL 4.0.0)

<DT><code>ERROR_FOR_DIVISION_BY_ZERO</code>
<DD>
<A NAME="IDX466"></A>
Produce an error in strict mode (otherwise a warning) when we
encounter a division by zero (or <code>MOD(X,0)</code>) during an <code>INSERT</code>/
<code>UPDATE</code>. If this mode is not given, MySQL instead returns
<code>NULL</code> for divisions by zero.  If used with <code>IGNORE</code>, MySQL
generates a warning for divisions by zero, but the result of the operation is
<code>NULL</code>.
(New in MySQL 5.0.2)

<DT><code>HIGH_NOT_PRECEDENCE</code>
<DD>
<A NAME="IDX467"></A>
From MySQL 5.0.2 on, the <code>NOT</code> operator precedence is handled
so that expressions such as
<code>NOT a BETWEEN b AND c</code> are parsed as
<code>NOT (a BETWEEN b AND c)</code>.
Before MySQL 5.0.2, the expression is parsed as
<code>(NOT a) BETWEEN b AND c</code>.
The old higher-precedence behavior can be obtained by enabling the
<code>HIGH_NOT_PRECEDENCE</code> SQL mode.
(New in MySQL 5.0.2)


<PRE>
mysql&#62; SET sql_mode = '';
mysql&#62; SELECT NOT 1 BETWEEN -5 AND 5;
        -&#62; 0
mysql&#62; SET sql_mode = 'broken_not';
mysql&#62; SELECT NOT 1 BETWEEN -5 AND 5;
        -&#62; 1
</PRE>

<DT><code>IGNORE_SPACE</code>
<DD>
<A NAME="IDX468"></A>
Allow spaces between a function name and the <samp>`('</samp> character.  This forces
all function names to be treated as reserved words. As a result, if you want
to access any database, table, or column name that is a reserved word, you
must quote it.  For example, because there is a <code>USER()</code> function, the
name of the <code>user</code> table in the <code>mysql</code> database and the <code>User</code>
column in that table become reserved, so you must quote them:


<PRE>
SELECT "User" FROM mysql."user";
</PRE>

(New in MySQL 4.0.0)

<DT><code>NO_AUTO_CREATE_USER</code>
<DD>
<A NAME="IDX469"></A>
Prevent <code>GRANT</code> from automatically creating new users if it would
otherwise do so, unless a password also is specified.
(New in MySQL 5.0.2)

<DT><code>NO_AUTO_VALUE_ON_ZERO</code>
<DD>
<A NAME="IDX470"></A>
<code>NO_AUTO_VALUE_ON_ZERO</code> affects handling of <code>AUTO_INCREMENT</code>
columns. Normally, you generate the next sequence number for the column by
inserting either <code>NULL</code> or <code>0</code> into it.
<code>NO_AUTO_VALUE_ON_ZERO</code> suppresses this behavior for <code>0</code> so that
only <code>NULL</code> generates the next sequence number.
(New in MySQL 4.1.1)

This mode can be useful if <code>0</code> has been stored in a table's
<code>AUTO_INCREMENT</code> column. (This is not a recommended practice, by
the way.)  For example, if you dump the table with <code>mysqldump</code>
and then reload it, MySQL normally generates new sequence numbers when
it encounters the <code>0</code> values, resulting in a table with different
contents than the one that was dumped. Enabling <code>NO_AUTO_VALUE_ON_ZERO</code>
before reloading the dump file solves this problem. As of MySQL 4.1.1,
<code>mysqldump</code> automatically includes a statement in the dump output
to enable <code>NO_AUTO_VALUE_ON_ZERO</code>.

<DT><code>NO_DIR_IN_CREATE</code>
<DD>
<A NAME="IDX471"></A>
When creating a table, ignore all <code>INDEX DIRECTORY</code> and <code>DATA
DIRECTORY</code> directives. This option is useful on slave replication servers.
(New in MySQL 4.0.15)

<DT><code>NO_FIELD_OPTIONS</code>
<DD>
<A NAME="IDX472"></A>
Don't print MySQL-specific column options in the output of <code>SHOW CREATE
TABLE</code>. This mode is used by <code>mysqldump</code> in portability mode.
(New in MySQL 4.1.1)

<DT><code>NO_KEY_OPTIONS</code>
<DD>
<A NAME="IDX473"></A>
Don't print MySQL-specific index options in the output of <code>SHOW CREATE
TABLE</code>. This mode is used by <code>mysqldump</code> in portability mode.
(New in MySQL 4.1.1)

<DT><code>NO_TABLE_OPTIONS</code>
<DD>
<A NAME="IDX474"></A>
Don't print MySQL-specific table options (such as <code>ENGINE</code>) in the
output of <code>SHOW CREATE TABLE</code>. This mode is used by <code>mysqldump</code> in
portability mode.
(New in MySQL 4.1.1)

<DT><code>NO_UNSIGNED_SUBTRACTION</code>
<DD>
<A NAME="IDX475"></A>
In subtraction operations, don't mark the result as <code>UNSIGNED</code> if one
of the operands is unsigned. Note that this makes <code>UNSIGNED BIGINT</code> not
100% usable in all contexts. See section <A HREF="manual_Functions.html#Cast_Functions">12.7  Cast Functions and Operators</A>.
(New in MySQL 4.0.2)

<DT><code>NO_ZERO_DATE</code>
<DD>
<A NAME="IDX476"></A>
Don't allow <code>'0000-00-00'</code> as a valid date. You can still insert zero
dates with the <code>IGNORE</code> option.
(New in MySQL 5.0.2)

<DT><code>NO_ZERO_IN_DATE</code>
<DD>
<A NAME="IDX477"></A>
Don't accept dates where the month or day part is 0. If used with the
<code>IGNORE</code> option, we insert a <code>'0000-00-00'</code> date for any such date.
(New in MySQL 5.0.2)

<DT><code>ONLY_FULL_GROUP_BY</code>
<DD>
<A NAME="IDX478"></A>
Don't allow queries that in the <code>GROUP BY</code> part refer to a not
selected column.
(New in MySQL 4.0.0)

<DT><code>PIPES_AS_CONCAT</code>
<DD>
<A NAME="IDX479"></A>
Treat <code>||</code> as a string concatenation operator (same as <code>CONCAT()</code>)
rather than as a synonym for <code>OR</code>.
(New in MySQL 4.0.0)

<DT><code>REAL_AS_FLOAT</code>
<DD>
<A NAME="IDX480"></A>
Treat <code>REAL</code> as a synonym for <code>FLOAT</code> rather than as a synonym for
<code>DOUBLE</code>.
(New in MySQL 4.0.0)

<DT><code>STRICT_ALL_TABLES</code>
<DD>
<A NAME="IDX481"></A>
Enable strict mode for all storage engines.  Invalid data values are rejected.
Additional detail follows.
(New in MySQL 5.0.2)

<DT><code>STRICT_TRANS_TABLES</code>
<DD>
<A NAME="IDX482"></A>
Enable strict mode for transactional storage engines, and when possible for
non-transactional storage engines.  Additional detail follows.
(New in MySQL 5.0.2)

</DL>

<P>
Strict mode controls how MySQL handles values that are invalid or missing. A
value can be invalid for several reasons.  For example, it might have
the wrong data type for the column, or it might be out of range. A value
is missing when a new row to be inserted does not contain a value for a
column that has no explicit <code>DEFAULT</code> clause in its definition.

</P>
<P>
For transactional tables, an error occurs for invalid or missing
values in a statement when either of the <code>STRICT_ALL_TABLES</code> or
<code>STRICT_TRANS_TABLES</code> modes are enabled.  The statement is aborted
and rolled back.

</P>
<P>
For non-transactional tables, the behavior is the same for either mode,
if the bad value occurs in the first row to be inserted or updated.
The statement is aborted and the table remains unchanged.  If the statement
inserts or modifies multiple rows and the bad value occurs in the second or
later row, the result depends on which strict option is enabled:

</P>

<UL>

<LI>

For <code>STRICT_ALL_TABLES</code>, MySQL returns an error and ignores the
rest of the rows. However, in this case, the earlier rows will already
have been inserted or updated.  This means that you might get a partial
update, which might not be what you want.  To avoid this, it's best to
use single-row statements because these can be aborted without changing the
table.

<LI>

For <code>STRICT_TRANS_TABLES</code>, MySQL converts an invalid value to the
closest valid value for the column and insert the adjusted value. If a
value is missing, MySQL inserts the implicit default value for the column
data type.  In either case, MySQL generates a warning rather than an error
and continues processing the statement. Implicit defaults are described in
section <A HREF="manual_SQL_Syntax.html#CREATE_TABLE">13.2.6  <code>CREATE TABLE</code> Syntax</A>.

</UL>

<P>
Strict mode disallows invalid date values such as <code>'2004-04-31'</code>.
It does not disallow dates with zero parts such as <code>2004-04-00'</code> or
``zero'' dates. To disallow these as well, enable the <code>NO_ZERO_IN_DATE</code>
and <code>NO_ZERO_DATE</code> SQL modes in addition to strict mode.

</P>
<P>
If you are not using strict mode (that is, neither <code>STRICT_TRANS_TABLES</code>
nor <code>STRICT_ALL_TABLES</code> is enabled), MySQL inserts adjusted values
for invalid or missing values and produces warnings.  In strict mode, you can
produce this behavior by using <code>INSERT IGNORE</code> or <code>UPDATE IGNORE</code>.
See section <A HREF="manual_SQL_Syntax.html#SHOW_WARNINGS">13.5.4.20  <code>SHOW WARNINGS</code> Syntax</A>.

</P>
<P>
The following special modes are provided as shorthand for combinations of
mode values from the preceding list.  All are available as of MySQL 4.1.1,
except <code>TRADITIONAL</code> (5.0.2).

</P>
<P>
The descriptions include all mode values that are available in the most
recent version of MySQL.  For older versions, a combination mode does not
include individual mode values that are not available except in newer
versions.

</P>
<DL COMPACT>

<DT><code>ANSI</code>
<DD>
<A NAME="IDX483"></A>
Equivalent to
<code>REAL_AS_FLOAT</code>, <code>PIPES_AS_CONCAT</code>, <code>ANSI_QUOTES</code>, <code>IGNORE_SPACE</code>, <code>ONLY_FULL_GROUP_BY</code>. See section <A HREF="manual_Introduction.html#ANSI_mode">1.5.3  Running MySQL in ANSI Mode</A>.

<DT><code>DB2</code>
<DD>
<A NAME="IDX484"></A>
Equivalent to
<code>PIPES_AS_CONCAT</code>, <code>ANSI_QUOTES</code>, <code>IGNORE_SPACE</code>, <code>NO_KEY_OPTIONS</code>, <code>NO_TABLE_OPTIONS</code>, <code>NO_FIELD_OPTIONS</code>.

<DT><code>MAXDB</code>
<DD>
<A NAME="IDX485"></A>
Equivalent to
<code>PIPES_AS_CONCAT</code>, <code>ANSI_QUOTES</code>, <code>IGNORE_SPACE</code>, <code>NO_KEY_OPTIONS</code>, <code>NO_TABLE_OPTIONS</code>, <code>NO_FIELD_OPTIONS</code>, <code>NO_AUTO_CREATE_USER</code>.

<DT><code>MSSQL</code>
<DD>
<A NAME="IDX486"></A>
Equivalent to
<code>PIPES_AS_CONCAT</code>, <code>ANSI_QUOTES</code>, <code>IGNORE_SPACE</code>, <code>NO_KEY_OPTIONS</code>, <code>NO_TABLE_OPTIONS</code>, <code>NO_FIELD_OPTIONS</code>.

<DT><code>MYSQL323</code>
<DD>
<A NAME="IDX487"></A>
Equivalent to
<code>NO_FIELD_OPTIONS</code>, <code>HIGH_NOT_PRECEDENCE</code>.

<DT><code>MYSQL40</code>
<DD>
<A NAME="IDX488"></A>
Equivalent to
<code>NO_FIELD_OPTIONS</code>, <code>HIGH_NOT_PRECEDENCE</code>.

<DT><code>ORACLE</code>
<DD>
<A NAME="IDX489"></A>
Equivalent to
<code>PIPES_AS_CONCAT</code>, <code>ANSI_QUOTES</code>, <code>IGNORE_SPACE</code>, <code>NO_KEY_OPTIONS</code>, <code>NO_TABLE_OPTIONS</code>, <code>NO_FIELD_OPTIONS</code>, <code>NO_AUTO_CREATE_USER</code>.

<DT><code>POSTGRESQL</code>
<DD>
<A NAME="IDX490"></A>
Equivalent to
<code>PIPES_AS_CONCAT</code>, <code>ANSI_QUOTES</code>, <code>IGNORE_SPACE</code>, <code>NO_KEY_OPTIONS</code>, <code>NO_TABLE_OPTIONS</code>, <code>NO_FIELD_OPTIONS</code>.

<DT><code>TRADITIONAL</code>
<DD>
<A NAME="IDX491"></A>
Equivalent to
<code>STRICT_TRANS_TABLES</code>, <code>STRICT_ALL_TABLES</code>, <code>NO_ZERO_IN_DATE</code>, <code>NO_ZERO_DATE</code>, <code>ERROR_FOR_DIVISION_BY_ZERO</code>, <code>NO_AUTO_CREATE_USER</code>.
</DL>



<H3><A NAME="Server_system_variables" HREF="manual_toc.html#Server_system_variables">5.2.3  Server System Variables</A></H3>

<P>
<A NAME="IDX492"></A>
<A NAME="IDX493"></A>
<A NAME="IDX494"></A>
<A NAME="IDX495"></A>

</P>

<P>
The server maintains many system variables that indicate how it is configured.
All of them have default values. They can be set at server startup
using options on the command line or in option
files. Most of them can be set at runtime using the
<code>SET</code> statement.

</P>

<P>
Beginning with MySQL 4.0.3,
the <code>mysqld</code> server maintains two kinds of variables.
Global variables affect the overall operation of the server.
Session variables affect its operation for individual client connections.

</P>
<P>
When the server starts, it initializes all global variables to their default
values. These defaults can be changed by options specified in option files
or on the command line.  After the server starts, those global variables
that are dynamic can be changed by connecting to the server and issuing
a <code>SET GLOBAL <var>var_name</var></code> statement. To change a global variable,
you must have the <code>SUPER</code> privilege.

</P>
<P>
The server also maintains a set of session variables for each client
that connects. The client's session variables are initialized at connect
time using the current values of the corresponding global variables. For
those session variables that are dynamic, the client can change them
by issuing a <code>SET SESSION <var>var_name</var></code> statement. Setting a session
variable requires no special privilege, but a client can change only its
own session variables, not those of any other client.

</P>
<P>
A change to a global variable is visible to any client that accesses that
global variable. However, it affects the corresponding session variable
that is initialized from the global variable only for clients that connect
after the change.  It does not affect the session variable for any client
that is already connected (not even that of the client that issues the
<code>SET GLOBAL</code> statement).

</P>
<P>
When setting a variable using a startup option, variable values can be given
with a suffix of <code>K</code>, <code>M</code>, or <code>G</code> to indicate kilobytes,
megabytes, or gigabytes, respectively. For example, the following command
starts the server with a key buffer size of 16 megabytes:

</P>

<PRE>
mysqld --key_buffer_size=16M
</PRE>

<P>
Before MySQL 4.0, use this syntax instead:

</P>

<PRE>
mysqld --set-variable=key_buffer_size=16M
</PRE>

<P>
The lettercase of suffix letters does not matter; <code>16M</code> and <code>16m</code> are
equivalent.

</P>
<P>
At runtime, use the <code>SET</code> statement to set system variables. In this
context, suffix letters cannot be used, but the value can take the form of an
expression:

</P>

<PRE>
mysql&#62; SET sort_buffer_size = 10 * 1024 * 1024;
</PRE>

<P>
To specify explicitly whether to set the global or session variable, use the
<code>GLOBAL</code> or <code>SESSION</code> options:

</P>

<PRE>
mysql&#62; SET GLOBAL sort_buffer_size = 10 * 1024 * 1024;
mysql&#62; SET SESSION sort_buffer_size = 10 * 1024 * 1024;
</PRE>

<P>
Without either option, the statement sets the session variable.

</P>
<P>
The variables that can be set at runtime are listed in
section <A HREF="manual_MySQL_Database_Administration.html#Dynamic_System_Variables">5.2.3.1  Dynamic System Variables</A>.

</P>
<P>
If you want to restrict the maximum value to which a system variable can
be set with the <code>SET</code> statement, you can specify this maximum
by using an option of the form <code>--maximum-<var>var_name</var></code> at server
startup. For example, to prevent the value of <code>query_cache_size</code>
from being increased to more than 32MB at runtime, use the option
<code>--maximum-query_cache_size=32M</code>. This feature is available as of MySQL
4.0.2.

</P>
<P>
You can view system variables and their values by using the
<code>SHOW VARIABLES</code> statement.
See section <A HREF="manual_Language_Structure.html#System_Variables">9.4  System Variables</A> for more information.

</P>

<PRE>
mysql&#62; SHOW VARIABLES;
+---------------------------------+------------------------------+
| Variable_name                   | Value                        |
+---------------------------------+------------------------------|
| back_log                        | 50                           |
| basedir                         | /usr/local/mysql             |
| bdb_cache_size                  | 8388572                      |
| bdb_home                        | /usr/local/mysql             |
| bdb_log_buffer_size             | 32768                        |
| bdb_logdir                      |                              |
| bdb_max_lock                    | 10000                        |
| bdb_shared_data                 | OFF                          |
| bdb_tmpdir                      | /tmp/                        |
| bdb_version                     | Sleepycat Software: ...      |
| binlog_cache_size               | 32768                        |
| bulk_insert_buffer_size         | 8388608                      |
| character_set                   | latin1                       |
| character_sets                  | latin1 big5 czech euc_kr     |
| concurrent_insert               | ON                           |
| connect_timeout                 | 5                            |
| convert_character_set           |                              |
| datadir                         | /usr/local/mysql/data/       |
| default_week_format             | 0                            |
| delay_key_write                 | ON                           |
| delayed_insert_limit            | 100                          |
| delayed_insert_timeout          | 300                          |
| delayed_queue_size              | 1000                         |
| flush                           | OFF                          |
| flush_time                      | 0                            |
| ft_boolean_syntax               | + -&#62;&#60;()~*:""&#38;|               |
| ft_max_word_len                 | 84                           |
| ft_min_word_len                 | 4                            |
| ft_query_expansion_limit        | 20                           |
| ft_stopword_file                | (built-in)                   |
| have_bdb                        | YES                          |
| have_innodb                     | YES                          |
| have_isam                       | YES                          |
| have_openssl                    | YES                          |
| have_query_cache                | YES                          |
| have_raid                       | NO                           |
| have_symlink                    | DISABLED                     |
| init_file                       |                              |
| innodb_additional_mem_pool_size | 1048576                      |
| innodb_buffer_pool_size         | 8388608                      |
| innodb_data_file_path           | ibdata1:10M:autoextend       |
| innodb_data_home_dir            |                              |
| innodb_fast_shutdown            | ON                           |
| innodb_file_io_threads          | 4                            |
| innodb_flush_log_at_trx_commit  | 1                            |
| innodb_flush_method             |                              |
| innodb_force_recovery           | 0                            |
| innodb_lock_wait_timeout        | 50                           |
| innodb_log_arch_dir             |                              |
| innodb_log_archive              | OFF                          |
| innodb_log_buffer_size          | 1048576                      |
| innodb_log_file_size            | 5242880                      |
| innodb_log_files_in_group       | 2                            |
| innodb_log_group_home_dir       | ./                           |
| innodb_mirrored_log_groups      | 1                            |
| innodb_thread_concurrency       | 8                            |
| interactive_timeout             | 28800                        |
| join_buffer_size                | 131072                       |
| key_buffer_size                 | 16773120                     |
| key_cache_age_threshold         | 300                          |
| key_cache_block_size            | 1024                         |
| key_cache_division_limit        | 100                          |
| language                        | /usr/local/mysql/share/...   |
| large_files_support             | ON                           |
| local_infile                    | ON                           |
| locked_in_memory                | OFF                          |
| log                             | OFF                          |
| log_bin                         | OFF                          |
| log_slave_updates               | OFF                          |
| log_slow_queries                | OFF                          |
| log_update                      | OFF                          |
| log_warnings                    | 1                            |
| long_query_time                 | 10                           |
| low_priority_updates            | OFF                          |
| lower_case_table_names          | 0                            |
| max_allowed_packet              | 1047552                      |
| max_binlog_cache_size           | 4294967295                   |
| max_binlog_size                 | 1073741824                   |
| max_connect_errors              | 10                           |
| max_connections                 | 100                          |
| max_delayed_threads             | 20                           |
| max_error_count                 | 64                           |
| max_heap_table_size             | 16777216                     |
| max_join_size                   | 4294967295                   |
| max_relay_log_size              | 0                            |
| max_sort_length                 | 1024                         |
| max_tmp_tables                  | 32                           |
| max_user_connections            | 0                            |
| max_write_lock_count            | 4294967295                   |
| myisam_max_extra_sort_file_size | 268435456                    |
| myisam_max_sort_file_size       | 2147483647                   |
| myisam_recover_options          | force                        |
| myisam_repair_threads           | 1                            |
| myisam_sort_buffer_size         | 8388608                      |
| net_buffer_length               | 16384                        |
| net_read_timeout                | 30                           |
| net_retry_count                 | 10                           |
| net_write_timeout               | 60                           |
| open_files_limit                | 1024                         |
| pid_file                        | /usr/local/mysql/name.pid    |
| port                            | 3306                         |
| protocol_version                | 10                           |
| query_cache_limit               | 1048576                      |
| query_cache_size                | 0                            |
| query_cache_type                | ON                           |
| read_buffer_size                | 131072                       |
| read_rnd_buffer_size            | 262144                       |
| rpl_recovery_rank               | 0                            |
| server_id                       | 0                            |
| skip_external_locking           | ON                           |
| skip_networking                 | OFF                          |
| skip_show_database              | OFF                          |
| slave_net_timeout               | 3600                         |
| slow_launch_time                | 2                            |
| socket                          | /tmp/mysql.sock              |
| sort_buffer_size                | 2097116                      |
| sql_mode                        |                              |
| table_cache                     | 64                           |
| table_type                      | MYISAM                       |
| thread_cache_size               | 3                            |
| thread_stack                    | 131072                       |
| timezone                        | EEST                         |
| tmp_table_size                  | 33554432                     |
| tmpdir                          | /tmp/:/mnt/hd2/tmp/          |
| tx_isolation                    | READ-COMMITTED               |
| version                         | 4.0.4-beta                   |
| wait_timeout                    | 28800                        |
+---------------------------------+------------------------------+
</PRE>

<P>
<A NAME="IDX496"></A>

</P>
<P>
Most system variables are described here.  Variables with no version
indicated have been present since at least MySQL 3.22.  <code>InnoDB</code> system
variables are listed at
section <A HREF="manual_InnoDB.html#InnoDB_start">15.5  <code>InnoDB</code> Startup Options</A>.

</P>
<P>
Values for buffer sizes, lengths, and stack sizes are given in bytes unless
otherwise specified.

</P>
<P>
Information on tuning these variables can be found in section <A HREF="manual_MySQL_Optimization.html#Server_parameters">7.5.2  Tuning Server Parameters</A>.

</P>
<DL COMPACT>

<DT><code>ansi_mode</code>
<DD>
This is <code>ON</code> if <code>mysqld</code> was started with <code>--ansi</code>.
See section <A HREF="manual_Introduction.html#ANSI_mode">1.5.3  Running MySQL in ANSI Mode</A>.
This variable was added in MySQL 3.23.6 and removed in 3.23.41.
See the description for <code>sql_mode</code>.

<DT><code>back_log</code>
<DD>
The number of outstanding connection requests MySQL can have. This
comes into play when the main MySQL thread gets very
many connection requests in a very short time. It then takes some time
(although very little) for the main thread to check the connection and start
a new thread. The <code>back_log</code> value indicates how many requests can be
stacked during this short time before MySQL momentarily stops
answering new requests. You need to increase this only if you expect a large
number of connections in a short period of time.

In other words, this value is the size of the listen queue for incoming
TCP/IP connections.  Your operating system has its own limit on the size
of this queue.  The manual page for the Unix <code>listen()</code> system
call should have more details.  Check your OS documentation for the
maximum value for this variable.  Attempting to set <code>back_log</code>
higher than your operating system limit will be ineffective.

<DT><code>basedir</code>
<DD>
The MySQL installation base directory. This variable can be set with the
<code>--basedir</code> option.

<DT><code>bdb_cache_size</code>
<DD>
The size of the buffer that is allocated for caching indexes and rows for
<code>BDB</code> tables.  If you don't use <code>BDB</code> tables, you should start
<code>mysqld</code> with <code>--skip-bdb</code> to not waste memory for this cache.
This variable was added in MySQL 3.23.14.

<DT><code>bdb_home</code>
<DD>
The base directory for <code>BDB</code> tables.  This should be assigned the same
value as the <code>datadir</code> variable.
This variable was added in MySQL 3.23.14.

<DT><code>bdb_log_buffer_size</code>
<DD>
The size of the buffer that is allocated for caching indexes and rows for
<code>BDB</code> tables.  If you don't use <code>BDB</code> tables, you should set this
to 0 or start <code>mysqld</code> with <code>--skip-bdb</code> to not waste memory for
this cache.
This variable was added in MySQL 3.23.31.

<DT><code>bdb_logdir</code>
<DD>
The directory where the <code>BDB</code> storage engine writes its log files.
This variable can be set with the <code>--bdb-logdir</code> option.
This variable was added in MySQL 3.23.14.

<DT><code>bdb_max_lock</code>
<DD>
The maximum number of locks you can have active on a <code>BDB</code> table
(10,000 by default). You should increase this if errors such as the
following occur when you perform long transactions or when <code>mysqld</code> has
to examine many rows to calculate a query:


<PRE>
bdb: Lock table is out of available locks
Got error 12 from ...
</PRE>

This variable was added in MySQL 3.23.29.

<DT><code>bdb_shared_data</code>
<DD>
This is <code>ON</code> if you are using <code>--bdb-shared-data</code>.
This variable was added in MySQL 3.23.29.

<DT><code>bdb_tmpdir</code>
<DD>
The value of the <code>--bdb-tmpdir</code> option.
This variable was added in MySQL 3.23.14.

<DT><code>bdb_version</code>
<DD>
See the description for <code>version_bdb</code>.

<DT><code>binlog_cache_size</code>
<DD>
The size of the cache to hold the SQL statements for the binary log during
a transaction.  A binary log cache is allocated for each client if the
server supports any transactional storage engines and, starting from MySQL
4.1.2, if the server has binary log enabled (<code>--log-bin</code> option). If you
often use big, multiple-statement transactions, you can increase this to get
more performance.
The <code>Binlog_cache_use</code> and <code>Binlog_cache_disk_use</code> status variables
can be useful for tuning the size of this variable.
This variable was added in MySQL 3.23.29.
See section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>.

<DT><code>bulk_insert_buffer_size</code>
<DD>
<code>MyISAM</code> uses a special tree-like cache to make bulk inserts faster for
<code>INSERT ... SELECT</code>, <code>INSERT ... VALUES (...), (...), ...</code>, and
<code>LOAD DATA INFILE</code>. This variable limits
the size of the cache tree in bytes per thread. Setting it to 0
disables this optimization.
<strong>Note</strong>: This cache is used only when adding data to a non-empty table.
The default value is 8MB.
This variable was added in MySQL 4.0.3.
This variable previously was named <code>myisam_bulk_insert_tree_size</code>.

<DT><code>character_set</code>
<DD>
The default character set.
This variable was added in MySQL 3.23.3, then
removed in MySQL 4.1.1 and replaced by the various
<code>character_set_<var>xxx</var></code> variables.

<DT><code>character_set_client</code>
<DD>
The character set for statements that arrive from the client.
This variable was added in MySQL 4.1.1.

<DT><code>character_set_connection</code>
<DD>
The character set used for literals that do not have a character set
introducer and for number-to-string conversion.
This variable was added in MySQL 4.1.1.

<DT><code>character_set_database</code>
<DD>
The character set used by the default database.
The server sets this variable whenever the default database changes.
If there is no default database, the variable has the same value as
<code>character_set_server</code>.
This variable was added in MySQL 4.1.1.

<DT><code>character_set_results</code>
<DD>
The character set used for returning query results to the client.
This variable was added in MySQL 4.1.1.

<DT><code>character_set_server</code>
<DD>
The server default character set.
This variable was added in MySQL 4.1.1.

<DT><code>character_set_system</code>
<DD>
The character set used by the server for storing identifiers.
The value is always <code>utf8</code>.
This variable was added in MySQL 4.1.1.

<DT><code>character_sets</code>
<DD>
The supported character sets.
This variable was added in MySQL 3.23.15 and removed in MySQL 4.1.1.
(Use <code>SHOW CHARACTER SET</code> for a list of character sets.)

<DT><code>character_sets_dir</code>
<DD>
The directory where character sets are installed.
This variable was added in MySQL 4.1.2.

<DT><code>collation_connection</code>
<DD>
The collation of the connection character set.
This variable was added in MySQL 4.1.1.

<DT><code>collation_database</code>
<DD>
The collation used by the default database.
The server sets this variable whenever the default database changes.
If there is no default database, the variable has the same value as
<code>collation_server</code>.
This variable was added in MySQL 4.1.1.

<DT><code>collation_server</code>
<DD>
The server default collation.
This variable was added in MySQL 4.1.1.

<DT><code>concurrent_insert</code>
<DD>
If <code>ON</code> (the default), MySQL allows <code>INSERT</code> and <code>SELECT</code>
statements to run concurrently for <code>MyISAM</code> tables that have no free
blocks in the middle.  You can turn this option off by starting
<code>mysqld</code> with <code>--safe</code> or <code>--skip-new</code>.
This variable was added in MySQL 3.23.7.

<DT><code>connect_timeout</code>
<DD>
<A NAME="IDX497"></A>
The number of seconds the <code>mysqld</code> server waits for a connect
packet before responding with <code>Bad handshake</code>.

<DT><code>convert_character_set</code>
<DD>
The current character set mapping that was set by <code>SET CHARACTER SET</code>.
This variable was removed in MySQL 4.1.

<DT><code>datadir</code>
<DD>
The MySQL data directory. This variable can be set with the
<code>--datadir</code> option.

<DT><code>default_week_format</code>
<DD>
The default mode value to use for the <code>WEEK()</code> function.
This variable is available as of MySQL 4.0.14.

<DT><code>delay_key_write</code>
<DD>
This option applies only to <code>MyISAM</code> tables. It can have one of the
following values to affect handling of the <code>DELAY_KEY_WRITE</code> table
option that can be used in <code>CREATE TABLE</code> statements.

<TABLE BORDER>

<TR><TD><strong>Option</strong> </TD><TD> <strong>Description</strong>

</TD></TR>
<TR><TD><code>OFF</code> </TD><TD> <code>DELAYED_KEY_WRITE</code> is ignored.

</TD></TR>
<TR><TD><code>ON</code> </TD><TD> MySQL honors the <code>DELAY_KEY_WRITE</code> option
for <code>CREATE TABLE</code>. This is the default value.

</TD></TR>
<TR><TD><code>ALL</code> </TD><TD> All new opened tables are treated as if they were
created with the <code>DELAY_KEY_WRITE</code> option enabled.

</TD></TR>
</TABLE>

If <code>DELAY_KEY_WRITE</code> is enabled, this means that the key buffer for
tables with this option are not flushed on every index update, but
only when a table is closed.  This will speed up writes on keys a lot,
but if you use this feature, you should add automatic checking of all
<code>MyISAM</code> tables by starting the server with the <code>--myisam-recover</code>
option (for example, <code>--myisam-recover=BACKUP,FORCE</code>).
See section <A HREF="manual_MySQL_Database_Administration.html#Server_options">5.2.1  <code>mysqld</code> Command-Line Options</A> and section <A HREF="manual_Storage_engines.html#MyISAM_start">14.1.1  <code>MyISAM</code> Startup Options</A>.

Note that <code>--external-locking</code> doesn't offer any protection against
index corruption for tables that use delayed key writes.

This variable was added in MySQL 3.23.8.

<DT><code>delayed_insert_limit</code>
<DD>
After inserting <code>delayed_insert_limit</code> delayed rows, the <code>INSERT
DELAYED</code> handler thread checks whether there are any <code>SELECT</code>
statements pending. If so, it allows them to execute before continuing to
insert delayed rows.

<DT><code>delayed_insert_timeout</code>
<DD>
How long an <code>INSERT DELAYED</code> handler thread should wait for
<code>INSERT</code> statements before terminating.

<DT><code>delayed_queue_size</code>
<DD>
This is a per-table limit on the number of
rows to queue when handling <code>INSERT DELAYED</code>
statements.  If the queue becomes full, any client that issues an
<code>INSERT DELAYED</code> statement will wait until there is room in the queue
again.

<DT><code>expire_logs_days</code>
<DD>
The number of days for automatic binary log removal.
The default is 0, which means ``no automatic removal''. Possible removals
happen at startup and at binary log rotation.
This variable was added in MySQL 4.1.0.

<DT><code>flush</code>
<DD>
This is <code>ON</code> if you have started <code>mysqld</code> with the <code>--flush</code>
option.
This variable was added in MySQL 3.22.9.

<DT><code>flush_time</code>
<DD>
If this is set to a non-zero value, all tables will be closed every
<code>flush_time</code> seconds to free up resources and sync unflushed data to
disk.  We recommend this option only on Windows 9x or Me, or on systems
with minimal resources available.
This variable was added in MySQL 3.22.18.

<DT><code>ft_boolean_syntax</code>
<DD>
The list of operators supported by boolean full-text searches performed using
<code>IN BOOLEAN MODE</code>.
This variable was added in MySQL 4.0.1.
See section <A HREF="manual_Functions.html#Fulltext_Boolean">12.6.1  Boolean Full-Text Searches</A>.

The default variable value is <code>'+ -&#62;&#60;()~*:""&#38;|'</code>. The rules for
changing the value are as follows:


<UL>
<LI>

Operator function is determined by position within the string.

<LI>

The replacement value must be 14 characters.

<LI>

Each character must be an ASCII non-alphanumeric character.

<LI>

Either the first or second character must be a space.

<LI>

No duplicates are allowed except the phrase quoting operators in positions
11 and 12. These two characters are not required to be the same, but they
are the only two that may be.

<LI>

Positions 10, 13, and 14 (which by default are set to <samp>`:'</samp>, <samp>`&#38;'</samp>, and
<samp>`|'</samp>) are reserved for future extensions.

</UL>

<DT><code>ft_max_word_len</code>
<DD>
The maximum length of the word to be included in a <code>FULLTEXT</code> index.
This variable was added in MySQL 4.0.0.

<strong>Note</strong>: <code>FULLTEXT</code> indexes must be rebuilt after changing
this variable.
Use <code>REPAIR TABLE <var>tbl_name</var> QUICK</code>.

<DT><code>ft_min_word_len</code>
<DD>
The minimum length of the word to be included in a <code>FULLTEXT</code> index.
This variable was added in MySQL 4.0.0.

<strong>Note</strong>: <code>FULLTEXT</code> indexes must be rebuilt after changing
this variable.
Use <code>REPAIR TABLE <var>tbl_name</var> QUICK</code>.

<DT><code>ft_query_expansion_limit</code>
<DD>
The number of top matches to use for full-text searches performed using
<code>WITH QUERY EXPANSION</code>.
This variable was added in MySQL 4.1.1.

<DT><code>ft_stopword_file</code>
<DD>
The file from which to read the list of stopwords for full-text searches.
All the words from the file are used; comments are <em>not</em> honored.
By default, a built-in list of stopwords is used (as defined in the
<tt>`myisam/ft_static.c'</tt> file).  Setting this variable to the empty string
(<code>''</code>) disables stopword filtering.  This variable was added in
MySQL 4.0.10.

<strong>Note</strong>: <code>FULLTEXT</code> indexes must be rebuilt after changing
this variable.
Use <code>REPAIR TABLE <var>tbl_name</var> QUICK</code>.

<DT><code>group_concat_max_len</code>
<DD>
The maximum allowed result length for the <code>GROUP_CONCAT()</code> function.
This variable was added in MySQL 4.1.0.

<DT><code>have_archive</code>
<DD>
<code>YES</code> if <code>mysqld</code> supports <code>ARCHIVE</code> tables, <code>NO</code>
if not.  This variable was added in MySQL 4.1.3.

<DT><code>have_bdb</code>
<DD>
<code>YES</code> if <code>mysqld</code> supports <code>BDB</code> tables. <code>DISABLED</code>
if <code>--skip-bdb</code> is used.
This variable was added in MySQL 3.23.30.

<DT><code>have_compress</code>
<DD>
Whether the <code>zlib</code> compression library is available to the server.
If not, the <code>COMPRESS()</code> and <code>UNCOMPRESS()</code> functions cannot be
used.
This variable was added in MySQL 4.1.1.

<DT><code>have_crypt</code>
<DD>
Whether the <code>crypt()</code> system call is available to the server.
If not, the <code>CRYPT()</code> function cannot be used.
This variable was added in MySQL 4.0.10.

<DT><code>have_csv</code>
<DD>
<code>YES</code> if <code>mysqld</code> supports <code>ARCHIVE</code> tables, <code>NO</code>
if not.  This variable was added in MySQL 4.1.4.

<DT><code>have_example_engine</code>
<DD>
<code>YES</code> if <code>mysqld</code> supports <code>EXAMPLE</code> tables, <code>NO</code>
if not.  This variable was added in MySQL 4.1.4.

<DT><code>have_geometry</code>
<DD>
Whether the server supports spatial data types.
This variable was added in MySQL 4.1.3.

<DT><code>have_innodb</code>
<DD>
<code>YES</code> if <code>mysqld</code> supports <code>InnoDB</code> tables. <code>DISABLED</code>
if <code>--skip-innodb</code> is used.
This variable was added in MySQL 3.23.37.

<DT><code>have_isam</code>
<DD>
<code>YES</code> if <code>mysqld</code> supports <code>ISAM</code> tables. <code>DISABLED</code>
if <code>--skip-isam</code> is used.
This variable was added in MySQL 3.23.30.

<DT><code>have_ndbcluster</code>
<DD>
<code>YES</code> if <code>mysqld</code> supports <code>NDB Cluster</code> tables.
<code>DISABLED</code> if <code>--skip-ndbcluster</code> is used.
This variable was added in MySQL 4.1.2.

<DT><code>have_openssl</code>
<DD>
<code>YES</code> if <code>mysqld</code> supports SSL (encryption) of the client/server
protocol.
This variable was added in MySQL 3.23.43.

<DT><code>have_query_cache</code>
<DD>
<code>YES</code> if <code>mysqld</code> supports the query cache.
This variable was added in MySQL 4.0.2.

<DT><code>have_raid</code>
<DD>
<code>YES</code> if <code>mysqld</code> supports the <code>RAID</code> option.
This variable was added in MySQL 3.23.30.

<DT><code>have_rtree_keys</code>
<DD>
Whether <code>RTREE</code> indexes are available. (These are used for spatial
indexed in <code>MyISAM</code> tables.)
This variable was added in MySQL 4.1.3.

<DT><code>have_symlink</code>
<DD>
Whether symbolic link support is enabled. This is required on Unix for
support of the <code>DATA DIRECTORY</code> and <code>INDEX DIRECTORY</code> table options.
This variable was added in MySQL 4.0.0.

<DT><code>init_connect</code>
<DD>
A string to be executed by the server for each client that connects.
The string consists of one or more SQL statements. To specify multiple
statements, separate them by semicolon characters.
For example, each client begins by default with autocommit mode enabled.
There is no global server variable to specify that autocommit should be
disabled by default, but <code>init_connect</code> can be used to achieve the
same effect:


<PRE>
SET GLOBAL init_connect='SET AUTOCOMMIT=0';
</PRE>

This variable can also be set on the command line or in an option file.
To set the variable as just shown using an option file, include these
lines:


<PRE>
[mysqld]
init_connect='SET AUTOCOMMIT=0'
</PRE>

Note that the content of <code>init_connect</code> is not executed for users having
the <code>SUPER</code> privilege; this is in case that content has been wrongly set
(contains a wrong query, for example with a syntax error),
thus making all connections fail. Not executing it for <code>SUPER</code> users
enables those to open a connection and fix <code>init_connect</code>.
This variable was added in MySQL 4.1.2.

<DT><code>init_file</code>
<DD>
The name of the file specified with the <code>--init-file</code> option when you
start the server.  This is a file containing SQL statements that you want
the server to execute when it starts.
Each statement must be on a single line and should not include comments.
This variable was added in MySQL 3.23.2.

<DT><code>init_slave</code>
<DD>
This variable is similar to <code>init_connect</code>, but is a string to be
executed by a slave server each time the SQL thread starts.  The format of
the string is the same as for the <code>init_connect</code> variable.
This variable was added in MySQL 4.1.2.

<DT><code>innodb_<var>xxx</var></code>
<DD>
The <code>InnoDB</code> system variables are listed at
section <A HREF="manual_InnoDB.html#InnoDB_start">15.5  <code>InnoDB</code> Startup Options</A>.

<DT><code>interactive_timeout</code>
<DD>
The number of seconds the server waits for activity on an interactive
connection before closing it.  An interactive client is defined as a
client that uses the <code>CLIENT_INTERACTIVE</code> option to
<code>mysql_real_connect()</code>.  See also <code>wait_timeout</code>.

<DT><code>join_buffer_size</code>
<DD>
The size of the buffer that is used for full joins (joins that do not use
indexes).  Normally the best way to get fast joins is to add indexes.
Increase the value of <code>join_buffer_size</code> to get a faster full join when
adding indexes is not possible.  One join buffer is allocated for each full
join between two tables. For a complex join between several tables for which
indexes are not used, multiple join buffers might be necessary.

<DT><code>key_buffer_size</code>
<DD>
<A NAME="IDX498"></A>
Index blocks for <code>MyISAM</code> and <code>ISAM</code> tables are buffered and are
shared by all threads.  <code>key_buffer_size</code> is the size of the buffer
used for index blocks.  The key buffer is also known as the key cache.

The maximum allowable setting for <code>key_buffer_size</code> is 4GB. The
effective maximum size might be less, depending on your available
physical RAM and per-process RAM limits imposed by your operating
system or hardware platform.

Increase the value to get better index handling (for all reads and multiple
writes) to as much as you can afford. Using a value that is 25% of total
memory on a machine that mainly runs MySQL is quite common.  However, if you
make the value too large (for example, more than 50% of your total memory)
your system might start to page and become extremely slow.  MySQL relies on
the operating system to perform filesystem caching for data reads, so you
must leave some room for the filesystem cache.

For even more speed when writing many rows at the same time, use
<code>LOCK TABLES</code>.  See section <A HREF="manual_SQL_Syntax.html#LOCK_TABLES">13.4.5  <code>LOCK TABLES</code> and <code>UNLOCK TABLES</code> Syntax</A>.

You can check the performance of the key buffer by issuing a <code>SHOW
STATUS</code> statement and examining the <code>Key_read_requests</code>,
<code>Key_reads</code>, <code>Key_write_requests</code>, and <code>Key_writes</code> status
variables.
See section <A HREF="manual_SQL_Syntax.html#SHOW">13.5.4  <code>SHOW</code> Syntax</A>.

The <code>Key_reads/Key_read_requests</code> ratio should normally be
less than 0.01.  The <code>Key_writes/Key_write_requests</code> ratio is usually
near 1 if you are using mostly updates and deletes, but might be much
smaller if you tend to do updates that affect many rows at the same time or
if you are using the <code>DELAY_KEY_WRITE</code> table option.

The fraction of the key buffer in use can be determined using
<code>key_buffer_size</code> in conjunction with the <code>Key_blocks_unused</code> status
variable and the buffer block size.  From MySQL 4.1.1 on, the buffer block
size is available from the <code>key_cache_block_size</code> server variable. The
fraction of the buffer in use is:


<PRE>
1 - ((Key_blocks_unused * key_cache_block_size) / key_buffer_size)
</PRE>

This value is an approximation because some space in the key buffer may be
allocated internally for administrative structures.

Before MySQL 4.1.1, key cache blocks are 1024 bytes, and before MySQL 4.1.2,
<code>Key_blocks_unused</code> is unavailable.  The <code>Key_blocks_used</code> variable
can be used as follows to determine the fraction of the key buffer in use:


<PRE>
(Key_blocks_used * 1024) / key_buffer_size
</PRE>

However, <code>Key_blocks_used</code> indicates the maximum number of blocks that
have ever been in use at once, so this formula does not necessary represent
the current fraction of the buffer that is in use.

See section <A HREF="manual_MySQL_Optimization.html#MyISAM_key_cache">7.4.6  The <code>MyISAM</code> Key Cache</A>.

<DT><code>key_cache_age_threshold</code>
<DD>
This value controls the demotion of buffers from the hot sub-chain of a key
cache to the warm sub-chain.
Lower values cause demotion to happen more quickly.
The minimum value is 100.
The default value is 300.
This variable was added in MySQL 4.1.1.
See section <A HREF="manual_MySQL_Optimization.html#MyISAM_key_cache">7.4.6  The <code>MyISAM</code> Key Cache</A>.

<DT><code>key_cache_block_size</code>
<DD>
The size in bytes of blocks in the key cache.
The default value is 1024.
This variable was added in MySQL 4.1.1.
See section <A HREF="manual_MySQL_Optimization.html#MyISAM_key_cache">7.4.6  The <code>MyISAM</code> Key Cache</A>.

<DT><code>key_cache_division_limit</code>
<DD>
The division point between the hot and warm sub-chains of the key cache
buffer chain. The value is the percentage of the buffer chain to use for
the warm sub-chain.  Allowable values range from 1 to 100.
The default value is 100.
This variable was added in MySQL 4.1.1.
See section <A HREF="manual_MySQL_Optimization.html#MyISAM_key_cache">7.4.6  The <code>MyISAM</code> Key Cache</A>.

<DT><code>language</code>
<DD>
The language used for error messages.

<DT><code>large_file_support</code>
<DD>
Whether <code>mysqld</code> was compiled with options for large file support.
This variable was added in MySQL 3.23.28.

<DT><code>license</code>
<DD>
The type of license the server has.
This variable was added in MySQL 4.0.19.

<DT><code>local_infile</code>
<DD>
Whether <code>LOCAL</code> is supported for <code>LOAD DATA INFILE</code> statements.
This variable was added in MySQL 4.0.3.

<DT><code>locked_in_memory</code>
<DD>
Whether <code>mysqld</code> was locked in memory with <code>--memlock</code>.
This variable was added in MySQL 3.23.25.

<DT><code>log</code>
<DD>
Whether logging of all queries to the general query log is enabled.
See section <A HREF="manual_MySQL_Database_Administration.html#Query_log">5.9.2  The General Query Log</A>.

<DT><code>log_bin</code>
<DD>
Whether the binary log is enabled.
This variable was added in MySQL 3.23.14.
See section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>.

<DT><code>log_error</code>
<DD>
The location of the error log.
This variable was added in MySQL 4.0.10.

<DT><code>log_slave_updates</code>
<DD>
Whether updates received by a slave server from a master server should be
logged to the slave's own binary log. Binary logging must be enabled on the
slave for this to have any effect.
This variable was added in MySQL 3.23.17.
See section <A HREF="manual_Replication.html#Replication_Options">6.8  Replication Startup Options</A>.

<DT><code>log_slow_queries</code>
<DD>
Whether slow queries should be logged.  ``Slow'' is determined by the value
of the <code>long_query_time</code> variable.
This variable was added in MySQL 4.0.2.
See section <A HREF="manual_MySQL_Database_Administration.html#Slow_query_log">5.9.5  The Slow Query Log</A>.

<DT><code>log_update</code>
<DD>
Whether the update log is enabled.  This variable was added in MySQL 3.22.18.
Note that the binary log is preferable to the update log, which
is unavailable as of MySQL 5.0.
See section <A HREF="manual_MySQL_Database_Administration.html#Update_log">5.9.3  The Update Log</A>.

<DT><code>log_warnings</code>
<DD>
Whether to produce additional warning messages.
This variable was added in MySQL 4.0.3.
It is enabled by default as of MySQL 4.0.19 and 4.1.2.
As of MySQL 4.0.21 and 4.1.3, aborted connections are not logged to the error
log unless the value is greater than 1.

<DT><code>long_query_time</code>
<DD>
If a query takes longer than this many seconds, the <code>Slow_queries</code>
status variable is incremented. If you are using the
<code>--log-slow-queries</code> option, the query is logged to the slow query log
file. This value is measured in real time, not CPU time, so a query that is
under the threshold on a lightly loaded system might be above the threshold
on a heavily loaded one.
See section <A HREF="manual_MySQL_Database_Administration.html#Slow_query_log">5.9.5  The Slow Query Log</A>.

<DT><code>low_priority_updates</code>
<DD>
If set to <code>1</code>, all <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>, and
<code>LOCK TABLE WRITE</code> statements wait until there is no pending
<code>SELECT</code> or <code>LOCK TABLE READ</code> on the affected table.
This variable previously was named <code>sql_low_priority_updates</code>.
It was added in MySQL 3.22.5.

<DT><code>lower_case_file_system</code>
<DD>
This variable indicates whether the filesystem where the data directory is
located has case insensitive filenames.  <code>ON</code> means filenames are case
insensitive, <code>OFF</code> means they are case sensitive.  This variable was
added in MySQL 4.0.19.

<DT><code>lower_case_table_names</code>
<DD>
If set to 1, table names are stored in lowercase on disk and table name
comparisons are not case sensitive.  This variable was added in MySQL 3.23.6.
If set to 2 (new in 4.0.18), table names are stored as given but compared
in lowercase.  From MySQL 4.0.2, this option also applies to database names.
From 4.1.1, it also applies to table aliases.
See section <A HREF="manual_Language_Structure.html#Name_case_sensitivity">9.2.2  Identifier Case Sensitivity</A>.

You should <em>not</em> set this variable to 0 if you are running
MySQL on a system that does not have case-sensitive filenames (such as
Windows or Mac OS X).  New in 4.0.18:  If this variable is not set at
startup and the
filesystem on which the data directory is located does not have
case-sensitive filenames, MySQL automatically sets
<code>lower_case_table_names</code> to 2.

<DT><code>max_allowed_packet</code>
<DD>
The maximum size of one packet or any generated/intermediate string.

The packet message buffer is initialized to <code>net_buffer_length</code>
bytes, but can grow up to <code>max_allowed_packet</code> bytes when needed.
This value by default is small, to catch big (possibly wrong) packets.

You must increase this value if you are using big <code>BLOB</code> columns or
long strings. It should be as big as the biggest <code>BLOB</code> you want to
use.  The protocol limit for <code>max_allowed_packet</code> is 16MB before
MySQL 4.0 and 1GB thereafter.

<DT><code>max_binlog_cache_size</code>
<DD>
If a multiple-statement transaction requires more than this amount of memory,
you will get the error <code>Multi-statement transaction required more than
'max_binlog_cache_size' bytes of storage</code>.
This variable was added in MySQL 3.23.29.

<DT><code>max_binlog_size</code>
<DD>
If a write to the binary log exceeds the given value, rotate the binary
logs.  You cannot set this variable to more than 1GB or to less than 4096
bytes.  (The minimum before MYSQL 4.0.14 is 1024 bytes.) The default value
is 1GB.  This variable was added in MySQL 3.23.33.

Note if you are using transactions: A transaction is written in one chunk to
the binary log, hence it is never split between several binary logs.
Therefore, if you have big transactions, you might see binary logs bigger than
<code>max_binlog_size</code>.

If <code>max_relay_log_size</code> is 0, the value of <code>max_binlog_size</code>
applies to relay logs as well. <code>max_relay_log_size</code> was added in
MySQL 4.0.14.

<DT><code>max_connect_errors</code>
<DD>
If there are more than this number of interrupted connections from a host,
that host is blocked from further connections.  You can unblock blocked hosts
with the <code>FLUSH HOSTS</code> statement.

<DT><code>max_connections</code>
<DD>
The number of simultaneous client connections allowed. Increasing this value
increases the number of file descriptors that <code>mysqld</code> requires.  See
section <A HREF="manual_MySQL_Optimization.html#Table_cache">7.4.8  How MySQL Opens and Closes Tables</A> for comments on file descriptor limits.
Also see section <A HREF="manual_Problems.html#Too_many_connections">A.2.6  <code>Too many connections</code></A>.

<DT><code>max_delayed_threads</code>
<DD>
Don't start more than this number of threads to handle <code>INSERT DELAYED</code>
statements.  If you try to insert data into a new table after all <code>INSERT
DELAYED</code> threads are in use, the row will be inserted as if the
<code>DELAYED</code> attribute wasn't specified. If you set this to 0, MySQL
never creates a thread to handle <code>DELAYED</code> rows; in effect, this
disables <code>DELAYED</code> entirely.
This variable was added in MySQL 3.23.0.

<DT><code>max_error_count</code>
<DD>
The maximum number of error, warning, and note messages to be stored for
display by <code>SHOW ERRORS</code> or <code>SHOW WARNINGS</code>.
This variable was added in MySQL 4.1.0.

<DT><code>max_heap_table_size</code>
<DD>
This variable sets the maximum size to which <code>MEMORY</code> (<code>HEAP</code>)
tables are allowed to grow.  The value of the variable is used to calculate
<code>MEMORY</code> table <code>MAX_ROWS</code> values.  Setting this variable has no
effect on any existing <code>MEMORY</code> table, unless the table is re-created
with a statement such as <code>CREATE TABLE</code> or <code>TRUNCATE TABLE</code>, or
altered with <code>ALTER TABLE</code>.
This variable was added in MySQL 3.23.0.

<DT><code>max_insert_delayed_threads</code>
<DD>
This variable is a synonym for <code>max_delayed_threads</code>.
It was added in MySQL 4.0.19.

<DT><code>max_join_size</code>
<DD>
Don't allow <code>SELECT</code> statements that probably will need to examine
more than <code>max_join_size</code> row combinations or are likely to do more
than <code>max_join_size</code> disk seeks.  By setting this value, you can catch
<code>SELECT</code> statements where keys are not used properly and that would
probably take a long time.  Set it if your users tend to perform joins
that lack a <code>WHERE</code> clause, that take a long time, or that return
millions of rows.

Setting this variable to a value other than <code>DEFAULT</code> resets
the <code>SQL_BIG_SELECTS</code> value to <code>0</code>.  If you set the
<code>SQL_BIG_SELECTS</code> value again, the <code>max_join_size</code> variable
is ignored.

If a query result already is in the query cache, no result size
check is performed, because the result has already been computed and it does
not burden the server to send it to the client.

This variable previously was named <code>sql_max_join_size</code>.

<DT><code>max_length_for_sort_data</code>
<DD>
The cutoff on the size of index values that determines which <code>filesort</code>
algorithm to use.
See section <A HREF="manual_MySQL_Optimization.html#ORDER_BY_optimization">7.2.10  How MySQL Optimizes <code>ORDER BY</code></A>.
This variable was added in MySQL 4.1.1

<DT><code>max_relay_log_size</code>
<DD>
If a write by a replication slave to its relay log exceeds the given value,
rotate the relay log.  This variable enables you to put different size
constraints on relay logs and binary logs.  However, setting the variable to
0 makes MySQL use <code>max_binlog_size</code> for both binary logs and relay
logs.  You must set <code>max_relay_log_size</code> to between 4096 bytes and 1GB
(inclusive), or to 0. The default value is 0.  This variable was added in
MySQL 4.0.14.
See section <A HREF="manual_Replication.html#Replication_Implementation_Details">6.3  Replication Implementation Details</A>.

<DT><code>max_seeks_for_key</code>
<DD>
Limit the assumed maximum number of seeks when looking up rows based on
a key.  The MySQL optimizer will assume that no more than this number of
key seeks will be required when searching for matching rows in a table
by scanning a key, regardless of the actual cardinality of the key
(see section <A HREF="manual_SQL_Syntax.html#SHOW_INDEX">13.5.4.11  <code>SHOW INDEX</code> Syntax</A>). By setting this to a low value (100?), you can force
MySQL to prefer keys instead of table scans.

This variable was added in MySQL 4.0.14.

<DT><code>max_sort_length</code>
<DD>
The number of bytes to use when sorting <code>BLOB</code> or <code>TEXT</code>
values. Only the first <code>max_sort_length</code> bytes of each value
are used; the rest are ignored.

<DT><code>max_tmp_tables</code>
<DD>
The maximum number of temporary tables a client can keep open at the same time.
(This option doesn't yet do anything.)

<DT><code>max_user_connections</code>
<DD>
The maximum number of simultaneous connections allowed to any given MySQL
account.  A value of 0 means ``no limit.''
This variable was added in MySQL 3.23.34.

<DT><code>max_write_lock_count</code>
<DD>
After this many write locks, allow some read locks to run in between.
This variable was added in MySQL 3.23.7.

<DT><code>myisam_data_pointer_size</code>
<DD>
The default pointer size in bytes, to be used by <code>CREATE TABLE</code> for
<code>MyISAM</code> tables when no <code>MAX_ROWS</code> option is specified.  This
variable cannot be less than 2 or larger than 8.  The default value is 4.
This variable was added in MySQL 4.1.2.
See section <A HREF="manual_Problems.html#Full_table">A.2.11  <code>The table is full</code></A>.

<DT><code>myisam_max_extra_sort_file_size</code>
<DD>
If the temporary file used for fast <code>MyISAM</code> index creation would be
larger than using the key cache by the amount specified here, prefer the key
cache method.  This is mainly used to force long character keys in large
tables to use the slower key cache method to create the index.
This variable was added in MySQL 3.23.37.
<strong>Note</strong>: The value is given in megabytes before 4.0.3 and
in bytes thereafter.

<DT><code>myisam_max_sort_file_size</code>
<DD>
The maximum size of the temporary file MySQL is allowed to use while
re-creating a <code>MyISAM</code> index (during <code>REPAIR TABLE</code>, <code>ALTER
TABLE</code>, or <code>LOAD DATA INFILE</code>).  If the file size would be bigger than
this value, the index will be created using the key cache instead, which is
slower.
This variable was added in MySQL 3.23.37.
<strong>Note</strong>: The value is given in megabytes before 4.0.3 and
in bytes thereafter.

<DT><code>myisam_recover_options</code>
<DD>
The value of the <code>--myisam-recover</code> option.
This variable was added in MySQL 3.23.36.

<DT><code>myisam_repair_threads</code>
<DD>
If this value is greater than 1, <code>MyISAM</code> table indexes are created in
parallel (each index in its own thread) during the <code>Repair by sorting</code>
process.  The default value is 1.  <strong>Note</strong>: Multi-threaded repair is
still <em>alpha</em> quality code.
This variable was added in MySQL 4.0.13.

<DT><code>myisam_sort_buffer_size</code>
<DD>
The buffer that is allocated when sorting <code>MyISAM</code> indexes during a
<code>REPAIR TABLE</code> or when creating indexes with <code>CREATE INDEX</code> or
<code>ALTER TABLE</code>.
This variable was added in MySQL 3.23.16.

<DT><code>named_pipe</code>
<DD>
On Windows, indicates whether the server supports connections over named
pipes.
This variable was added in MySQL 3.23.50.

<DT><code>net_buffer_length</code>
<DD>
The communication buffer is reset to this size between queries. This should
not normally be changed, but if you have very little memory, you can set it
to the expected length of SQL statements sent by clients.  If statements
exceed this length, the buffer is automatically enlarged, up to
<code>max_allowed_packet</code> bytes.

<DT><code>net_read_timeout</code>
<DD>
The number of seconds to wait for more data from a connection before
aborting the read.
When the server is reading from the client, <code>net_read_timeout</code> is the
timeout value controlling when to abort.
When the server is writing to the client, <code>net_write_timeout</code> is the
timeout value controlling when to abort.
See also <code>slave_net_timeout</code>.
This variable was added in MySQL 3.23.20.

<DT><code>net_retry_count</code>
<DD>
If a read on a communication port is interrupted, retry this many times
before giving up.  This value should be set quite high on FreeBSD because
internal interrupts are sent to all threads.
This variable was added in MySQL 3.23.7.

<DT><code>net_write_timeout</code>
<DD>
The number of seconds to wait for a block to be written to a connection before
aborting the write.
See also <code>net_read_timeout</code>.
This variable was added in MySQL 3.23.20.

<DT><code>new</code>
<DD>
This variable is used in MySQL 4.0 to turn on some 4.1 behaviors.
This variable was added in MySQL 4.0.12.

<DT><code>old_passwords</code>
<DD>
Whether the server should use pre-4.1-style passwords for MySQL user
accounts.
This variable was added in MySQL 4.1.1.

<DT><code>open_files_limit</code>
<DD>
The number of files that the operating system allows <code>mysqld</code> to open.
This is the real value allowed by the system and might be different from the
value you gave <code>mysqld</code> as a startup option.  The value is 0 on systems
where MySQL can't change the number of open files.  This variable was added
in MySQL 3.23.20.

<DT><code>optimizer_prune_level</code>
<DD>
Controls the heuristics applied during query optimization to prune
less-promising partial plans from the optimizer search space. A value of 0
disables heuristics so that the optimizer performs an exhaustive search. A
value of 1 causes the optimizer to prune plans based on the number of rows
retrieved by intermediate plans.  This variable was added in MySQL 5.0.1.

<DT><code>optimizer_search_depth</code>
<DD>
The maximum depth of search performed by the query optimizer. Values larger
than the number of relations in a query result in better query plans, but
take longer to generate an execution plan for a query. Values smaller than
the number of relations in a query return an execution plan quicker, but
the resulting plan may be far from being optimal. If set to 0, the system
automatically picks a reasonable value. If set to the maximum number of
tables used in a query plus 2, the optimizer switches to the original
algorithm used before MySQL 5.0.1 that performs an exhaustive search.
This variable was added in MySQL 5.0.1.

<DT><code>pid_file</code>
<DD>
The pathname of the process ID (PID) file. This variable can be set
with the <code>--pid-file</code> option.
This variable was added in MySQL 3.23.23.

<DT><code>port</code>
<DD>
The port on which the server listens for TCP/IP connections.  This variable
can be set with the <code>--port</code> option.

<DT><code>preload_buffer_size</code>
<DD>
The size of the buffer that is allocated when preloading indexes.
This variable was added in MySQL 4.1.1.

<DT><code>protocol_version</code>
<DD>
The version of the client/server protocol used by the MySQL server.
This variable was added in MySQL 3.23.18.

<DT><code>query_alloc_block_size</code>
<DD>
The allocation size of memory blocks that are allocated for objects created
during query parsing and execution. If you have problems with memory
fragmentation, it might help to increase this a bit.  This variable was added
in MySQL 4.0.16.

<DT><code>query_cache_limit</code>
<DD>
Don't cache results that are bigger than this. The default value is 1MB.
This variable was added in MySQL 4.0.1.

<DT><code>query_cache_min_res_unit</code>
<DD>
The minimum size for blocks allocated by the query cache.
The default value is 4KB. Tuning information for this variable
is given in section <A HREF="manual_MySQL_Database_Administration.html#Query_Cache_Configuration">5.11.3  Query Cache Configuration</A>.
This variable is present from MySQL 4.1.

<DT><code>query_cache_size</code>
<DD>
The amount of memory allocated for caching query results.  The default value
is 0, which disables the query cache.  Note that this amount of memory will
be allocated even if <code>query_cache_type</code> is set to 0.
This variable was added in MySQL 4.0.1.

<DT><code>query_cache_type</code>
<DD>
Set query cache type. Setting the <code>GLOBAL</code> value sets the type for all
clients that connect thereafter. Individual clients can set the
<code>SESSION</code> value to affect their own use of the query cache.

<TABLE BORDER>

<TR><TD><strong>Option</strong> </TD><TD> <strong>Description</strong>

</TD></TR>
<TR><TD><code>0</code> or <code>OFF</code> </TD><TD> Don't cache or retrieve results.
Note that this will not deallocate the query cache buffer. To
do that, you should set <code>query_cache_size</code> to 0.

</TD></TR>
<TR><TD><code>1</code> or <code>ON</code> </TD><TD> Cache all query results except for those that
begin with <code>SELECT SQL_NO_CACHE</code>.

</TD></TR>
<TR><TD><code>2</code> or <code>DEMAND</code> </TD><TD> Cache results only for queries that
begin with <code>SELECT SQL_CACHE</code>.

</TD></TR>
</TABLE>

This variable was added in MySQL 4.0.3.

<DT><code>query_cache_wlock_invalidate</code>
<DD>
Normally, when one client acquires a <code>WRITE</code> lock on a <code>MyISAM</code>
table, other clients are not blocked from issuing queries for the table if
the query results are present in the query cache. Setting this variable to
1 causes acquisition of a <code>WRITE</code> lock for a table to invalidate
any queries in the query cache that refer to the table. This forces other
clients that attempt to access the table to wait while the lock is in effect.
This variable was added in MySQL 4.0.19.

<DT><code>query_prealloc_size</code>
<DD>
The size of the persistent buffer used for query parsing and execution.
This buffer is not freed between queries.
If you are running complex queries, a larger <code>query_prealloc_size</code> value
might be helpful in improving performance, because it can reduce the need for
the server to perform memory allocation during query execution operations.
This variable was added in MySQL 4.0.16.

<DT><code>range_alloc_block_size</code>
<DD>
The size of blocks that are allocated when doing range optimization.
This variable was added in MySQL 4.0.16.

<DT><code>read_buffer_size</code>
<DD>
Each thread that does a sequential scan allocates a buffer of this
size for each table it scans. If you do many sequential scans, you might
want to increase this value.
This variable was added in MySQL 4.0.3.
Previously, it was named <code>record_buffer</code>.

<DT><code>read_only</code>
<DD>
When the variable is set to <code>ON</code> for a replication slave server, it
causes the slave to allow no updates except from slave threads or from users
with the <code>SUPER</code> privilege.  This can be useful to ensure that a slave
server accepts no updates from clients.
This variable was added in MySQL 4.0.14.

<DT><code>relay_log_purge</code>
<DD>
Disables or enables automatic purging of relay logs as soon as they are not
needed any more.  The default value is 1 (enabled).
This variable was added in MySQL 4.1.1.

<DT><code>read_rnd_buffer_size</code>
<DD>
When reading rows in sorted order after a sort, the rows are read through
this buffer to avoid disk seeks.  Setting the variable to a large value can
improve <code>ORDER BY</code> performance by a lot.  However, this is a buffer
allocated for each client, so you should not set the global variable to a
large value. Instead, change the session variable only from within those
clients that need to run large queries.
This variable was added in MySQL 4.0.3.
Previously, it was named <code>record_rnd_buffer</code>.

<DT><code>safe_show_database</code>
<DD>
Don't show databases for which the user has no database or
table privileges. This can improve security if you're concerned about
people being able to see what databases other users have. See also
<code>skip_show_database</code>.

This variable was removed in MySQL 4.0.5. Instead, use the <code>SHOW
DATABASES</code> privilege to control access by MySQL accounts to database names.

<DT><code>secure_auth</code>
<DD>
If the MySQL server has been started with the <code>--secure-auth</code> option,
it blocks connections from all accounts that have passwords stored in the old 
(pre-4.1) format. In that case, the value of this variable is <code>ON</code>, 
otherwise it is <code>OFF</code>.

You should enable this option if you want to prevent all usage of passwords
in old format (and hence insecure communication over the network).
This variable was added in MySQL 4.1.1.

Server startup will fail with an error if this option is enabled
and the privilege tables are in pre-4.1 format.

When used as a client-side option, the client refuses to connect to a server
if the server requires a password in old format for the client account.

<DT><code>server_id</code>
<DD>
The value of the <code>--server-id</code> option. It is used for master and slave
replication servers.
This variable was added in MySQL 3.23.26.

<DT><code>shared_memory</code>
<DD>
Whether or not the server allows shared-memory connections.
Currently, only Windows servers support this.
This variable was added in MySQL 4.1.1.

<DT><code>shared_memory_base_name</code>
<DD>
Indicates whether or not the server allows shared-memory connections, and sets
the identifier for the shared memory. This is useful when running multiple MYSQL instances
on a single physical machine.
Currently, only Windows servers support this.
This variable was added in MySQL 4.1.0.

<DT><code>skip_external_locking</code>
<DD>
This is <code>OFF</code> if <code>mysqld</code> uses external locking.
This variable was added in MySQL 4.0.3.
Previously, it was named <code>skip_locking</code>.

<DT><code>skip_networking</code>
<DD>
This is <code>ON</code> if the server allows only local (non-TCP/IP) connections.
On Unix, local connections use a Unix socket file.  On Windows, local
connections use a named pipe or shared memory.  On NetWare, only TCP/IP connections are
supported, so do not set this variable to <code>ON</code>.
This variable was added in MySQL 3.22.23.

<DT><code>skip_show_database</code>
<DD>
This prevents people from using the <code>SHOW DATABASES</code> statement if they
don't have the <code>SHOW DATABASES</code> privilege. This can improve security if
you're concerned about people being able to see what databases other users
have. See also <code>safe_show_database</code>.
This variable was added in MySQL 3.23.4.  As of MySQL 4.0.2, its effect also
depends on the <code>SHOW DATABASES</code> privilege: If the variable value is
<code>ON</code>, the <code>SHOW DATABASES</code> statement is allowed only to users who
have the <code>SHOW DATABASES</code> privilege, and the statement displays all
database names.  If the value is <code>OFF</code>, <code>SHOW DATABASES</code> is
allowed to all users, but displays each database name only if the user has
the <code>SHOW DATABASES</code> privilege or some privilege for the database.

<DT><code>slave_compressed_protocol</code>
<DD>
Whether to use compression of the slave/master protocol if both the
slave and the master support it.
This variable was added in MySQL 4.0.3.

<DT><code>slave_net_timeout</code>
<DD>
The number of seconds to wait for more data from a master/slave connection
before aborting the read.
This variable was added in MySQL 3.23.40.

<DT><code>slow_launch_time</code>
<DD>
If creating a thread takes longer than this many seconds, the server
increments the <code>Slow_launch_threads</code> status variable.
This variable was added in MySQL 3.23.15.

<DT><code>socket</code>
<DD>
On Unix, this is the Unix socket file used for local client connections.  On
Windows, this is the name of the named pipe used for local client
connections.

<DT><code>sort_buffer_size</code>
<DD>
Each thread that needs to do a sort allocates a buffer of this
size. Increase this value for faster <code>ORDER BY</code> or <code>GROUP BY</code>
operations.
See section <A HREF="manual_Problems.html#Temporary_files">A.4.4  Where MySQL Stores Temporary Files</A>.

<DT><code>sql_mode</code>
<DD>
The current server SQL mode.
This variable was added in MySQL 3.23.41.
It can be set dynamically as of MySQL 4.1.1.
See section <A HREF="manual_MySQL_Database_Administration.html#Server_SQL_mode">5.2.2  The Server SQL Mode</A>.

<DT><code>sql_slave_skip_counter</code>
<DD>
The number of events from the master that a slave server should skip.
It was added in MySQL 3.23.33.

<DT><code>storage_engine</code>
<DD>
This variable is a synonym for <code>table_type</code>.
It was added in MySQL 4.1.2.

<DT><code>sync_binlog</code>
<DD>
If positive, the MySQL server will synchronize its binary log to disk
(<code>fdatasync()</code>) after every <code>sync_binlog</code>'th write to this binary
log. Note that there is one write to the binary log per statement if in
autocommit mode, and otherwise one write per transaction. The default value is
0 which does no sync'ing to disk. A value of 1 is the safest choice, because in
case of crash you will lose at most one statement/transaction from the binary
log; but it is also the slowest choice (unless the disk has a battery-backed
cache, which makes sync'ing very fast). This variable was added in MySQL 4.1.3.

<DT><code>sync_frm</code>
<DD>
This was added as a command-line option in MySQL 4.0.18, and is also a settable
global variable since MySQL 4.1.3. If set to 1, when a non-temporary table is
created it will synchronize its <tt>`.frm'</tt> file to disk (<code>fdatasync()</code>);
this is slower but safer in case of crash. Default is 1.

<DT><code>system_time_zone</code>
<DD>
The server system time zone. When the server begins executing, it inherits
a time zone setting from the machine defaults, possibly modified by the
environment of the account used for running the server or the startup script.
The value is used to set <code>system_time_zone</code>.  Typically the time zone
is specified by the <code>TZ</code> environment variable. It also can be specified
using the <code>--timezone</code> option of the <code>mysqld_safe</code> script.
This variable was added in MySQL 4.1.3.

<DT><code>table_cache</code>
<DD>
The number of open tables for all threads. Increasing this value
increases the number of file descriptors that <code>mysqld</code> requires.
You can check whether you need to increase the table cache by checking the
<code>Opened_tables</code> status variable.
See section <A HREF="manual_MySQL_Database_Administration.html#Server_status_variables">5.2.4  Server Status Variables</A>.
If the value of <code>Opened_tables</code> is large and you don't do <code>FLUSH
TABLES</code> a lot (which just forces all tables to be closed and reopened),
then you should increase the value of the <code>table_cache</code> variable.

For more information about the table cache, see section <A HREF="manual_MySQL_Optimization.html#Table_cache">7.4.8  How MySQL Opens and Closes Tables</A>.

<DT><code>table_type</code>
<DD>
The default table type (storage engine).
To set the table type at server startup, use the <code>--default-table-type</code>
option.
This variable was added in MySQL 3.23.0.
See section <A HREF="manual_MySQL_Database_Administration.html#Server_options">5.2.1  <code>mysqld</code> Command-Line Options</A>.

<DT><code>thread_cache_size</code>
<DD>
How many threads the server should cache for reuse.  When a client
disconnects, the client's threads are put in the cache if there aren't
already <code>thread_cache_size</code> threads there.  Requests for threads are
satisfied by reusing threads taken from the cache if possible, and only when
the cache is empty is a new thread created.  This variable can be increased
to improve performance if you have a lot of new connections. (Normally this
doesn't give a notable performance improvement if you have a good thread
implementation.)  By examining the difference between the <code>Connections</code>
and <code>Threads_created</code> status variables (see section <A HREF="manual_MySQL_Database_Administration.html#Server_status_variables">5.2.4  Server Status Variables</A>
for details) you can see how efficient the thread cache is.
This variable was added in MySQL 3.23.16.

<DT><code>thread_concurrency</code>
<DD>
On Solaris, <code>mysqld</code> calls <code>thr_setconcurrency()</code> with this value.
This function allows applications to give the threads system a hint about
the desired number of threads that should be run at the same time.
This variable was added in MySQL 3.23.7.

<DT><code>thread_stack</code>
<DD>
The stack size for each thread.  Many of the limits detected by the
<code>crash-me</code> test are dependent on this value. The default is
large enough for normal operation.  See section <A HREF="manual_MySQL_Optimization.html#MySQL_Benchmarks">7.1.4  The MySQL Benchmark Suite</A>.

<DT><code>time_zone</code>
<DD>
The current time zone. The initial value of this is <code>'SYSTEM'</code>
(use the value of <code>system_time_zone</code>), but can be specified
explicitly at server startup time with the <code>--default-time-zone</code>
option.
This variable was added in MySQL 4.1.3.

<DT><code>timezone</code>
<DD>
The time zone for the server.  This is set from the <code>TZ</code> environment
variable when <code>mysqld</code> is started.  The time zone also can be set by
giving a <code>--timezone</code> argument to <code>mysqld_safe</code>.
This variable was added in MySQL 3.23.15. As of MySQL 4.1.3, it is obsolete
and has been replaced by the <code>system_time_zone</code> variable.
See section <A HREF="manual_Problems.html#Timezone_problems">A.4.6  Time Zone Problems</A>.

<DT><code>tmp_table_size</code>
<DD>
If an in-memory temporary table exceeds this size, MySQL
automatically converts it to an on-disk <code>MyISAM</code> table.
Increase the value of <code>tmp_table_size</code> if you do many advanced
<code>GROUP BY</code> queries and you have lots of memory.

<DT><code>tmpdir</code>
<DD>
The directory used for temporary files and temporary tables.
Starting from MySQL 4.1, this variable can be set to a list of
several paths that are used in round-robin fashion. Paths
should be separated by colon characters (<samp>`:'</samp>) on Unix and semicolon
characters (<samp>`;'</samp>) on Windows, NetWare, and OS/2.

This feature can be used to
spread the load between several physical disks.
If the MySQL server is acting as a replication slave, you should not set
<code>tmpdir</code> to point to a directory on a memory-based filesystem or to a
directory that is cleared when the server host restarts.  A replication
slave needs some of its temporary files to survive a machine restart so that
it can replicate temporary tables or <code>LOAD DATA INFILE</code> operations. If
files in the temporary file directory are lost when the server restarts,
replication will fail.

This variable was added in MySQL 3.22.4.

<DT><code>transaction_alloc_block_size</code>
<DD>
The allocation size of memory blocks that are allocated for storing queries
that are part of a transaction to be stored in the binary log when doing a
commit.  This variable was added in MySQL 4.0.16.

<DT><code>transaction_prealloc_size</code>
<DD>
The size of the persistent buffer for <code>transaction_alloc_blocks</code> that
is not freed between queries. By making this big enough to fit all queries
in a common transaction, you can avoid a lot of <code>malloc()</code> calls.  This
variable was added in MySQL 4.0.16.

<DT><code>tx_isolation</code>
<DD>
The default transaction isolation level.
This variable was added in MySQL 4.0.3.

<DT><code>updatable_views_with_limit</code>
<DD>
This variable controls whether updates can be made using a view that
does not contain a primary key in the underlying table, if the update contains
a <code>LIMIT</code> clause. (Such updates often are generated by GUI tools.)
An update is an <code>UPDATE</code> or <code>DELETE</code> statement.  Primary key
here means a <code>PRIMARY KEY</code>, or a <code>UNIQUE</code> index in which no column
can contain <code>NULL</code>.

The variable can have two values:


<UL>
<LI>

<code>1</code> or <code>YES</code>: Issue a warning only (not an error message).
This is the default value.
<LI>

<code>0</code> or <code>NO</code>: Prohibit the update.
</UL>

This variable was added in MySQL 5.0.2.

<DT><code>version</code>
<DD>
The version number for the server.

<DT><code>version_bdb</code>
<DD>
The <code>BDB</code> storage engine version.
This variable was added in MySQL 3.23.31 with the name <code>bdb_version</code>
and renamed to <code>version_bdb</code> in MySQL 4.1.1.

<DT><code>version_comment</code>
<DD>
The <code>configure</code> script has a <code>--with-comment</code> option that
allows a comment to be specified when building MySQL.
This variable contains the value of that comment.
This variable was added in MySQL 4.0.17.

<DT><code>version_compile_machine</code>
<DD>
The type of machine MySQL was built on.
This variable was added in MySQL 4.1.1.

<DT><code>version_compile_os</code>
<DD>
The type of operating system MySQL was built on.
This variable was added in MySQL 4.0.19.

<DT><code>wait_timeout</code>
<DD>
The number of seconds the server waits for activity on a non-interactive
connection before closing it.

On thread startup, the session <code>wait_timeout</code> value is initialized from
the global <code>wait_timeout</code> value or from the global
<code>interactive_timeout</code> value, depending on the type of client (as
defined by the <code>CLIENT_INTERACTIVE</code> connect option to
<code>mysql_real_connect()</code>). See also <code>interactive_timeout</code>.

</DL>



<H4><A NAME="Dynamic_System_Variables" HREF="manual_toc.html#Dynamic_System_Variables">5.2.3.1  Dynamic System Variables</A></H4>

<P>
Beginning with MySQL 4.0.3, many server system variables are dynamic and can
be set at runtime using <code>SET GLOBAL</code> or <code>SET SESSION</code>. You can also
select their values using <code>SELECT</code>.
See section <A HREF="manual_Language_Structure.html#System_Variables">9.4  System Variables</A>.

</P>
<P>
The following table shows the full list of all dynamic system variables.
The last column indicates for each variable whether <code>GLOBAL</code> or
<code>SESSION</code> (or both) apply.

</P>

<TABLE BORDER>
<TR><TD><strong>Variable Name</strong> </TD><TD> <strong>Value Type</strong> </TD><TD> <strong>Type</strong>
</TD></TR>
<TR><TD><code>autocommit</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>big_tables</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>binlog_cache_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>bulk_insert_buffer_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>character_set_client</code> </TD><TD> string </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>character_set_connection</code> </TD><TD> string </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>character_set_results</code> </TD><TD> string </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>character_set_server</code> </TD><TD> string </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>collation_connection</code> </TD><TD> string </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>collation_server</code> </TD><TD> string </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>concurrent_insert</code> </TD><TD> boolean </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>connect_timeout</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>convert_character_set</code> </TD><TD> string </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>default_week_format</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>delay_key_write</code> </TD><TD> <code>OFF</code> | <code>ON</code> | <code>ALL</code> </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>delayed_insert_limit</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>delayed_insert_timeout</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>delayed_queue_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>error_count</code> </TD><TD> numeric </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>expire_logs_days</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>flush</code> </TD><TD> boolean </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>flush_time</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>foreign_key_checks</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>ft_boolean_syntax</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>group_concat_max_len</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>identity</code> </TD><TD> numeric </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>innodb_autoextend_increment</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>innodb_max_purge_lag</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>innodb_table_locks</code> </TD><TD> boolean </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>insert_id</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>interactive_timeout</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>join_buffer_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>key_buffer_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>last_insert_id</code> </TD><TD> numeric </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>local_infile</code> </TD><TD> boolean </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>log_warnings</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>long_query_time</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>low_priority_updates</code> </TD><TD> boolean </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>max_allowed_packet</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>max_binlog_cache_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>max_binlog_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>max_connect_errors</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>max_connections</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>max_delayed_threads</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>max_error_count</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>max_heap_table_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>max_insert_delayed_threads</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>max_join_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>max_relay_log_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>max_seeks_for_key</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>max_sort_length</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>max_tmp_tables</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>max_user_connections</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>max_write_lock_count</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>myisam_data_pointer_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>myisam_max_extra_sort_file_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>myisam_max_sort_file_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>myisam_repair_threads</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>myisam_sort_buffer_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>net_buffer_length</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>net_read_timeout</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>net_retry_count</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>net_write_timeout</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>old_passwords</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>optimizer_prune_level</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>optimizer_search_depth</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>preload_buffer_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>query_alloc_block_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>query_cache_limit</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>query_cache_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>query_cache_type</code> </TD><TD> enumeration </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>query_cache_wlock_invalidate</code> </TD><TD> boolean </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>query_prealloc_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>range_alloc_block_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>read_buffer_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>read_only</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>read_rnd_buffer_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>rpl_recovery_rank</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>safe_show_database</code> </TD><TD> boolean </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>secure_auth</code> </TD><TD> boolean </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>server_id</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>slave_compressed_protocol</code> </TD><TD> boolean </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>slave_net_timeout</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>slow_launch_time</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>sort_buffer_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_auto_is_null</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_big_selects</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_big_tables</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_buffer_result</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_log_bin</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_log_off</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_log_update</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_low_priority_updates</code> </TD><TD> boolean </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_max_join_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_mode</code> </TD><TD> enumeration </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_quote_show_create</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_safe_updates</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_select_limit</code> </TD><TD> numeric </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_slave_skip_counter</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>updatable_views_with_limit</code> </TD><TD> enumeration </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>sql_warnings</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>sync_binlog</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>sync_frm</code> </TD><TD> boolean </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>storage_engine</code> </TD><TD> enumeration </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>table_cache</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>table_type</code> </TD><TD> enumeration </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>thread_cache_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code>
</TD></TR>
<TR><TD><code>time_zone</code> </TD><TD> string </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>timestamp</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>tmp_table_size</code> </TD><TD> enumeration </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>transaction_alloc_block_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>transaction_prealloc_size</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>tx_isolation</code> </TD><TD> enumeration </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>unique_checks</code> </TD><TD> boolean </TD><TD> <code>SESSION</code>
</TD></TR>
<TR><TD><code>wait_timeout</code> </TD><TD> numeric </TD><TD> <code>GLOBAL</code> | <code>SESSION</code>
</TD></TR>
<TR><TD><code>warning_count</code> </TD><TD> numeric </TD><TD> <code>SESSION</code>
</TD></TR>
</TABLE>

<P>
Variables that are marked as ``string'' take a string value.  Variables that
are marked as ``numeric'' take a numeric value. Variables that are
marked as ``boolean'' can be set to 0, 1, <code>ON</code> or <code>OFF</code>. Variables
that are marked as ``enumeration'' normally should be set to one of the
available values for the variable, but can also be set to the number that
corresponds to the desired enumeration value.  For enumeration-valued system
variables, the first enumeration value corresponds to 0. This differs
from <code>ENUM</code> columns, for which the first enumeration value corresponds
to 1.

</P>



<H3><A NAME="Server_status_variables" HREF="manual_toc.html#Server_status_variables">5.2.4  Server Status Variables</A></H3>

<P>
<A NAME="IDX499"></A>
<A NAME="IDX500"></A>

</P>
<P>
The server maintains many status variables that provide information about its
operations. You can view these variables and their values by using the
<code>SHOW STATUS</code> statement:

</P>


<PRE>
mysql&#62; SHOW STATUS;
+--------------------------+------------+
| Variable_name            | Value      |
+--------------------------+------------+
| Aborted_clients          | 0          |
| Aborted_connects         | 0          |
| Bytes_received           | 155372598  |
| Bytes_sent               | 1176560426 |
| Connections              | 30023      |
| Created_tmp_disk_tables  | 0          |
| Created_tmp_files        | 60         |
| Created_tmp_tables       | 8340       |
| Delayed_errors           | 0          |
| Delayed_insert_threads   | 0          |
| Delayed_writes           | 0          |
| Flush_commands           | 1          |
| Handler_delete           | 462604     |
| Handler_read_first       | 105881     |
| Handler_read_key         | 27820558   |
| Handler_read_next        | 390681754  |
| Handler_read_prev        | 6022500    |
| Handler_read_rnd         | 30546748   |
| Handler_read_rnd_next    | 246216530  |
| Handler_update           | 16945404   |
| Handler_write            | 60356676   |
| Key_blocks_used          | 14955      |
| Key_read_requests        | 96854827   |
| Key_reads                | 162040     |
| Key_write_requests       | 7589728    |
| Key_writes               | 3813196    |
| Max_used_connections     | 0          |
| Not_flushed_delayed_rows | 0          |
| Not_flushed_key_blocks   | 0          |
| Open_files               | 2          |
| Open_streams             | 0          |
| Open_tables              | 1          |
| Opened_tables            | 44600      |
| Qcache_free_blocks       | 36         |
| Qcache_free_memory       | 138488     |
| Qcache_hits              | 79570      |
| Qcache_inserts           | 27087      |
| Qcache_lowmem_prunes     | 3114       |
| Qcache_not_cached        | 22989      |
| Qcache_queries_in_cache  | 415        |
| Qcache_total_blocks      | 912        |
| Questions                | 2026873    |
| Select_full_join         | 0          |
| Select_full_range_join   | 0          |
| Select_range             | 99646      |
| Select_range_check       | 0          |
| Select_scan              | 30802      |
| Slave_open_temp_tables   | 0          |
| Slave_running            | OFF        |
| Slow_launch_threads      | 0          |
| Slow_queries             | 0          |
| Sort_merge_passes        | 30         |
| Sort_range               | 500        |
| Sort_rows                | 30296250   |
| Sort_scan                | 4650       |
| Table_locks_immediate    | 1920382    |
| Table_locks_waited       | 0          |
| Threads_cached           | 0          |
| Threads_connected        | 1          |
| Threads_created          | 30022      |
| Threads_running          | 1          |
| Uptime                   | 80380      |
+--------------------------+------------+
</PRE>

<P>
Many status variables are reset to 0 by the <code>FLUSH STATUS</code> statement.

</P>
<P>
The status variables have the following meanings.  The <code>Com_<var>xxx</var></code>
statement counter variables were added beginning with MySQL 3.23.47. The
<code>Qcache_<var>xxx</var></code> query cache variables were added beginning with MySQL
4.0.1. Otherwise, variables with no version indicated have been present since
at least MySQL 3.22.

</P>
<DL COMPACT>

<DT><code>Aborted_clients</code>
<DD>
The number of connections that were aborted because the client died without
closing the connection properly.
See section <A HREF="manual_Problems.html#Communication_errors">A.2.10  Communication Errors and Aborted Connections</A>.

<DT><code>Aborted_connects</code>
<DD>
The number of tries to connect to the MySQL server that failed. See section <A HREF="manual_Problems.html#Communication_errors">A.2.10  Communication Errors and Aborted Connections</A>.

<DT><code>Binlog_cache_disk_use</code>
<DD>
The number of transactions that used the temporary binary log cache but that
exceeded the value of <code>binlog_cache_size</code> and used a temporary file to
store statements from the transaction.
This variable was added in MySQL 4.1.2.

<DT><code>Binlog_cache_use</code>
<DD>
The number of transactions that used the temporary binary log cache.
This variable was added in MySQL 4.1.2.

<DT><code>Bytes_received</code>
<DD>
The number of bytes received from all clients.
This variable was added in MySQL 3.23.7.

<DT><code>Bytes_sent</code>
<DD>
The number of bytes sent to all clients.
This variable was added in MySQL 3.23.7.

<DT><code>Com_<var>xxx</var></code>
<DD>
The number of times each <var>xxx</var> statement has been executed.
There is one status variable for each type of statement. For example,
<code>Com_delete</code> and <code>Com_insert</code> count <code>DELETE</code> and <code>INSERT</code>
statements.

<DT><code>Connections</code>
<DD>
The number of connection attempts (successful or not) to the MySQL server.

<DT><code>Created_tmp_disk_tables</code>
<DD>
The number of temporary tables on disk created automatically
by the server while executing statements.
This variable was added in MySQL 3.23.24.

<DT><code>Created_tmp_files</code>
<DD>
How many temporary files <code>mysqld</code> has created.
This variable was added in MySQL 3.23.28.

<DT><code>Created_tmp_tables</code>
<DD>
The number of in-memory temporary tables created automatically by the
server while executing statements.
If <code>Created_tmp_disk_tables</code> is big, you may want to increase the
<code>tmp_table_size</code> value to cause temporary tables to be memory-based
instead of disk-based.

<DT><code>Delayed_errors</code>
<DD>
The number of rows written with <code>INSERT DELAYED</code> for which some error
occurred (probably <code>duplicate key</code>).

<DT><code>Delayed_insert_threads</code>
<DD>
The number of <code>INSERT DELAYED</code> handler threads in use.

<DT><code>Delayed_writes</code>
<DD>
The number of <code>INSERT DELAYED</code> rows written.

<DT><code>Flush_commands</code>
<DD>
The number of executed <code>FLUSH</code> statements.

<DT><code>Handler_commit</code>
<DD>
The number of internal <code>COMMIT</code> statements.
This variable was added in MySQL 4.0.2.

<DT><code>Handler_discover</code>
<DD>
The MySQL server can ask the <code>NDB Cluster</code> storage engine if it knows about
a table with a given name. This is called discovery. <code>Handler_discover</code>
indicates the number of time tables have been discovered.
This variable was added in MySQL 4.1.2.

<DT><code>Handler_delete</code>
<DD>
The number of times a row was deleted from a table.

<DT><code>Handler_read_first</code>
<DD>
The number of times the first entry was read from an index.  If this is
high, it suggests that the server is doing a lot of full index scans; for
example, <code>SELECT col1 FROM foo</code>, assuming that <code>col1</code> is indexed.

<DT><code>Handler_read_key</code>
<DD>
The number of requests to read a row based on a key. If this is high, it is
a good indication that your queries and tables are properly indexed.

<DT><code>Handler_read_next</code>
<DD>
The number of requests to read the next row in key order. This will be
incremented if you are querying an index column with a range constraint or
if you are doing an index scan.

<DT><code>Handler_read_prev</code>
<DD>
The number of requests to read the previous row in key order.  This read
method is mainly used to optimize <code>ORDER BY ... DESC</code>.
This variable was added in MySQL 3.23.6.

<DT><code>Handler_read_rnd</code>
<DD>
The number of requests to read a row based on a fixed position.  This will
be high if you are doing a lot of queries that require sorting of the
result.
You probably have a lot of queries that require MySQL to scan whole tables
or you have joins that don't use keys properly.

<DT><code>Handler_read_rnd_next</code>
<DD>
The number of requests to read the next row in the data file.
This will be high if you are doing a lot of table scans. Generally this suggests that your tables
are not properly indexed or that your queries are not written to take advantage of the indexes you
have.

<DT><code>Handler_rollback</code>
<DD>
The number of internal <code>ROLLBACK</code> statements.
This variable was added in MySQL 4.0.2.

<DT><code>Handler_update</code>
<DD>
The number of requests to update a row in a table.

<DT><code>Handler_write</code>
<DD>
The number of requests to insert a row in a table.

<DT><code>Innodb_buffer_pool_pages_data</code>
<DD>
The number of pages containing data (dirty or clean).
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_pages_dirty</code>
<DD>
The number of pages currently dirty.
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_pages_flushed</code>
<DD>
The number of buffer pool pages that have been requested to be flushed.
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_pages_free</code>
<DD>
The number of free pages.
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_pages_latched</code>
<DD>
The number of latched pages in <code>InnoDB</code> buffer pool.  These are pages
currently being read or written or that can't be flushed or removed now
for some other reason.
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_pages_misc</code>
<DD>
The number of pages busy because they have been allocated for administrative
overhead such as row locks or the adaptive hash index.
This value can also be calculated as
<code>Innodb_buffer_pool_pages_total</code>
- <code>Innodb_buffer_pool_pages_free</code>
- <code>Innodb_buffer_pool_pages_data</code>.
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_pages_total</code>
<DD>
Total size of buffer pool, in pages.
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_read_ahead_rnd</code>
<DD>
The number of ``random'' read-aheads <code>InnoDB</code> initiated. This happens
when a query is to scan a large portion of a table but in random order.
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_read_ahead_seq</code>
<DD>
The number of sequential read-aheads <code>InnoDB</code> initiated. This happens when
<code>InnoDB</code> does a sequential full table scan.
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_read_requests</code>
<DD>
The number of logical read requests <code>InnoDB</code> has done.
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_reads</code>
<DD>
The number of logical reads that <code>InnoDB</code> could not satisfy from
buffer pool and had to do a single-page read.
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_wait_free</code>
<DD>
Normally, writes to the <code>InnoDB</code> buffer pool happen in the background.
However, if it's necessary to read or create a page and no clean pages are
available, it's necessary to wait for pages to be flushed first.
This counter counts instances of these waits.
If the buffer pool size was set properly, this value should be small.
Added in MySQL 5.0.2.

<DT><code>Innodb_buffer_pool_write_requests</code>
<DD>
The number writes done to the <code>InnoDB</code> buffer pool.
Added in MySQL 5.0.2.

<DT><code>Innodb_data_fsyncs</code>
<DD>
The number of <code>fsync()</code> operations so far.
Added in MySQL 5.0.2.

<DT><code>Innodb_data_pending_fsyncs</code>
<DD>
The current number of pending <code>fsync()</code> operations.
Added in MySQL 5.0.2.

<DT><code>Innodb_data_pending_reads</code>
<DD>
The current number of pending reads.
Added in MySQL 5.0.2.

<DT><code>Innodb_data_pending_writes</code>
<DD>
The current number of pending writes.
Added in MySQL 5.0.2.

<DT><code>Innodb_data_read</code>
<DD>
The amount of data read so far, in bytes.
Added in MySQL 5.0.2.

<DT><code>Innodb_data_reads</code>
<DD>
The total number of data reads.
Added in MySQL 5.0.2.

<DT><code>Innodb_data_writes</code>
<DD>
The total number of data writes.
Added in MySQL 5.0.2.

<DT><code>Innodb_data_written</code>
<DD>
The amount of data written so far, in bytes.
Added in MySQL 5.0.2.

<DT><code>Innodb_dblwr_writes</code>
<DD>
<DT><code>Innodb_dblwr_pages_written</code>
<DD>
The number of doublewrite writes that have been performed and the number
of pages that have been written for this purpose.
Added in MySQL 5.0.2.

<DT><code>Innodb_log_waits</code>
<DD>
The number of waits we had because log buffer was too small and we had to
wait for it to be flushed before continuing.
Added in MySQL 5.0.2.

<DT><code>Innodb_log_write_requests</code>
<DD>
The number of log write requests.
Added in MySQL 5.0.2.

<DT><code>Innodb_log_writes</code>
<DD>
The number of physical writes to the log file.
Added in MySQL 5.0.2.

<DT><code>Innodb_os_log_fsyncs</code>
<DD>
The number of fsyncs writes done to the log file.
Added in MySQL 5.0.2.

<DT><code>Innodb_os_log_pending_fsyncs</code>
<DD>
The number of pending log file fsyncs.
Added in MySQL 5.0.2.

<DT><code>Innodb_os_log_pending_writes</code>
<DD>
Pending log file writes.
Added in MySQL 5.0.2.

<DT><code>Innodb_os_log_written</code>
<DD>
The number of bytes written to the log file.
Added in MySQL 5.0.2.

<DT><code>Innodb_page_size</code>
<DD>
The compiled-in <code>InnoDB</code> page size (default 16KB). Many values are
counted in pages; the page size allows them to be easily converted to bytes.
Added in MySQL 5.0.2.

<DT><code>Innodb_pages_created</code>
<DD>
The number of pages created.
Added in MySQL 5.0.2.

<DT><code>Innodb_pages_read</code>
<DD>
The number of pages read.
Added in MySQL 5.0.2.

<DT><code>Innodb_pages_written</code>
<DD>
The number of pages written.
Added in MySQL 5.0.2.

<DT><code>Innodb_row_lock_current_waits</code>
<DD>
The number of row locks currently being waited for.
Added in MySQL 5.0.3.

<DT><code>Innodb_row_lock_time</code>
<DD>
The total time spent in acquiring row locks, in milliseconds.
Added in MySQL 5.0.3.

<DT><code>Innodb_row_lock_time_avg</code>
<DD>
The average time to acquire a row lock, in milliseconds.
Added in MySQL 5.0.3.

<DT><code>Innodb_row_lock_time_max</code>
<DD>
The maximum time to acquire a row lock, in milliseconds.
Added in MySQL 5.0.3.

<DT><code>Innodb_row_lock_waits</code>
<DD>
The number of times a row lock had to be waited for.
Added in MySQL 5.0.3.

<DT><code>Innodb_rows_deleted</code>
<DD>
The number of rows deleted from <code>InnoDB</code> tables.
Added in MySQL 5.0.2.

<DT><code>Innodb_rows_inserted</code>
<DD>
The number of rows inserted in <code>InnoDB</code> tables.
Added in MySQL 5.0.2.

<DT><code>Innodb_rows_read</code>
<DD>
The number of rows read from <code>InnoDB</code> tables.
Added in MySQL 5.0.2.

<DT><code>Innodb_rows_updated</code>
<DD>
The number of rows updated in <code>InnoDB</code> tables.
Added in MySQL 5.0.2.

<DT><code>Key_blocks_not_flushed</code>
<DD>
The number of key blocks in the key cache that have changed but haven't yet
been flushed to disk.
This variable was added in MySQL 4.1.1.
It used to be known as <code>Not_flushed_key_blocks</code>.

<DT><code>Key_blocks_unused</code>
<DD>
The number of unused blocks in the key cache.
You can use this value to determine how much of the key cache is in use;
see the discussion of <code>key_buffer_size</code> in
section <A HREF="manual_MySQL_Database_Administration.html#Server_system_variables">5.2.3  Server System Variables</A>.
This variable was added in MySQL 4.1.2.
section <A HREF="manual_MySQL_Database_Administration.html#Server_system_variables">5.2.3  Server System Variables</A>.

<DT><code>Key_blocks_used</code>
<DD>
The number of used blocks in the key cache. This value is a high-water mark
that indicates the maximum number of blocks that have ever been in use at one
time.

<DT><code>Key_read_requests</code>
<DD>
The number of requests to read a key block from the cache.

<DT><code>Key_reads</code>
<DD>
The number of physical reads of a key block from disk.
If <code>Key_reads</code> is big, then your <code>key_buffer_size</code> value is
probably too small.  The cache miss rate can be calculated as
<code>Key_reads</code>/<code>Key_read_requests</code>.

<DT><code>Key_write_requests</code>
<DD>
The number of requests to write a key block to the cache.

<DT><code>Key_writes</code>
<DD>
The number of physical writes of a key block to disk.

<DT><code>Last_query_cost</code>
<DD>
The total cost of the last compiled query as computed by the query
optimizer. Useful for comparing the cost of different query plans for the
same query. The default value of -1 means that no query has been
compiled yet. This variable was added in MySQL 5.0.1.

<DT><code>Max_used_connections</code>
<DD>
The maximum number of connections that have been in use simultaneously since
the server started.

<DT><code>Not_flushed_delayed_rows</code>
<DD>
The number of rows waiting to be written in <code>INSERT DELAY</code> queues.

<DT><code>Not_flushed_key_blocks</code>
<DD>
The old name for <code>Key_blocks_not_flushed</code> before MySQL 4.1.1.

<DT><code>Open_files</code>
<DD>
The number of files that are open.

<DT><code>Open_streams</code>
<DD>
The number of streams that are open (used mainly for logging).

<DT><code>Open_tables</code>
<DD>
The number of tables that are open.

<DT><code>Opened_tables</code>
<DD>
The number of tables that have been opened.
If <code>Opened_tables</code> is big, your <code>table_cache</code>
value is probably too small.

<DT><code>Qcache_free_blocks</code>
<DD>
The number of free memory blocks in query cache.

<DT><code>Qcache_free_memory</code>
<DD>
The amount of free memory for query cache.

<DT><code>Qcache_hits</code>
<DD>
The number of cache hits.

<DT><code>Qcache_inserts</code>
<DD>
The number of queries added to the cache.

<DT><code>Qcache_lowmem_prunes</code>
<DD>
The number of queries that were deleted from the cache because of low memory.

<DT><code>Qcache_not_cached</code>
<DD>
The number of non-cached queries
(not cachable, or due to <code>query_cache_type</code>).

<DT><code>Qcache_queries_in_cache</code>
<DD>
The number of queries registered in the cache.

<DT><code>Qcache_total_blocks</code>
<DD>
The total number of blocks in the query cache.

<DT><code>Questions</code>
<DD>
The number of queries that have been sent to the server.

<DT><code>Rpl_status</code>
<DD>
The status of failsafe replication (not yet implemented).

<DT><code>Select_full_join</code>
<DD>
The number of joins that do not use indexes.  If this value is not 0, you
should carefully check the indexes of your tables.
This variable was added in MySQL 3.23.25.

<DT><code>Select_full_range_join</code>
<DD>
The number of joins that used a range search on a reference table.
This variable was added in MySQL 3.23.25.

<DT><code>Select_range</code>
<DD>
The number of joins that used ranges on the first table. (It's normally
not critical even if this is big.)
This variable was added in MySQL 3.23.25.

<DT><code>Select_range_check</code>
<DD>
The number of joins without keys that check for key usage after each row.
(If this is not 0, you should carefully check the indexes of your tables.)
This variable was added in MySQL 3.23.25.

<DT><code>Select_scan</code>
<DD>
The number of joins that did a full scan of the first table.
This variable was added in MySQL 3.23.25.

<DT><code>Slave_open_temp_tables</code>
<DD>
The number of temporary tables currently open by the slave SQL thread.
This variable was added in MySQL 3.23.29.

<DT><code>Slave_running</code>
<DD>
This is <code>ON</code> if this server is a slave that is connected to a master.
This variable was added in MySQL 3.23.16.

<DT><code>Slow_launch_threads</code>
<DD>
The number of threads that have taken more than <code>slow_launch_time</code>
seconds to create.
This variable was added in MySQL 3.23.15.

<DT><code>Slow_queries</code>
<DD>
The number of queries that have taken more than <code>long_query_time</code> seconds. See section <A HREF="manual_MySQL_Database_Administration.html#Slow_query_log">5.9.5  The Slow Query Log</A>.

<DT><code>Sort_merge_passes</code>
<DD>
The number of merge passes the sort algorithm has had to do. If this value is
large, you should consider increasing the value of the <code>sort_buffer_size</code>
system variable.
This variable was added in MySQL 3.23.28.

<DT><code>Sort_range</code>
<DD>
The number of sorts that were done with ranges.
This variable was added in MySQL 3.23.25.

<DT><code>Sort_rows</code>
<DD>
The number of sorted rows.
This variable was added in MySQL 3.23.25.

<DT><code>Sort_scan</code>
<DD>
The number of sorts that were done by scanning the table.
This variable was added in MySQL 3.23.25.

<DT><code>Ssl_<var>xxx</var></code>
<DD>
Variables used for SSL connections.
These variables were added in MySQL 4.0.0.

<DT><code>Table_locks_immediate</code>
<DD>
The number of times that a table lock was acquired immediately. This
variable was added as of MySQL 3.23.33.

<DT><code>Table_locks_waited</code>
<DD>
The number of times that a table lock could not be acquired immediately and a
wait was needed. If this is high, and you have performance problems, you
should first optimize your queries, and then either split your table or
tables or use replication.  This variable was added as of MySQL 3.23.33.

<DT><code>Threads_cached</code>
<DD>
The number of threads in the thread cache.
This variable was added in MySQL 3.23.17.

<DT><code>Threads_connected</code>
<DD>
The number of currently open connections.

<DT><code>Threads_created</code>
<DD>
The number of threads created to handle connections.
If <code>Threads_created</code> is big, you may want to increase the
<code>thread_cache_size</code> value.  The cache hit rate can be calculated
as <code>Threads_created</code>/<code>Connections</code>.
This variable was added in MySQL 3.23.31.

<DT><code>Threads_running</code>
<DD>
The number of threads that are not sleeping.

<DT><code>Uptime</code>
<DD>
The number of seconds the server has been up.

</DL>



<H2><A NAME="Server_Shutdown" HREF="manual_toc.html#Server_Shutdown">5.3  The MySQL Server Shutdown Process</A></H2>

<P>
The server shutdown process can be summarized like this:

</P>

<OL>
<LI>

The shutdown process is initiated
<LI>

The server creates a shutdown thread if necessary
<LI>

The server stops accepting new connections
<LI>

The server terminates current activity
<LI>

Storage engines are shut down or closed
<LI>

The server exits
</OL>

<P>
A more detailed description of the process follows:

</P>

<OL>
<LI>

The shutdown process is initiated.

Server shutdown can be initiated several ways. For example, a user with
the <code>SHUTDOWN</code> privilege can execute a <code>mysqladmin shutdown</code>
command. <code>mysqladmin</code> can be used on any platform supported by
MySQL. Other operating sytem-specific shutdown initiation methods are possible
as well: The server shuts down on Unix when it receives a <code>SIGTERM</code>
signal. A server running as a service on Windows shuts down when the services
manager tells it to.

<LI>

The server creates a shutdown thread if necessary.

Depending on how shutdown was initiated, the server might create a thread to
handle the shutdown process.  If shutdown was requested by a client, a
shutdown thread is created.  If shutdown is the result of receiving a
<code>SIGTERM</code> signal, the signal thread might handle shutdown itself, or it
might create a separate thread to do so.  If the server tries to create a
shutdown thread and cannot (for example, if memory is exhausted), it issues a
diagnostic message that will appear in the error log:


<PRE>
Error: Can't create thread to kill server
</PRE>

<LI>

The server stops accepting new connections.

To prevent new activity from being initiated during shutdown, the server
stops accepting new client connections. It does this by closing the network
connections to which it normally listens for connections: the TCP/IP port,
the Unix socket file, the Windows named pipe, and shared memory on Windows.

<LI>

The server terminates current activity.

For each thread that is associated with a client connection, the connection
to the client is broken and the thread is marked as killed. Threads die when
they notice that they are so marked. Threads for idle connections die
quickly. Threads that currently are processing queries check their state
periodically and take longer to die.  For additional information about
thread termination, see section <A HREF="manual_SQL_Syntax.html#KILL">13.5.5.3  <code>KILL</code> Syntax</A>, in particular for the
instructions about killed <code>REPAIR TABLE</code> or <code>OPTIMIZE TABLE</code>
operations on <code>MyISAM</code> tables.

For threads that have an open transaction, the tranaction is rolled back.
Note that if a thread is updating a non-transactional table, an operation
such as a multiple-row <code>UPDATE</code> or <code>INSERT</code> may leave the table
partially updated, because the operation can terminate before completion.

If the server is a master replication server, threads associated with
currently connected slaves are treated like other client threads. That
is, each one is marked as killed and exits when it next checks its state.

If the server is a slave replication server, the I/O and SQL threads, if
active, are stopped before client threads are marked as killed. The SQL
thread is allowed to finish its current statement (to avoid causing
replication problems) then stops. If the SQL thread was in the middle
of a transaction at this point, the transaction is rolled back.

<LI>

Storage engines are shut down or closed.

At this stage, the table cache is flushed and all open tables are closed.

Each storage engine performs any actions necessary for tables that it manages.
For example, MyISAM flushes any pending index writes for a table.
InnoDB flushes its buffer pool to disk, writes the current LSN to the
tablespace, and terminates its own internal threads.

<LI>

The server exits.

</OL>



<H2><A NAME="Security" HREF="manual_toc.html#Security">5.4  General Security Issues</A></H2>

<P>
<A NAME="IDX501"></A>

</P>
<P>
This section describes some general security issues to be aware of and what
you can do to make your MySQL installation more secure against attack or
misuse. For information specifically about the access control system that
MySQL uses for setting up user accounts and checking database access, see
section <A HREF="manual_MySQL_Database_Administration.html#Privilege_system">5.5  The MySQL Access Privilege System</A>.

</P>



<H3><A NAME="Security_guidelines" HREF="manual_toc.html#Security_guidelines">5.4.1  General Security Guidelines</A></H3>

<P>
Anyone using MySQL on a computer connected to the Internet
should read this section to avoid the most common security mistakes.

</P>
<P>
In discussing security, we emphasize the necessity of fully protecting the
entire server host (not just the MySQL server) against all types
of applicable attacks: eavesdropping, altering, playback, and denial of
service. We do not cover all aspects of availability and fault tolerance
here.

</P>
<P>
MySQL uses security based on Access Control Lists (ACLs) for all
connections, queries, and other operations that users can attempt to
perform. There is also some support for SSL-encrypted connections
between MySQL clients and servers. Many of the concepts
discussed here are not specific to MySQL at all; the same
general ideas apply to almost all applications.

</P>
<P>
When running MySQL, follow these guidelines whenever possible:

</P>

<UL>
<LI>

<strong>Do not ever give anyone (except MySQL <code>root</code> accounts) access
to the <code>user</code> table in the <code>mysql</code> database!</strong>  This is critical.
<strong>The encrypted password is the real password in MySQL.</strong> Anyone who
knows the password that is listed in the <code>user</code> table and has access
to the host listed for the account <strong>can easily log in as that user</strong>.

<LI>

Learn the MySQL access privilege system. The <code>GRANT</code> and
<code>REVOKE</code> statements are used for controlling access to MySQL. Do
not grant any more privileges than necessary. Never grant privileges to all
hosts.

Checklist:

<UL>
<LI>

Try <code>mysql -u root</code>. If you are able to connect successfully to the
server without being asked for a password, you have problems. Anyone
can connect to your MySQL server as the MySQL
<code>root</code> user with full privileges!
Review the MySQL installation instructions, paying particular
attention to the information about setting a <code>root</code> password.
See section <A HREF="manual_Installing.html#Default_privileges">2.9.3  Securing the Initial MySQL Accounts</A>.
<LI>

Use the <code>SHOW GRANTS</code> statement and check to see who has access to
what.  Then use the <code>REVOKE</code> statement to remove those privileges that
are not necessary.
</UL>

<LI>

Do not store any plain-text passwords in your database. If your
computer becomes compromised, the intruder can take the full list of
passwords and use them. Instead, use <code>MD5()</code>, <code>SHA1()</code>, or
some other one-way hashing function.
<LI>

Do not choose passwords from dictionaries. There are special programs to
break them. Even passwords like ``xfish98'' are very bad.  Much better is
``duag98'' which contains the same word ``fish'' but typed one key to the
left on a standard QWERTY keyboard. Another method is to use ``Mhall'' which
is taken from the first characters of each word in the sentence ``Mary had
a little lamb.'' This is easy to remember and type, but difficult to guess
for someone who does not know it.
<LI>

Invest in a firewall. This protects you from at least 50% of all types of
exploits in any software. Put MySQL behind the firewall or in
a demilitarized zone (DMZ).

Checklist:

<UL>
<LI>

Try to scan your ports from the Internet using a tool such as
<code>nmap</code>. MySQL uses port 3306 by default. This port should
not be accessible from untrusted hosts. Another simple way to check whether
or not your MySQL port is open is to try the following command
from some remote machine, where <code>server_host</code> is the host on which
your MySQL server runs:


<PRE>
shell&#62; telnet server_host 3306
</PRE>

If you get a connection and some garbage characters, the port is
open, and should be closed on your firewall or router, unless you really
have a good reason to keep it open. If <code>telnet</code> just hangs or the
connection is refused, everything is OK; the port is blocked.
</UL>

<LI>

Do not trust any data entered by users of your applications. They can try to trick your
code by entering special or escaped character sequences in Web forms,
URLs, or whatever application you have built. Be sure that your
application remains secure if a user enters something like ``<code>; DROP
DATABASE mysql;</code>''. This is an extreme example, but large security leaks
and data loss might occur as a result of hackers using similar techniques,
if you do not prepare for them.

A common mistake is to protect only string data values.  Remember to check
numeric data as well.  If an application generates a query such as
<code>SELECT * FROM table WHERE ID=234</code> when a user enters the value
<code>234</code>, the user can enter the value <code>234 OR 1=1</code> to cause the
application to generate the query <code>SELECT * FROM table WHERE ID=234 OR
1=1</code>.  As a result, the server retrieves every record in the table.  This
exposes every record and causes excessive server load.  The simplest way to
protect from this type of attack is to use apostrophes around the numeric
constants: <code>SELECT * FROM table WHERE ID='234'</code>. If the user enters
extra information, it all becomes part of the string. In numeric context,
MySQL automatically converts this string to a number and strips any trailing
non-numeric characters from it.

Sometimes people think that if a database contains only publicly available
data, it need not be protected. This is incorrect.  Even if it is allowable
to display any record in the database, you should still protect against
denial of service attacks (for example, those that are based on the
technique in the preceding paragraph that causes the server to waste
resources). Otherwise, your server becomes unresponsive to legitimate users.

Checklist:

<UL>
<LI>

Try to enter <samp>`''</samp> and <samp>`"'</samp> in all your Web forms. If you get any kind
of MySQL error, investigate the problem right away.
<LI>

Try to modify any dynamic URLs by adding <code>%22</code> (<samp>`"'</samp>), <code>%23</code>
(<samp>`#'</samp>), and <code>%27</code> (<samp>`''</samp>) in the URL.
<LI>

Try to modify data types in dynamic URLs from numeric ones to character
ones containing characters from previous examples. Your application
should be safe against this and similar attacks.
<LI>

Try to enter characters, spaces, and special symbols rather than numbers in
numeric fields. Your application should remove them before passing them to
MySQL or else generate an error. Passing
unchecked values to MySQL is very dangerous!
<LI>

Check data sizes before passing them to MySQL.
<LI>

Consider having your application connect to the database using a
different username than the one you use for administrative purposes. Do
not give your applications any access privileges they do not need.
</UL>

<LI>

Many application programming interfaces provide a means of escaping special
characters in data values. Properly used, this prevents application users from
entering values that cause the application to generate statements that have a
different effect than you intend:

<UL>
<LI>

MySQL C API:
Use the <code>mysql_real_escape_string()</code> API call.
<LI>

MySQL++:
Use the <code>escape</code> and <code>quote</code> modifiers for query streams.
<LI>

PHP:
Use the <code>mysql_escape_string()</code> function, which
is based on the function of the same name in the MySQL C API.
Prior to PHP 4.0.3, use  <code>addslashes()</code> instead.
<LI>

Perl DBI:
Use the <code>quote()</code> method or use placeholders.
<LI>

Java JDBC:
Use a <code>PreparedStatement</code> object and placeholders.
</UL>

Other programming interfaces might have similar capabilities.

<LI>

Do not transmit plain (unencrypted) data over the Internet. This information is
accessible to everyone who has the time and ability to intercept it and use
it for their own purposes. Instead, use an encrypted protocol such as SSL or
SSH. MySQL supports internal SSL connections as of Version 4.0.0.
SSH port-forwarding can be used to create an encrypted (and compressed)
tunnel for the communication.
<LI>

Learn to use the <code>tcpdump</code> and <code>strings</code> utilities. For most cases,
you can check whether MySQL data streams are unencrypted
by issuing a command like the following:


<PRE>
shell&#62; tcpdump -l -i eth0 -w - src or dst port 3306 | strings
</PRE>

(This works under Linux and should work with small modifications under other
systems.)  Warning: If you do not see plaintext data, this doesn't always
mean that the information actually is encrypted. If you need high security,
you should consult with a security expert.
</UL>



<H3><A NAME="Security_against_attack" HREF="manual_toc.html#Security_against_attack">5.4.2  Making MySQL Secure Against Attackers</A></H3>

<P>
<A NAME="IDX502"></A>
<A NAME="IDX503"></A>

</P>
<P>
When you connect to a MySQL server, you should use a password.  The password
is not transmitted in clear text over the connection. Password handling during
the client connection sequence was upgraded in MySQL 4.1.1 to be very secure.
If you are using an older version of MySQL, or are still using pre-4.1.1-style
passwords, the encryption
algorithm is less strong and with some effort a clever attacker who can
sniff the traffic between the client and the server can crack the password.
(See section <A HREF="manual_MySQL_Database_Administration.html#Password_hashing">5.5.9  Password Hashing in MySQL 4.1</A> for a discussion of the different password handling
methods.)
If the connection between the client and the server goes through an
untrusted network, you should use an SSH tunnel to encrypt the communication.

</P>
<P>
All other information is transferred as text that can be read by anyone who
is able to watch the connection.  If you are concerned about this, you can
use the compressed protocol (in MySQL 3.22 and above) to make
traffic much more difficult to decipher.  To make the connection even more
secure, you should use SSH to get an encrypted TCP/IP connection between a
MySQL server and a MySQL client.  You can find an Open Source SSH
client at <a HREF="http://www.openssh.org/">http://www.openssh.org/</a>, and a commercial SSH client at
<a HREF="http://www.ssh.com/">http://www.ssh.com/</a>.

</P>
<P>
If you are using MySQL 4.0 or newer, you can also use internal OpenSSL support.
See section <A HREF="manual_MySQL_Database_Administration.html#Secure_connections">5.6.7  Using Secure Connections</A>.

</P>
<P>
To make a MySQL system secure, you should strongly consider the
following suggestions:

</P>

<UL>
<LI>

Use passwords for all MySQL users. A client program does not necessarily
know the identity of the person running it. It is common for client/server
applications that the user can specify any username to the client program.
For example, anyone can use the <code>mysql</code> program to connect as any other
person simply by invoking it as <code>mysql -u <var>other_user</var> <var>db_name</var></code> if
<var>other_user</var> has no password. If all users have a password,
connecting using another user's account becomes much more difficult.

To change the password for a user, use the <code>SET PASSWORD</code> statement.
It is also possible to update the <code>user</code> table in the <code>mysql</code>
database directly.  For example, to change the password of all MySQL accounts
that have a username of <code>root</code>, do this:


<PRE>
shell&#62; mysql -u root
mysql&#62; UPDATE mysql.user SET Password=PASSWORD('<var>newpwd</var>')
    -&#62; WHERE User='root';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<LI>

Don't run the MySQL server as the Unix <code>root</code> user.  This is
very dangerous, because any user with the <code>FILE</code> privilege will be able
to create files as <code>root</code> (for example, <code>~root/.bashrc</code>). To
prevent this, <code>mysqld</code> refuses to run as <code>root</code> unless that
is specified explicitly using a <code>--user=root</code> option.

<code>mysqld</code> can be run as an ordinary unprivileged user instead.
You can also create a separate Unix account named <code>mysql</code> to make
everything even more secure. Use the account only for administering MySQL.
To start <code>mysqld</code> as another Unix user, add a <code>user</code>
option that specifies the username to the <code>[mysqld]</code> group of the
<tt>`/etc/my.cnf'</tt> option file or the <tt>`my.cnf'</tt> option file in the
server's data directory. For example:


<PRE>
[mysqld]
user=mysql
</PRE>

This causes the server to start as the designated user whether you
start it manually or by using <code>mysqld_safe</code> or <code>mysql.server</code>.
For more details, see section <A HREF="manual_Problems.html#Changing_MySQL_user">A.3.2  How to Run MySQL as a Normal User</A>.

Running <code>mysqld</code> as a Unix user other than <code>root</code> does not
mean that you need to change the <code>root</code> username in the <code>user</code>
table. Usernames for MySQL accounts have nothing to do with usernames for Unix
accounts.

<LI>

Don't allow the use of symlinks to tables. (This can be disabled with the
<code>--skip-symbolic-links</code> option.) This is especially important if you run
<code>mysqld</code> as <code>root</code>, because anyone that has write access to the
server's data directory then could delete any file in the system!
See section <A HREF="manual_MySQL_Optimization.html#Symbolic_links_to_tables">7.6.1.2  Using Symbolic Links for Tables on Unix</A>.

<LI>

Make sure that the only Unix user with read or write privileges in the
database directories is the user that <code>mysqld</code> runs as.

<LI>

Don't grant the <code>PROCESS</code> or <code>SUPER</code> privilege to non-administrative users.
The output of <code>mysqladmin processlist</code> shows the text of the currently
executing queries, so any user who is allowed to execute that command
might be able to see if another user issues an <code>UPDATE user SET
password=PASSWORD('not_secure')</code> query.

<code>mysqld</code> reserves an extra connection for users who have the
<code>SUPER</code> privilege (<code>PROCESS</code> before MySQL 4.0.2), so that a MySQL
<code>root</code> user can log in and check server activity even if all normal
connections are in use.

The <code>SUPER</code> privilege
can be used to terminate client connections, change server operation by
changing the value of system variables, and control replication servers.

<LI>

Don't grant the <code>FILE</code> privilege to non-administrative users.
Any user that has this privilege can write a file anywhere in the
filesystem with the privileges of the <code>mysqld</code> daemon!  To make
this a bit safer, files generated with <code>SELECT ... INTO OUTFILE</code>
will not overwrite existing files and are writable by everyone.

<A NAME="IDX504"></A>

The <code>FILE</code> privilege may also be used to read any file that is
world-readable or accessible to the Unix user that the server runs as.
With this privilege, you can read any file into a database table.
This could be abused, for example, by using <code>LOAD DATA</code> to load
<tt>`/etc/passwd'</tt> into a table, which then can be displayed with
<code>SELECT</code>.

<LI>

If you don't trust your DNS, you should use IP numbers rather than
hostnames in the grant tables. In any case, you should be very careful
about creating grant table entries using hostname values that contain
wildcards!

<LI>

If you want to restrict the number of connections allowed to a single account,
you can do so by setting the <code>max_user_connections</code> variable in
<code>mysqld</code>.
The <code>GRANT</code> statement also supports resource control options for limiting
the extent of server use allowed to an account.
</UL>



<H3><A NAME="Privileges_options" HREF="manual_toc.html#Privileges_options">5.4.3  Startup Options for <code>mysqld</code> Concerning Security</A></H3>

<P>
The following <code>mysqld</code> options affect security:

</P>
<DL COMPACT>

<DT><code>--local-infile[={0|1}]</code>
<DD>
If you start the server with <code>--local-infile=0</code>, clients cannot use
<code>LOCAL</code> in <code>LOAD DATA</code> statements.
See section <A HREF="manual_MySQL_Database_Administration.html#LOAD_DATA_LOCAL">5.4.4  Security Issues with <code>LOAD DATA LOCAL</code></A>.

<DT><code>--safe-show-database</code>
<DD>
With this option, the <code>SHOW DATABASES</code> statement displays the names
of only those databases for which the user has some kind of privilege.
As of MySQL 4.0.2, this option is deprecated and doesn't do anything
(it is enabled by default), because there is now a <code>SHOW DATABASES</code>
privilege that can be used to control access to database
names on a per-account basis. See section <A HREF="manual_SQL_Syntax.html#GRANT">13.5.1.2  <code>GRANT</code> and <code>REVOKE</code> Syntax</A>.

<DT><code>--safe-user-create</code>
<DD>
If this is enabled, a user cannot create new users with the <code>GRANT</code>
statement unless the user has the <code>INSERT</code> privilege for the
<code>mysql.user</code> table.  If you want a user to have the ability to create
new users with those privileges that the user has right to grant, you should
grant the user the following privilege:


<PRE>
mysql&#62; GRANT INSERT(user) ON mysql.user TO '<var>user_name</var>'@'<var>host_name</var>';
</PRE>

This will ensure that the user can't change any privilege columns directly,
but has to use the <code>GRANT</code> statement to give privileges to other users.

<DT><code>--secure-auth</code>
<DD>
Disallow authentication for accounts that have old (pre-4.1) passwords.
This option is available as of MySQL 4.1.1.

<DT><code>--skip-grant-tables</code>
<DD>
This option causes the server not to use the privilege system at all. This
gives everyone <em>full access</em> to all databases!  (You can tell a running
server to start using the grant tables again by executing a <code>mysqladmin
flush-privileges</code> or <code>mysqladmin reload</code> command, or by issuing a
<code>FLUSH PRIVILEGES</code> statement.)

<DT><code>--skip-name-resolve</code>
<DD>
Hostnames are not resolved.  All <code>Host</code> column values in the grant
tables must be IP numbers or <code>localhost</code>.

<DT><code>--skip-networking</code>
<DD>
Don't allow TCP/IP connections over the network.  All connections to
<code>mysqld</code> must be made via Unix socket files.
This option is unsuitable when using a MySQL version prior to 3.23.27 with
the MIT-pthreads package, because Unix socket files were not supported by
MIT-pthreads at that time.

<DT><code>--skip-show-database</code>
<DD>
With this option, the <code>SHOW DATABASES</code> statement is allowed only to
users who have the <code>SHOW DATABASES</code> privilege, and the statement
displays all database names.  Without this option, <code>SHOW DATABASES</code> is
allowed to all users, but displays each database name only if the user has
the <code>SHOW DATABASES</code> privilege or some privilege for the database.

</DL>



<H3><A NAME="LOAD_DATA_LOCAL" HREF="manual_toc.html#LOAD_DATA_LOCAL">5.4.4  Security Issues with <code>LOAD DATA LOCAL</code></A></H3>

<P>
The <code>LOAD DATA</code> statement can load a file that is located on the
server host, or it can load a file that is located on the client host when
the <code>LOCAL</code> keyword is specified.

</P>
<P>
There are two potential security issues with supporting the <code>LOCAL</code>
version of <code>LOAD DATA</code> statements:

</P>

<UL>
<LI>

The transfer of the file from the client host to the server host is initiated
by the MySQL server. In theory, a patched server could be built that would
tell the client program to transfer a file of the server's choosing rather
than the file named by the client in the <code>LOAD DATA</code> statement. Such a
server could access any file on the client host to which the client user has
read access.

<LI>

In a Web environment where the clients are connecting from a Web
server, a user could use <code>LOAD DATA LOCAL</code> to read any files
that the Web server process has read access to (assuming that a user could
run any command against the SQL server). In this environment, the client with
respect to the MySQL server actually is the Web server, not the program being
run by the user connecting to the Web server.

</UL>

<P>
To deal with these problems, we changed how <code>LOAD DATA
LOCAL</code> is handled as of MySQL 3.23.49 and MySQL 4.0.2 (4.0.13 on Windows):

</P>

<UL>

<LI>

By default, all MySQL clients and libraries in binary distributions are
compiled with the <code>--enable-local-infile</code> option, to be compatible
with MySQL 3.23.48 and before.

<LI>

If you build MySQL from source but don't use the <code>--enable-local-infile</code>
option to <code>configure</code>, <code>LOAD DATA LOCAL</code> cannot be used
by any client unless it is written explicitly to invoke
<code>mysql_options(... MYSQL_OPT_LOCAL_INFILE, 0)</code>.
See section <A HREF="manual_MySQL_APIs.html#mysql_options">21.2.3.41  <code>mysql_options()</code></A>.

<LI>

You can disable all <code>LOAD DATA LOCAL</code> commands from the server side
by starting <code>mysqld</code> with the <code>--local-infile=0</code> option.

<LI>

For the <code>mysql</code> command-line client, <code>LOAD DATA LOCAL</code> can be
enabled by specifying the <code>--local-infile[=1]</code> option, or disabled with
the <code>--local-infile=0</code> option.  Similarly, for <code>mysqlimport</code>,
the <code>--local</code> or <code>-L</code> option enables local data file loading. In
any case, successful use of a local loading operation requires that the
server is enabled to allow it.

<LI>

If you use <code>LOAD DATA LOCAL</code> in Perl scripts or other programs that
read the <code>[client]</code> group from option files, you can add the
<code>local-infile=1</code> option to that group. However, to keep this from
causing problems for programs that do not understand <code>local-infile</code>,
specify it using the <code>loose-</code> prefix:


<PRE>
[client]
loose-local-infile=1
</PRE>

The <code>loose-</code> prefix can be used as of MySQL 4.0.2.

<LI>

If <code>LOAD DATA LOCAL INFILE</code> is disabled, either in the server or
the client, a client that attempts to issue such a statement receives the
following error message:


<PRE>
ERROR 1148: The used command is not allowed with this MySQL version
</PRE>

</UL>



<H2><A NAME="Privilege_system" HREF="manual_toc.html#Privilege_system">5.5  The MySQL Access Privilege System</A></H2>

<P>
<A NAME="IDX505"></A>
<A NAME="IDX506"></A>
<A NAME="IDX507"></A>
<A NAME="IDX508"></A>

</P>
<P>
MySQL has an advanced but non-standard security/privilege
system.  This section describes how it works.

</P>



<H3><A NAME="What_Privileges" HREF="manual_toc.html#What_Privileges">5.5.1  What the Privilege System Does</A></H3>

<P>
<A NAME="IDX509"></A>
<A NAME="IDX510"></A>
<A NAME="IDX511"></A>

</P>
<P>
The primary function of the MySQL privilege system is to
authenticate a user connecting from a given host, and to associate that user
with privileges on a database such as
<code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code>.

</P>
<P>
Additional functionality includes the ability to have an anonymous user and
to grant privileges for MySQL-specific functions such as <code>LOAD
DATA INFILE</code> and administrative operations.

</P>



<H3><A NAME="Privileges" HREF="manual_toc.html#Privileges">5.5.2  How the Privilege System Works</A></H3>

<P>
<A NAME="IDX512"></A>

</P>
<P>
The MySQL privilege system ensures that all users may perform only the
operations allowed to them.  As a user, when you connect to a
MySQL server, your identity is determined by <em>the host from
which you connect</em> and <em>the username you specify</em>.  The system grants
privileges according to your identity and <em>what you want to do</em>.

</P>
<P>
MySQL considers both your hostname and username in identifying you
because there is little reason to assume that a given username belongs to
the same person everywhere on the Internet.  For example, the user
<code>joe</code> who connects from <code>office.com</code> need not be the same
person as the user <code>joe</code> who connects from <code>elsewhere.com</code>.
MySQL handles this by allowing you to distinguish users on different
hosts that happen to have the same name:  You can grant <code>joe</code> one set
of privileges for connections from <code>office.com</code>, and a different set
of privileges for connections from <code>elsewhere.com</code>.

</P>
<P>
MySQL access control involves two stages:

</P>

<UL>
<LI>

Stage 1: The server checks whether you are even allowed to connect.

<LI>

Stage 2: Assuming that you can connect, the server checks each statement you issue
to see whether you have sufficient privileges to perform it.  For
example, if you try to select rows from a table in a database or drop a table
from the database, the server verifies that you have the <code>SELECT</code>
privilege for the table or the <code>DROP</code> privilege for the database.
</UL>

<P>
If your privileges are changed (either by yourself or someone
else) while you are connected, those changes will not necessarily take
effect immediately for the next statement you issue.  See section <A HREF="manual_MySQL_Database_Administration.html#Privilege_changes">5.5.7  When Privilege Changes Take Effect</A> for details.

</P>
<P>
The server stores privilege information in the grant tables of the
<code>mysql</code> database (that is, in the database named <code>mysql</code>).
The MySQL server reads the contents of these tables into memory when it
starts and re-reads them under the circumstances indicated in section <A HREF="manual_MySQL_Database_Administration.html#Privilege_changes">5.5.7  When Privilege Changes Take Effect</A>. Access-control decisions are based on the in-memory copies of the
grant tables.

</P>
<P>
Normally, you manipulate the contents of the grant tables indirectly by using
the <code>GRANT</code> and <code>REVOKE</code> statements to set up accounts and control
the privileges available to each one.
See section <A HREF="manual_SQL_Syntax.html#GRANT">13.5.1.2  <code>GRANT</code> and <code>REVOKE</code> Syntax</A>.
The discussion here describes the underlying structure of the grant tables and
how the server uses their contents when interacting with clients.

</P>
<P>
The server uses the <code>user</code>, <code>db</code>, and <code>host</code> tables in the
<code>mysql</code> database at both stages of access control.  The columns in these
grant tables are shown here:

</P>
<TABLE BORDER>
<TR><TD><strong>Table Name</strong>
 </TD><TD> <strong>user</strong> </TD><TD> <strong>db</strong> </TD><TD> <strong>host</strong>

</TD></TR>
<TR><TD><strong>Scope columns</strong>
 </TD><TD> <code>Host</code> </TD><TD> <code>Host</code> </TD><TD> <code>Host</code>
</TD></TR>
<TR><TD></TD><TD> <code>User</code> </TD><TD> <code>Db</code> </TD><TD> <code>Db</code>
</TD></TR>
<TR><TD></TD><TD> <code>Password</code> </TD><TD> <code>User</code> </TD><TD>

</TD></TR>
<TR><TD><strong>Privilege columns</strong>
 </TD><TD> <code>Select_priv</code> </TD><TD> <code>Select_priv</code> </TD><TD> <code>Select_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Insert_priv</code> </TD><TD> <code>Insert_priv</code> </TD><TD> <code>Insert_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Update_priv</code> </TD><TD> <code>Update_priv</code> </TD><TD> <code>Update_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Delete_priv</code> </TD><TD> <code>Delete_priv</code> </TD><TD> <code>Delete_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Index_priv</code> </TD><TD> <code>Index_priv</code> </TD><TD> <code>Index_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Alter_priv</code> </TD><TD> <code>Alter_priv</code> </TD><TD> <code>Alter_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Create_priv</code> </TD><TD> <code>Create_priv</code> </TD><TD> <code>Create_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Drop_priv</code> </TD><TD> <code>Drop_priv</code> </TD><TD> <code>Drop_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Grant_priv</code> </TD><TD> <code>Grant_priv</code> </TD><TD> <code>Grant_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Create_view_priv</code> </TD><TD> <code>Create_view_priv</code> </TD><TD> <code>Create_view_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Show_view_priv</code> </TD><TD> <code>Show_view_priv</code> </TD><TD> <code>Show_view_priv</code>

</TD></TR>
<TR><TD></TD><TD> <code>References_priv</code> </TD><TD> <code>References_priv</code> </TD><TD> <code>References_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Reload_priv</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>Shutdown_priv</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>Process_priv</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>File_priv</code> </TD><TD> </TD><TD> 

</TD></TR>
<TR><TD></TD><TD> <code>Show_db_priv</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>Super_priv</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>Create_tmp_table_priv</code> </TD><TD> <code>Create_tmp_table_priv</code> </TD><TD> <code>Create_tmp_table_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Lock_tables_priv</code> </TD><TD> <code>Lock_tables_priv</code> </TD><TD> <code>Lock_tables_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Execute_priv</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>Repl_slave_priv</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>Repl_client_priv</code> </TD><TD> </TD><TD> 

</TD></TR>
<TR><TD></TD><TD> <code>ssl_type</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>ssl_cipher</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>x509_issuer</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>x509_subject</code> </TD><TD> </TD><TD> 

</TD></TR>
<TR><TD></TD><TD> <code>max_questions</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>max_updates</code> </TD><TD> </TD><TD> 
</TD></TR>
<TR><TD></TD><TD> <code>max_connections</code> </TD><TD> </TD><TD> 
</TD></TR>
</TABLE>

<P>
The
<code>ssl_type</code>,
<code>ssl_cipher</code>,
<code>x509_issuer</code>, and
<code>x509_subject</code>
columns were added in MySQL 4.0.0.

</P>
<P>
The
<code>Create_tmp_table_priv</code>,
<code>Execute_priv</code>,
<code>Lock_tables_priv</code>,
<code>Repl_client_priv</code>,
<code>Repl_slave_priv</code>,
<code>Show_db_priv</code>,
<code>Super_priv</code>,
<code>max_questions</code>,
<code>max_updates</code>, and
<code>max_connections</code>
columns were added in MySQL 4.0.2.

</P>
<P>
The <code>Create_view_priv</code> and <code>Show_view_priv</code> columns were added in
MySQL 5.0.1.

</P>
<P>
During the second stage of access control (request verification), the server
may, if the request involves tables, additionally consult the
<code>tables_priv</code> and <code>columns_priv</code> tables that provide finer control
at the table and column levels.  The columns in these
tables are shown here:

</P>
<TABLE BORDER>
<TR><TD><strong>Table Name</strong> </TD><TD> <strong>tables_priv</strong> </TD><TD> <strong>columns_priv</strong>

</TD></TR>
<TR><TD><strong>Scope columns</strong> </TD><TD> <code>Host</code> </TD><TD> <code>Host</code>
</TD></TR>
<TR><TD></TD><TD> <code>Db</code> </TD><TD> <code>Db</code>
</TD></TR>
<TR><TD></TD><TD> <code>User</code> </TD><TD> <code>User</code>
</TD></TR>
<TR><TD></TD><TD> <code>Table_name</code> </TD><TD> <code>Table_name</code>
</TD></TR>
<TR><TD></TD><TD> </TD><TD> <code>Column_name</code>

</TD></TR>
<TR><TD><strong>Privilege columns</strong> </TD><TD> <code>Table_priv</code> </TD><TD> <code>Column_priv</code>
</TD></TR>
<TR><TD></TD><TD> <code>Column_priv</code> </TD><TD>

</TD></TR>
<TR><TD><strong>Other columns</strong> </TD><TD> <code>Timestamp</code> </TD><TD> <code>Timestamp</code>
</TD></TR>
<TR><TD></TD><TD> <code>Grantor</code> </TD><TD>
</TD></TR>
</TABLE>

<P>
The <code>Timestamp</code> and <code>Grantor</code> columns currently are unused and are
discussed no further here.

</P>
<P>
Each grant table contains scope columns and privilege columns:

</P>

<UL>
<LI>

Scope columns determine the scope of each entry (row) in the tables; that is, the
context in which the entry applies.  For example, a <code>user</code> table entry
with <code>Host</code> and <code>User</code> values of <code>'thomas.loc.gov'</code> and
<code>'bob'</code> would be used for authenticating connections made to the server
from the host <code>thomas.loc.gov</code> by a client that specifies a username of
<code>bob</code>.  Similarly, a <code>db</code>
table entry with <code>Host</code>, <code>User</code>, and <code>Db</code> column values of
<code>'thomas.loc.gov'</code>, <code>'bob'</code> and <code>'reports'</code> would be used when
<code>bob</code> connects from the host <code>thomas.loc.gov</code> to access the
<code>reports</code> database.  The <code>tables_priv</code> and <code>columns_priv</code>
tables contain scope columns indicating tables or table/column combinations
to which each entry applies.

<LI>

Privilege columns indicate the privileges granted by a table entry; that is,
what operations can be performed.  The server combines the information in the
various grant tables to form a complete description of a user's privileges.
The rules used to do this are described in section <A HREF="manual_MySQL_Database_Administration.html#Request_access">5.5.6  Access Control, Stage 2: Request Verification</A>.

</UL>

<P>
Scope columns contain strings. They are declared as shown here;
the default value for each is the empty string:

</P>
<TABLE BORDER>
<TR><TD><strong>Column Name</strong> </TD><TD> <strong>Type</strong>
</TD></TR>
<TR><TD><code>Host</code> </TD><TD> <code>CHAR(60)</code>
</TD></TR>
<TR><TD><code>User</code> </TD><TD> <code>CHAR(16)</code>
</TD></TR>
<TR><TD><code>Password</code> </TD><TD> <code>CHAR(16)</code>
</TD></TR>
<TR><TD><code>Db</code> </TD><TD> <code>CHAR(64)</code>
</TD></TR>
<TR><TD><code>Table_name</code> </TD><TD> <code>CHAR(60)</code>
</TD></TR>
<TR><TD><code>Column_name</code> </TD><TD> <code>CHAR(60)</code>
</TD></TR>
</TABLE>

<P>
Before MySQL 3.23, the <code>Db</code> column is <code>CHAR(32)</code> in some tables
and <code>CHAR(60)</code> in others.

</P>
<P>
<A NAME="IDX513"></A>
For access-checking purposes, comparisons of <code>Host</code> values are
case-insensitive.  <code>User</code>, <code>Password</code>, <code>Db</code>, and
<code>Table_name</code> values are case sensitive.
<code>Column_name</code> values are case insensitive in MySQL
3.22.12 or later.

</P>
<P>
In the <code>user</code>, <code>db</code>, and <code>host</code> tables, each privilege
is listed in a separate column that is declared as
<code>ENUM('N','Y') DEFAULT 'N'</code>. In other words, each privilege can be disabled
or enabled, with the default being disabled.

</P>
<P>
In the <code>tables_priv</code> and <code>columns_priv</code> tables, the privilege
columns are declared as <code>SET</code> columns. Values in these columns can
contain any combination of the privileges controlled by the table:

</P>
<TABLE BORDER>
<TR><TD><strong>Table Name</strong>
 </TD><TD> <strong>Column Name</strong>
 </TD><TD> <strong>Possible Set Elements</strong>
</TD></TR>
<TR><TD><code>tables_priv</code>
 </TD><TD> <code>Table_priv</code>
 </TD><TD> <code>'Select', 'Insert', 'Update', 'Delete', 'Create', 'Drop', 'Grant', 'References', 'Index', 'Alter'</code>
</TD></TR>
<TR><TD><code>tables_priv</code>
 </TD><TD> <code>Column_priv</code>
 </TD><TD> <code>'Select', 'Insert', 'Update', 'References'</code>
</TD></TR>
<TR><TD><code>columns_priv</code>
 </TD><TD> <code>Column_priv</code>
 </TD><TD> <code>'Select', 'Insert', 'Update', 'References'</code>
</TD></TR>
</TABLE>

<P>
Briefly, the server uses the grant tables as follows:

</P>

<UL>
<LI>

The <code>user</code> table scope columns determine whether to reject or allow
incoming connections.  For allowed connections, any privileges granted in
the <code>user</code> table indicate the user's global (superuser) privileges.
These privileges apply to <em>all</em> databases on the server.

<LI>

The <code>db</code> table scope columns determine which users can access which
databases from which hosts.  The privilege columns determine which operations
are allowed. A privilege granted at the database level applies to the database
and to all its tables.

<LI>

The <code>host</code> table is used in conjunction with the <code>db</code> table when you
want a given <code>db</code> table entry to apply to several hosts.  For example,
if you want a user to be able to use a database from several hosts in
your network, leave the <code>Host</code> value empty in the user's <code>db</code> table
entry, then populate the <code>host</code> table with an entry for each of those
hosts.  This mechanism is described more detail in section <A HREF="manual_MySQL_Database_Administration.html#Request_access">5.5.6  Access Control, Stage 2: Request Verification</A>.

<strong>Note</strong>: The <code>host</code> table is not affected by the <code>GRANT</code> and
<code>REVOKE</code> statements. Most MySQL installations need not use this table at
all.

<LI>

The <code>tables_priv</code> and <code>columns_priv</code> tables are similar to
the <code>db</code> table, but are more fine-grained: They apply at the
table and column levels rather than at the database level.
A privilege granted at the table level applies to the table and to all its
columns.
A privilege granted at the column level applies only to a specific column.
</UL>

<P>
Administrative privileges (such as <code>RELOAD</code> or <code>SHUTDOWN</code>)
are specified only in the <code>user</code> table.  This is because
administrative operations are operations on the server itself and are not
database-specific, so there is no reason to list these privileges in the
other grant tables.  In fact, to determine whether you can perform an
administrative operation, the server need consult only the <code>user</code> table.

</P>
<P>
The <code>FILE</code> privilege also is specified only in the <code>user</code> table.
It is not an administrative privilege as such, but your ability to read or
write files on the server host is independent of the database you are
accessing.

</P>
<P>
The <code>mysqld</code> server reads the contents of the grant tables into memory
when it starts. You can tell it to re-read the tables by issuing a <code>FLUSH
PRIVILEGES</code> statement or executing a <code>mysqladmin flush-privileges</code> or
<code>mysqladmin reload</code> command.
Changes to the grant tables take effect as indicated in
section <A HREF="manual_MySQL_Database_Administration.html#Privilege_changes">5.5.7  When Privilege Changes Take Effect</A>.

</P>
<P>
When you modify the contents of the grant tables, it is a good idea to make
sure that your changes set up privileges the way you want. One way to check
the privileges for a given account is to use the <code>SHOW GRANTS</code> statement.
For example, to determine the privileges that are granted to an account with
<code>Host</code> and <code>User</code> values of <code>pc84.example.com</code> and <code>bob</code>,
issue this statement:

</P>

<PRE>
mysql&#62; SHOW GRANTS FOR 'bob'@'pc84.example.com';
</PRE>

<P>
A useful
diagnostic tool is the <code>mysqlaccess</code> script, which Yves Carlier has
provided for the MySQL distribution.  Invoke <code>mysqlaccess</code> with
the <code>--help</code> option to find out how it works.
Note that <code>mysqlaccess</code> checks access using only the <code>user</code>,
<code>db</code>, and <code>host</code> tables.  It does not check table or column
privileges specified in the <code>tables_priv</code> or <code>columns_priv</code> tables.

</P>
<P>
For additional help in diagnosing privilege-related problems, see
section <A HREF="manual_MySQL_Database_Administration.html#Access_denied">5.5.8  Causes of <code>Access denied</code> Errors</A>.  For general advice on security issues, see
section <A HREF="manual_MySQL_Database_Administration.html#Security">5.4  General Security Issues</A>.

</P>



<H3><A NAME="Privileges_provided" HREF="manual_toc.html#Privileges_provided">5.5.3  Privileges Provided by MySQL</A></H3>

<P>
<A NAME="IDX514"></A>

</P>
<P>
Information about account privileges is stored in the <code>user</code>, <code>db</code>,
<code>host</code>, <code>tables_priv</code>, and <code>columns_priv</code> tables in the
<code>mysql</code> database.  The MySQL server reads the contents of these
tables into memory when it starts and re-reads them under the circumstances
indicated in section <A HREF="manual_MySQL_Database_Administration.html#Privilege_changes">5.5.7  When Privilege Changes Take Effect</A>.  Access-control decisions are based
on the in-memory copies of the grant tables.

</P>
<P>
The names used in this manual to refer to the privileges provided by
MySQL are shown in the following table, along with the table column name
associated with each privilege in the grant tables and the context in
which the privilege applies. Further information about the meaning of
each privilege may be found at section <A HREF="manual_SQL_Syntax.html#GRANT">13.5.1.2  <code>GRANT</code> and <code>REVOKE</code> Syntax</A>.

</P>

<TABLE BORDER>
<TR><TD><strong>Privilege</strong> </TD><TD> <strong>Column</strong> </TD><TD> <strong>Context</strong>
</TD></TR>
<TR><TD><code>ALTER</code> </TD><TD> <code>Alter_priv</code> </TD><TD> tables
</TD></TR>
<TR><TD><code>DELETE</code> </TD><TD> <code>Delete_priv</code> </TD><TD> tables
</TD></TR>
<TR><TD><code>INDEX</code> </TD><TD> <code>Index_priv</code> </TD><TD> tables
</TD></TR>
<TR><TD><code>INSERT</code> </TD><TD> <code>Insert_priv</code> </TD><TD> tables
</TD></TR>
<TR><TD><code>SELECT</code> </TD><TD> <code>Select_priv</code> </TD><TD> tables
</TD></TR>
<TR><TD><code>UPDATE</code> </TD><TD> <code>Update_priv</code> </TD><TD> tables
</TD></TR>
<TR><TD><code>CREATE</code> </TD><TD> <code>Create_priv</code> </TD><TD> databases, tables, or indexes
</TD></TR>
<TR><TD><code>DROP</code> </TD><TD> <code>Drop_priv</code> </TD><TD> databases or tables
</TD></TR>
<TR><TD><code>GRANT</code> </TD><TD> <code>Grant_priv</code> </TD><TD> databases or tables
</TD></TR>
<TR><TD><code>REFERENCES</code> </TD><TD> <code>References_priv</code> </TD><TD> databases or tables
</TD></TR>
<TR><TD><code>CREATE TEMPORARY TABLES</code> </TD><TD> <code>Create_tmp_table_priv</code> </TD><TD> server administration
</TD></TR>
<TR><TD><code>EXECUTE</code> </TD><TD> <code>Execute_priv</code> </TD><TD> server administration
</TD></TR>
<TR><TD><code>FILE</code> </TD><TD> <code>File_priv</code> </TD><TD> file access on server host
</TD></TR>
<TR><TD><code>LOCK TABLES</code> </TD><TD> <code>Lock_tables_priv</code> </TD><TD> server administration
</TD></TR>
<TR><TD><code>PROCESS</code> </TD><TD> <code>Process_priv</code> </TD><TD> server administration
</TD></TR>
<TR><TD><code>RELOAD</code> </TD><TD> <code>Reload_priv</code> </TD><TD> server administration
</TD></TR>
<TR><TD><code>REPLICATION CLIENT</code> </TD><TD> <code>Repl_client_priv</code> </TD><TD> server administration
</TD></TR>
<TR><TD><code>REPLICATION SLAVE</code> </TD><TD> <code>Repl_slave_priv</code> </TD><TD> server administration
</TD></TR>
<TR><TD><code>SHOW DATABASES</code> </TD><TD> <code>Show_db_priv</code> </TD><TD> server administration
</TD></TR>
<TR><TD><code>SHUTDOWN</code> </TD><TD> <code>Shutdown_priv</code> </TD><TD> server administration
</TD></TR>
<TR><TD><code>SUPER</code> </TD><TD> <code>Super_priv</code> </TD><TD> server administration
</TD></TR>
</TABLE>

<P>
The <code>CREATE TEMPORARY TABLES</code>, <code>EXECUTE</code>, <code>LOCK TABLES</code>,
<code>REPLICATION CLIENT</code>, <code>REPLICATION SLAVE</code>, <code>SHOW DATABASES</code>,
and <code>SUPER</code> privileges were added in MySQL 4.0.2.

</P>
<P>
The <code>EXECUTE</code> and <code>REFERENCES</code> privileges currently are unused.

</P>
<P>
The <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, and <code>DELETE</code>
privileges allow you to perform operations on rows in existing tables in
a database.

</P>
<P>
<code>SELECT</code> statements require the <code>SELECT</code> privilege only if they
actually retrieve rows from a table.  Some <code>SELECT</code> statements do not
access tables and can be executed without permission for any database.
For example, you can use the <code>mysql</code> client as a simple calculator
to evaluate expressions that make no reference to tables:

</P>

<PRE>
mysql&#62; SELECT 1+1;
mysql&#62; SELECT PI()*2;
</PRE>

<P>
The <code>CREATE</code> and <code>DROP</code> privileges allow you to create new
databases and tables, or to drop (remove) existing databases and tables.
If you grant the <code>DROP</code> privilege for the <code>mysql</code>
database to a user, that user can drop the database in which the
MySQL access privileges are stored!

</P>
<P>
The <code>INDEX</code> privilege allows you to create or drop (remove) indexes.
<code>INDEX</code> applies to existing tables.
If you have the <code>CREATE</code> privilege for a table, you can include index
definitions in the <code>CREATE TABLE</code> statement.

</P>
<P>
The <code>ALTER</code> privilege allows you to use <code>ALTER TABLE</code> to change the
structure of or rename tables.

</P>
<P>
The <code>GRANT</code> privilege allows you to give to other users those
privileges that you yourself possess.

</P>
<P>
The <code>FILE</code> privilege gives you permission to read and write files on
the server host using the <code>LOAD DATA INFILE</code> and <code>SELECT ... INTO
OUTFILE</code> statements. A user who has the <code>FILE</code> privilege can read any
file on the server host that is either world-readable or readable by the MySQL
server. (This implies the user can read any file in any database
directory, because the server can access any of those files.)
The <code>FILE</code> privilege also allows the user to create new files in any
directory where the MySQL server has write access. Existing files cannot be
overwritten.

</P>
<P>
The remaining privileges are used for administrative operations. Many of
them can be performed by using the <code>mysqladmin</code> program or by
issuing SQL statements.  The following table shows which <code>mysqladmin</code>
commands each administrative privilege allows you to execute:

</P>
<TABLE BORDER>
<TR><TD><strong>Privilege</strong> </TD><TD> <strong>Commands Permitted to Privilege Holders</strong>
</TD></TR>
<TR><TD><code>RELOAD</code> </TD><TD> <code>flush-hosts</code>, <code>flush-logs</code>, <code>flush-privileges</code>, <code>flush-status</code>, <code>flush-tables</code>, <code>flush-threads</code>, <code>refresh</code>, <code>reload</code>
</TD></TR>
<TR><TD><code>SHUTDOWN</code> </TD><TD> <code>shutdown</code>
</TD></TR>
<TR><TD><code>PROCESS</code> </TD><TD> <code>processlist</code>
</TD></TR>
<TR><TD><code>SUPER</code> </TD><TD> <code>kill</code>
</TD></TR>
</TABLE>

<P>
The <code>reload</code> command tells the server to re-read the grant tables
into memory.  <code>flush-privileges</code> is a synonym for <code>reload</code>.
The <code>refresh</code> command closes and reopens the log files and flushes
all tables.  The other <code>flush-<var>xxx</var></code> commands perform functions similar to
<code>refresh</code>, but are more specific and may be preferable in some instances.
For example, if you want to flush just the log files, <code>flush-logs</code>
is a better choice than <code>refresh</code>.

</P>
<P>
The <code>shutdown</code> command shuts down the server. This command can be issued
only from <code>mysqladmin</code>. There is no corresponding SQL statement.

</P>
<P>
The <code>processlist</code> command displays information about the threads
executing within the server (that is, about the statements being executed by
clients associated with other accounts).
The <code>kill</code> command terminates server threads.
You can always display or kill your own threads, but you need the
<code>PROCESS</code> privilege to display threads initiated by other users and
the <code>SUPER</code> privilege to kill them.
See section <A HREF="manual_SQL_Syntax.html#KILL">13.5.5.3  <code>KILL</code> Syntax</A>. Prior to MySQL 4.0.2 when <code>SUPER</code> was
introduced, the <code>PROCESS</code> privilege controls the ability to both see and
terminate threads for other clients.

</P>
<P>
The <code>CREATE TEMPORARY TABLES</code> privilege allows the use of the keyword
<code>TEMPORARY</code> in <code>CREATE TABLE</code> statements.

</P>
<P>
The <code>LOCK TABLES</code> privilege allows the use of explicit <code>LOCK TABLES</code>
statements to lock tables for which you have the <code>SELECT</code> privilege.
This includes the use of write locks, which prevents anyone else from reading
the locked table.

</P>
<P>
The <code>REPLICATION CLIENT</code> privilege allows the use of <code>SHOW MASTER
STATUS</code> and <code>SHOW SLAVE STATUS</code>.

</P>
<P>
The <code>REPLICATION SLAVE</code> privilege should be granted to accounts that are
used by slave servers when they connect to the current server as their master.
Without this privilege, the slave cannot request updates that have been made
to databases on the master server.

</P>
<P>
The <code>SHOW DATABASES</code> privilege allows the account to see database names
by issuing the <code>SHOW DATABASE</code> statement. Accounts that do not have this
privilege see only databases for which they have some privileges, and cannot
use the statement at all if the server was started with the
<code>--skip-show-database</code> option.

</P>
<P>
It is a good idea in general to grant privileges to only those accounts
that need them, but you should exercise particular caution in granting
administrative privileges:

</P>

<UL>
<LI>

The <code>GRANT</code> privilege allows users to give their privileges to
other users.  Two users with different privileges and with the <code>GRANT</code>
privilege are able to combine privileges.

<LI>

The <code>ALTER</code> privilege may be used to subvert the privilege system
by renaming tables.

<LI>

The <code>FILE</code> privilege can be abused to read into a database table any
files that the MySQL server can read on the server host. This includes all
world-readable files and files in the server's data directory. The table
can then be accessed using <code>SELECT</code> to transfer its contents to the
client host.

<LI>

The <code>SHUTDOWN</code> privilege can be abused to deny service to other
users entirely by terminating the server.

<LI>

The <code>PROCESS</code> privilege can be used to view the plain text of
currently executing queries, including queries that set or change passwords.

<LI>

The <code>SUPER</code> privilege can be used to terminate other clients or change
how the server operates.

<LI>

Privileges granted for the <code>mysql</code> database itself can be used to
change passwords and other access privilege information.  Passwords are
stored encrypted, so a malicious user cannot simply read them to know the
plain text password.  However, a user with write access to the <code>user</code>
table <code>Password</code> column can change an account's password, and then
connect to the MySQL server using that account.

</UL>

<P>
There are some things that you cannot do with the MySQL
privilege system:

</P>

<UL>
<LI>

You cannot explicitly specify that a given user should be denied access.
That is, you cannot explicitly match a user and then refuse the connection.

<LI>

You cannot specify that a user has privileges to create or drop tables
in a database but not to create or drop the database itself.
</UL>



<H3><A NAME="Connecting" HREF="manual_toc.html#Connecting">5.5.4  Connecting to the MySQL Server</A></H3>

<P>
<A NAME="IDX515"></A>
<A NAME="IDX516"></A>
<A NAME="IDX517"></A>
<A NAME="IDX518"></A>

</P>
<P>
MySQL client programs generally expect you to specify connection
parameters when you want to access a MySQL server:

</P>

<UL>
<LI>

The name of the host where the MySQL server is running
<LI>

Your username
<LI>

Your password
</UL>

<P>
For example, the
<code>mysql</code> client can be started as follows from a command-line prompt
(indicated here by <code>shell&#62;</code>):

</P>

<PRE>
shell&#62; mysql -h <var>host_name</var> -u <var>user_name</var> -p<var>your_pass</var>
</PRE>

<P>
Alternate forms of the <code>-h</code>, <code>-u</code>, and <code>-p</code> options are
<code>--host=<var>host_name</var></code>, <code>--user=<var>user_name</var></code>, and
<code>--password=<var>your_pass</var></code>.  Note that there is <em>no space</em> between
<code>-p</code> or <code>--password=</code> and the password following it.

</P>
<P>
If you use a <code>-p</code> or <code>--password</code> option but do not specify the
password value, the client program will prompt you to enter the password.
The password is not displayed as you enter it.
This is more secure than giving the password on the command line.
Any user on your system may be able to see a password specified on the command
line by executing a command such as <code>ps auxww</code>.
See section <A HREF="manual_MySQL_Database_Administration.html#Password_security">5.6.6  Keeping Your Password Secure</A>.

</P>
<P>
MySQL client programs use default values for any connection parameter option
that you do not specify:

</P>

<UL>
<LI>

The default hostname is <code>localhost</code>.

<LI>

The default username is <code>ODBC</code> on Windows and your Unix login name
on Unix.

<LI>

No password is supplied if <code>-p</code> is missing.
</UL>

<P>
Thus, for a Unix user with a login name of <code>joe</code>, all of the following
commands are equivalent:

</P>

<PRE>
shell&#62; mysql -h localhost -u joe
shell&#62; mysql -h localhost
shell&#62; mysql -u joe
shell&#62; mysql
</PRE>

<P>
Other MySQL clients behave similarly.

</P>
<P>
You can specify different default values to be used when you
make a connection so that you need not enter them on the command line each
time you invoke a client program.  This can be done in a couple of ways:

</P>

<UL>
<LI>

<A NAME="IDX519"></A>
You can specify connection parameters in the <code>[client]</code> section of an
option file.  The relevant section of the file might look like this:


<PRE>
[client]
host=<var>host_name</var>
user=<var>user_name</var>
password=<var>your_pass</var>
</PRE>

Option files are discussed further in section <A HREF="manual_Using_MySQL_Programs.html#Option_files">4.3.2  Using Option Files</A>.

<LI>

<A NAME="IDX520"></A>
<A NAME="IDX521"></A>
<A NAME="IDX522"></A>
<A NAME="IDX523"></A>
<A NAME="IDX524"></A>
<A NAME="IDX525"></A>
You can specify some connection parameters using environment variables.  The
host can be specified for <code>mysql</code> using <code>MYSQL_HOST</code>.  The
MySQL username can be specified using <code>USER</code> (this is for
Windows and NetWare only).  The password can be specified using
<code>MYSQL_PWD</code>,
although this is insecure; see section <A HREF="manual_MySQL_Database_Administration.html#Password_security">5.6.6  Keeping Your Password Secure</A>.
For a list of variables, see section <A HREF="manual_Environment_variables.html#Environment_variables">F  Environment Variables</A>.
</UL>



<H3><A NAME="Connection_access" HREF="manual_toc.html#Connection_access">5.5.5  Access Control, Stage 1: Connection Verification</A></H3>

<P>
<A NAME="IDX526"></A>
<A NAME="IDX527"></A>
<A NAME="IDX528"></A>
<A NAME="IDX529"></A>

</P>
<P>
When you attempt to connect to a MySQL server, the server accepts or
rejects the connection based on your identity and whether you can
verify your identity by supplying the correct password.  If not, the server
denies access to you completely.  Otherwise, the server accepts the
connection, then enters Stage 2 and waits for requests.

</P>
<P>
Your identity is based on two pieces of information:

</P>

<UL>
<LI>

The client host from which you connect

<LI>

Your MySQL username
</UL>

<P>
Identity checking is performed using the three <code>user</code> table scope columns
(<code>Host</code>, <code>User</code>, and <code>Password</code>).  The server accepts the
connection only if the <code>Host</code> and <code>User</code> columns in some
<code>user</code> table record match the client hostname and username,
and the client supplies the password specified in that record.

</P>
<P>
<code>Host</code> values in the <code>user</code> table may be specified as follows:

</P>

<UL>
<LI>

A <code>Host</code> value may be a hostname or an IP number, or <code>'localhost'</code>
to indicate the local host.

<LI>

<A NAME="IDX530"></A>
You can use the wildcard characters <samp>`%'</samp> and <samp>`_'</samp> in <code>Host</code>
column values.
These have the same meaning as for pattern-matching operations
performed with the <code>LIKE</code> operator.
For example, a <code>Host</code> value of <code>'%'</code> matches any hostname, whereas a
value of <code>'%.mysql.com'</code> matches any host in the <code>mysql.com</code> domain.

<LI>

<A NAME="IDX531"></A>
As of MySQL 3.23, for <code>Host</code> values specified as
IP numbers, you can specify a netmask indicating how many address bits to
use for the network number. For example:


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON db.*
    -&#62; TO david@'192.58.197.0/255.255.255.0';
</PRE>

This allows <code>david</code> to connect from any client host having an IP number
<code>client_ip</code> for which the following condition is true:


<PRE>
client_ip &#38; netmask = host_ip
</PRE>

That is, for the <code>GRANT</code> statement just shown:


<PRE>
client_ip &#38; 255.255.255.0 = 192.58.197.0
</PRE>

IP numbers that satisfy this condition and can connect to the
MySQL server are those that lie in the range from <code>192.58.197.0</code> to
<code>192.58.197.255</code>.

<LI>

A blank <code>Host</code> value in a <code>db</code> table record means that its
privileges should be combined with those in the entry in the <code>host</code>
table that matches the client hostname.  The privileges are combined
using an AND (intersection) operation, not OR (union).  You can find more
information about the <code>host</code> table in section <A HREF="manual_MySQL_Database_Administration.html#Request_access">5.5.6  Access Control, Stage 2: Request Verification</A>.

A blank <code>Host</code> value in the other grant tables is the same as <code>'%'</code>.

</UL>

<P>
Because you can use IP wildcard values in the <code>Host</code> column
(for example, <code>'144.155.166.%'</code> to match every host on a
subnet), someone could try to exploit this capability by naming a host
<code>144.155.166.somewhere.com</code>.  To foil such attempts, MySQL disallows
matching on hostnames that start with digits and a dot. Thus, if you have
a host named something like <code>1.2.foo.com</code>, its name will never match
the <code>Host</code> column of the grant tables.  An IP wildcard value can
match only IP numbers, not hostnames.

</P>
<P>
<A NAME="IDX532"></A>
In the <code>User</code> column, wildcard characters are not allowed, but you can
specify a blank value, which matches any name.  If the <code>user</code> table
entry that matches an incoming connection has a blank username, the user is
considered to be an anonymous user with no name, not a user with the
name that the client actually specified.  This means that a blank username
is used for all further access checking for the duration of the connection
(that is, during Stage 2).

</P>
<P>
The <code>Password</code> column can be blank.  This is not a wildcard and does
not mean that any password matches. It means that the user must connect
without specifying a password.

</P>
<P>
<A NAME="IDX533"></A>
Non-blank <code>Password</code> values in the <code>user</code> table represent
encrypted passwords.  MySQL does not store passwords in plaintext form for
anyone to see.  Rather, the password supplied by a user who is attempting to
connect is encrypted (using the <code>PASSWORD()</code> function). The encrypted
password then is used during the connection process when checking whether
the password is correct. (This is done without the encrypted password ever
traveling over the connection.)  From MySQL's point of view, the
encrypted password is the REAL password, so you should not give anyone
access to it!  In particular, don't give non-administrative users read
access to the tables in the <code>mysql</code> database!

</P>
<P>
From version 4.1 on, MySQL employs a stronger authentication method that has
better password protection during the connection process than in earlier
versions. It is secure even if TCP/IP packets are sniffed or the
<code>mysql</code> database is captured.  Password encryption is discussed further
in section <A HREF="manual_MySQL_Database_Administration.html#Password_hashing">5.5.9  Password Hashing in MySQL 4.1</A>.

</P>
<P>
The following examples show how various combinations of <code>Host</code> and
<code>User</code> values in the <code>user</code> table apply to incoming
connections:

</P>
<TABLE BORDER>
<TR><TD><code>Host</code> <strong>Value</strong> </TD><TD> <code>User</code> <strong>Value</strong> </TD><TD> <strong>Connections Matched by Entry</strong>
</TD></TR>
<TR><TD><code>'thomas.loc.gov'</code> </TD><TD> <code>'fred'</code> </TD><TD> <code>fred</code>, connecting from <code>thomas.loc.gov</code>
</TD></TR>
<TR><TD><code>'thomas.loc.gov'</code> </TD><TD> <code>''</code> </TD><TD> Any user, connecting from <code>thomas.loc.gov</code>
</TD></TR>
<TR><TD><code>'%'</code> </TD><TD> <code>'fred'</code> </TD><TD> <code>fred</code>, connecting from any host
</TD></TR>
<TR><TD><code>'%'</code> </TD><TD> <code>''</code> </TD><TD> Any user, connecting from any host
</TD></TR>
<TR><TD><code>'%.loc.gov'</code> </TD><TD> <code>'fred'</code> </TD><TD> <code>fred</code>, connecting from any host in the <code>loc.gov</code> domain
</TD></TR>
<TR><TD><code>'x.y.%'</code> </TD><TD> <code>'fred'</code> </TD><TD> <code>fred</code>, connecting from <code>x.y.net</code>, <code>x.y.com</code>, <code>x.y.edu</code>, and so on. (this is probably not useful)
</TD></TR>
<TR><TD><code>'144.155.166.177'</code> </TD><TD> <code>'fred'</code> </TD><TD> <code>fred</code>, connecting from the host with IP address <code>144.155.166.177</code>
</TD></TR>
<TR><TD><code>'144.155.166.%'</code> </TD><TD> <code>'fred'</code> </TD><TD> <code>fred</code>, connecting from any host in the <code>144.155.166</code> class C subnet
</TD></TR>
<TR><TD><code>'144.155.166.0/255.255.255.0'</code> </TD><TD> <code>'fred'</code> </TD><TD> Same as previous example
</TD></TR>
</TABLE>

<P>
It is possible for the client hostname and username of
an incoming connection to match more than one entry in the
<code>user</code> table.  The preceding set of examples demonstrates this:
Several of the entries shown match a connection from <code>thomas.loc.gov</code> by
<code>fred</code>.

</P>
<P>
When multiple matches are possible, the server must determine which of them to
use.  It resolves this issue as follows:

</P>

<UL>
<LI>

Whenever the server reads the <code>user</code> table into memory, it sorts the
entries.
<LI>

When a client attempts to connect, the server looks through the entries in
sorted order.
<LI>

The server uses the first entry that matches the client hostname and username.
</UL>

<P>
To see how this works, suppose that the <code>user</code> table looks like this:

</P>

<PRE>
+-----------+----------+-
| Host      | User     | ...
+-----------+----------+-
| %         | root     | ...
| %         | jeffrey  | ...
| localhost | root     | ...
| localhost |          | ...
+-----------+----------+-
</PRE>

<P>
When the server reads in the table, it orders the entries with the
most-specific <code>Host</code> values first.  Literal hostnames and IP numbers
are the most specific. The pattern <code>'%'</code> means ``any host'' and is
least specific.  Entries with the same <code>Host</code> value are ordered with
the most-specific <code>User</code> values first (a blank <code>User</code> value means
``any user'' and is least specific). For the <code>user</code> table just shown,
the result after sorting looks like this:

</P>

<PRE>
+-----------+----------+-
| Host      | User     | ...
+-----------+----------+-
| localhost | root     | ...
| localhost |          | ...
| %         | jeffrey  | ...
| %         | root     | ...
+-----------+----------+-
</PRE>

<P>
<A NAME="IDX534"></A>
<A NAME="IDX535"></A>
<A NAME="IDX536"></A>
When a client attempts to connect, the server looks through the sorted entries
and uses the first match found.  For a connection from <code>localhost</code> by
<code>jeffrey</code>, two of the entries in the table match:
the one with <code>Host</code> and <code>User</code> values of <code>'localhost'</code> and
<code>''</code>, and the one with values of <code>'%'</code> and <code>'jeffrey'</code>.
The <code>'localhost'</code> entry appears first in sorted order, so that is the one
the server uses.

</P>
<P>
Here is another example.  Suppose that the <code>user</code> table looks like this:

</P>

<PRE>
+----------------+----------+-
| Host           | User     | ...
+----------------+----------+-
| %              | jeffrey  | ...
| thomas.loc.gov |          | ...
+----------------+----------+-
</PRE>

<P>
The sorted table looks like this:

</P>

<PRE>
+----------------+----------+-
| Host           | User     | ...
+----------------+----------+-
| thomas.loc.gov |          | ...
| %              | jeffrey  | ...
+----------------+----------+-
</PRE>

<P>
A connection by <code>jeffrey</code> from <code>thomas.loc.gov</code> is matched by the
first entry, whereas a connection by <code>jeffrey</code> from <code>whitehouse.gov</code>
is matched by the second.

</P>
<P>
It is a common misconception to think that, for a given username, all entries
that explicitly name that user will be used first when the server attempts to
find a match for the connection.  This is simply not true.  The previous
example illustrates this, where a connection from <code>thomas.loc.gov</code> by
<code>jeffrey</code> is first matched not by the entry containing <code>'jeffrey'</code>
as the <code>User</code> column value, but by the entry with no username!
As a result, <code>jeffrey</code> will be authenticated as an anonymous user, even
though he specified a username when connecting.

</P>
<P>
If you are able to connect to the server, but your privileges are not
what you expect, you probably are being authenticated as some other
account.  To find out what account the server used to authenticate
you, use the <code>CURRENT_USER()</code> function. It returns a value in
<code><var>user_name</var>@<var>host_name</var></code> format that indicates the <code>User</code>
and <code>Host</code> values from the matching <code>user</code> table record.
Suppose that <code>jeffrey</code> connects and issues the following query:

</P>

<PRE>
mysql&#62; SELECT CURRENT_USER();
+----------------+
| CURRENT_USER() |
+----------------+
| @localhost     |
+----------------+
</PRE>

<P>
The result shown here indicates that the matching <code>user</code> table entry
had a blank <code>User</code> column value.  In other words, the server is
treating <code>jeffrey</code> as an anonymous user.

</P>
<P>
The <code>CURRENT_USER()</code> function is available as of MySQL 4.0.6.
See section <A HREF="manual_Functions.html#Information_functions">12.8.3  Information Functions</A>.
Another thing you can do to diagnose authentication problems is to print
out the <code>user</code> table and sort it by hand to see where the first
match is being made.

</P>



<H3><A NAME="Request_access" HREF="manual_toc.html#Request_access">5.5.6  Access Control, Stage 2: Request Verification</A></H3>

<P>
Once you establish a connection, the server enters Stage 2 of access
control.  For each request that comes in on the connection, the server
determines what operation you want to perform, then checks whether you have
sufficient privileges to do so.  This is where the privilege columns in the
grant tables come into play.  These privileges can come from any of the
<code>user</code>, <code>db</code>, <code>host</code>, <code>tables_priv</code>, or
<code>columns_priv</code> tables.  (You may find it helpful to refer to
section <A HREF="manual_MySQL_Database_Administration.html#Privileges">5.5.2  How the Privilege System Works</A>, which lists the columns present in each of the grant
tables.)

</P>
<P>
The <code>user</code> table grants privileges that are assigned to you on a global
basis and that apply no matter what the current database is.  For example, if
the <code>user</code> table grants you the <code>DELETE</code> privilege, you can
delete rows from any table in any database on the server host!  In other words,
<code>user</code> table privileges are superuser privileges.  It is wise to grant
privileges in the <code>user</code> table only to superusers such as
database administrators.  For other users, you should leave the privileges
in the <code>user</code> table set to <code>'N'</code> and grant privileges at more
specific levels only. You can grant privileges for particular databases,
tables, or columns.

</P>
<P>
<A NAME="IDX537"></A>
<A NAME="IDX538"></A>
<A NAME="IDX539"></A>
The <code>db</code> and <code>host</code> tables grant database-specific privileges.
Values in the scope columns of these tables can take the following forms:

</P>

<UL>
<LI>

The wildcard characters <samp>`%'</samp> and <samp>`_'</samp> can be used in the <code>Host</code>
and <code>Db</code> columns of either table.  These have the same meaning as for
pattern-matching operations performed with the <code>LIKE</code> operator.  If you
want to use either character literally when granting privileges, you must
escape it with a backslash.  For example, to include <samp>`_'</samp> character
as part of a database name, specify it as <samp>`\_'</samp> in the <code>GRANT</code>
statement.

<LI>

A <code>'%'</code> <code>Host</code> value in the <code>db</code> table means ``any host.'' A
blank <code>Host</code> value in the <code>db</code> table means ``consult the
<code>host</code> table for further information'' (a process that is described later
in this section).

<LI>

A <code>'%'</code> or blank <code>Host</code> value in the <code>host</code> table means ``any
host.''

<LI>

A <code>'%'</code> or blank <code>Db</code> value in either table means ``any database.''

<LI>

A blank <code>User</code> value in either table matches the anonymous user.
</UL>

<P>
<A NAME="IDX540"></A>
<A NAME="IDX541"></A>
<A NAME="IDX542"></A>
<A NAME="IDX543"></A>

</P>
<P>
The server reads in and sorts the <code>db</code> and <code>host</code> tables at the
same time that it reads the <code>user</code> table.  The server sorts the <code>db</code>
table based on the <code>Host</code>, <code>Db</code>, and <code>User</code> scope columns,
and sorts the <code>host</code> table based on the <code>Host</code> and <code>Db</code>
scope columns.  As with the <code>user</code> table, sorting puts the
most-specific values first and least-specific values last, and when the
server looks for matching entries, it uses the first match that it finds.

</P>
<P>
<A NAME="IDX544"></A>
<A NAME="IDX545"></A>

</P>
<P>
The <code>tables_priv</code> and <code>columns_priv</code> tables grant table-specific and
column-specific privileges.  Values in the scope columns of these tables can
take the following form:

</P>

<UL>
<LI>

The wildcard characters <samp>`%'</samp> and <samp>`_'</samp> can be used in the <code>Host</code>
column of either table.  These have the same meaning as for pattern-matching
operations performed with the <code>LIKE</code> operator.

<LI>

A <code>'%'</code> or blank <code>Host</code> value in either table means ``any host.''

<LI>

The <code>Db</code>, <code>Table_name</code>, and <code>Column_name</code> columns cannot contain
wildcards or be blank in either table.
</UL>

<P>
The server sorts the <code>tables_priv</code> and <code>columns_priv</code> tables based
on the <code>Host</code>, <code>Db</code>, and <code>User</code> columns.  This is similar to
<code>db</code> table sorting, but simpler because only the <code>Host</code> column can
contain wildcards.

</P>
<P>
The request verification process is described here.  (If you are familiar
with the access-checking source code, you will notice that the description
here differs slightly from the algorithm used in the code.  The description
is equivalent to what the code actually does; it differs only to make the
explanation simpler.)

</P>
<P>
For requests that require administrative privileges such as <code>SHUTDOWN</code> or
<code>RELOAD</code>, the
server checks only the <code>user</code> table entry because that is the only table
that specifies administrative privileges.  Access is granted if the entry
allows the requested operation and denied otherwise.  For example, if you
want to execute <code>mysqladmin shutdown</code> but your <code>user</code> table entry
doesn't grant the <code>SHUTDOWN</code> privilege to you, the server denies access
without even checking the <code>db</code> or <code>host</code> tables.  (They
contain no <code>Shutdown_priv</code> column, so there is no need to do so.)

</P>
<P>
For database-related requests (<code>INSERT</code>, <code>UPDATE</code>, and so on), the
server first checks the user's global (superuser) privileges by looking in
the <code>user</code> table entry.  If the entry allows the requested operation,
access is granted.  If the global privileges in the <code>user</code> table are
insufficient, the server determines the user's database-specific privileges
by checking the <code>db</code> and <code>host</code> tables:

</P>

<OL>
<LI>

The server looks in the <code>db</code> table for a match on the <code>Host</code>,
<code>Db</code>, and <code>User</code> columns.  The <code>Host</code> and <code>User</code> columns are
matched to the connecting user's hostname and MySQL username.  The
<code>Db</code> column is matched to the database that the user wants to access.  If
there is no entry for the <code>Host</code> and <code>User</code>, access is denied.

<LI>

If there is a matching <code>db</code> table entry and its <code>Host</code> column is
not blank, that entry defines the user's database-specific privileges.

<LI>

If the matching <code>db</code> table entry's <code>Host</code> column is blank, it
signifies that the <code>host</code> table enumerates which hosts should be allowed
access to the database.  In this case, a further lookup is done in the
<code>host</code> table to find a match on the <code>Host</code> and <code>Db</code> columns.
If no <code>host</code> table entry matches, access is denied.  If there is a
match, the user's database-specific privileges are computed as the
intersection (<em>not</em> the union!) of the privileges in the <code>db</code> and
<code>host</code> table entries; that is, the privileges that are <code>'Y'</code> in both
entries.  (This way you can grant general privileges in the <code>db</code> table
entry and then selectively restrict them on a host-by-host basis using the
<code>host</code> table entries.)
</OL>

<P>
After determining the database-specific privileges granted by the <code>db</code>
and <code>host</code> table entries, the server adds them to the global privileges
granted by the <code>user</code> table.  If the result allows the requested
operation, access is granted.  Otherwise, the server successively
checks the user's table and column privileges in the <code>tables_priv</code>
and <code>columns_priv</code> tables, adds those to the user's privileges,
and allows or denies access based on the result.

</P>
<P>
Expressed in boolean terms, the preceding description of how a user's
privileges are calculated may be summarized like this:

</P>

<PRE>
global privileges
OR (database privileges AND host privileges)
OR table privileges
OR column privileges
</PRE>

<P>
It may not be apparent why, if the global <code>user</code> entry privileges are
initially found to be insufficient for the requested operation, the server
adds those privileges to the database, table, and column privileges
later. The reason is that a request might require more than one type of
privilege.  For example, if you execute an <code>INSERT INTO ...  SELECT</code>
statement, you need both the <code>INSERT</code> and the <code>SELECT</code> privileges.
Your privileges might be such that the <code>user</code> table entry grants one
privilege and the <code>db</code> table entry grants the other.  In this case, you
have the necessary privileges to perform the request, but the server cannot
tell that from either table by itself; the privileges granted by the entries
in both tables must be combined.

</P>
<P>
<A NAME="IDX546"></A>
<A NAME="IDX547"></A>

</P>
<P>
The <code>host</code> table is not affected by the <code>GRANT</code> or <code>REVOKE</code>
statements, so it is unused in most MySQL installations. If you modify
it directly, you can use it for some specialized purposes, such as to
maintain a list of secure servers.  For example, at TcX, the <code>host</code>
table contains a list of all machines on the local network. These are
granted all privileges.

</P>
<P>
You can also use the <code>host</code> table to indicate hosts that are <em>not</em>
secure.  Suppose that you have a machine <code>public.your.domain</code> that is located
in a public area that you do not consider secure.  You can allow access to
all hosts on your network except that machine by using <code>host</code> table
entries
like this:

</P>

<PRE>
+--------------------+----+-
| Host               | Db | ...
+--------------------+----+-
| public.your.domain | %  | ... (all privileges set to 'N')
| %.your.domain      | %  | ... (all privileges set to 'Y')
+--------------------+----+-
</PRE>

<P>
<A NAME="IDX548"></A>
<A NAME="IDX549"></A>
<A NAME="IDX550"></A>
<A NAME="IDX551"></A>

</P>
<P>
Naturally, you should always test your entries in the grant tables (for
example, by using <code>SHOW GRANTS</code> or
<code>mysqlaccess</code>) to make sure that your access privileges are
actually set up the way you think they are.

</P>



<H3><A NAME="Privilege_changes" HREF="manual_toc.html#Privilege_changes">5.5.7  When Privilege Changes Take Effect</A></H3>

<P>
When <code>mysqld</code> starts, all grant table contents are read into memory and
become effective for access control at that point.

</P>
<P>
When the server reloads the grant tables, privileges for
existing client connections are affected as follows:

</P>

<UL>
<LI>

Table and column privilege changes take effect with the client's next
request.

<LI>

Database privilege changes take effect at the next <code>USE <var>db_name</var></code>
statement.

<LI>

Changes to global privileges and passwords take effect the next time
the client connects.
</UL>

<P>
If you modify the grant tables using <code>GRANT</code>, <code>REVOKE</code>, or
<code>SET PASSWORD</code>, the server notices these changes and reloads the
grant tables into memory again immediately.

</P>
<P>
If you modify the grant tables directly using statements such as
<code>INSERT</code>, <code>UPDATE</code>, or <code>DELETE</code>, your changes have
no effect on privilege checking until you either restart the server
or tell it to reload the tables.  To reload the grant tables manually,
issue a <code>FLUSH PRIVILEGES</code> statement or execute a <code>mysqladmin
flush-privileges</code> or <code>mysqladmin reload</code> command.

</P>
<P>
If you change the grant tables directly but forget to reload them, your
changes will have <em>no effect</em> until you restart the server.  This may
leave you wondering why your changes don't seem to make any difference!

</P>



<H3><A NAME="Access_denied" HREF="manual_toc.html#Access_denied">5.5.8  Causes of <code>Access denied</code> Errors</A></H3>

<P>
If you encounter problems when you try to connect to the
MySQL server, the following items describe some courses of
action you can take to correct the problem.

</P>

<UL>
<LI>

Make sure that the server is running. If it is not running, you cannot connect to it.
For example, if you attempt to connect to the server and see a message such
as one of those following, one cause might be that the server is not running:


<PRE>
shell&#62; mysql
ERROR 2003: Can't connect to MySQL server on '<var>host_name</var>' (111)
shell&#62; mysql
ERROR 2002: Can't connect to local MySQL server through socket
'/tmp/mysql.sock' (111)
</PRE>

It might also be that the server is running, but you are trying to connect
using a TCP/IP port, named pipe, or Unix socket file different from those
on which the server is listening. To correct this when you invoke a client
program, specify a <code>--port</code> option to indicate the proper port, or a
<code>--socket</code> option to indicate the proper named pipe or Unix socket
file.
To find out what port is used, and where the socket is, you can do:


<PRE>
shell&#62; netstat -l | grep mysql
</PRE>

<LI>

The grant tables must be properly set up so that the server can use them for
access control.  For some distribution types (such as binary distributions
on Windows on RPM distributions on Linux), the installation process
initializes the <code>mysql</code> database containing the grant tables.  For
distributions that do not do this, you should initialize the grant tables
manually by running the <code>mysql_install_db</code> script.  For details, see
section <A HREF="manual_Installing.html#Unix_post-installation">2.9.2  Unix Post-Installation Procedures</A>.

One way to determine whether you need to initialize the grant tables is to
look for a <tt>`mysql'</tt> directory under the data directory. (The data
directory normally is named <tt>`data'</tt> or <tt>`var'</tt> and is located under
your MySQL installation directory.)  Make sure that you have a file named
<tt>`user.MYD'</tt> in the <tt>`mysql'</tt> database directory.  If you do not,
execute the <code>mysql_install_db</code> script.  After running this script and
starting the server, test the initial privileges by executing this command:


<PRE>
shell&#62; mysql -u root test
</PRE>

The server should let you connect without error.

<LI>

After a fresh installation, you should connect to the server and set up
your users and their access permissions:


<PRE>
shell&#62; mysql -u root mysql
</PRE>

The server should let you connect because the MySQL <code>root</code> user
has no password initially.  That is also a security risk, so setting the
password for the
<code>root</code> accounts is something you should do while you're setting up
your other MySQL users.
For instructions on setting the initial passwords, see section <A HREF="manual_Installing.html#Default_privileges">2.9.3  Securing the Initial MySQL Accounts</A>.

<LI>

<A NAME="IDX552"></A>
If you have updated an existing MySQL installation to a newer version, did
you run the <code>mysql_fix_privilege_tables</code> script?  If not, do so. The
structure of the grant tables changes occasionally when new capabilities are
added, so after an upgrade you should always make sure that your tables have
the current structure. For instructions, see section <A HREF="manual_Installing.html#Upgrading-grant-tables">2.10.7  Upgrading the Grant Tables</A>.

<LI>

If a client program receives the following error message when it tries
to connect, it means that the server expects passwords in a newer format
than the client is capable of generating:


<PRE>
shell&#62; mysql
Client does not support authentication protocol requested
by server; consider upgrading MySQL client
</PRE>

For information on how to deal with this, see section <A HREF="manual_MySQL_Database_Administration.html#Password_hashing">5.5.9  Password Hashing in MySQL 4.1</A> and
section <A HREF="manual_Problems.html#Old_client">A.2.3  <code>Client does not support authentication protocol</code></A>.

<LI>

If you try to connect as <code>root</code> and get the following error,
it means that you don't have an entry in the <code>user</code> table with a
<code>User</code> column value of <code>'root'</code> and that <code>mysqld</code> cannot
resolve the hostname for your client:


<PRE>
Access denied for user ''@'unknown' to database mysql
</PRE>

In this case, you must restart the server with the <code>--skip-grant-tables</code>
option and edit your <tt>`/etc/hosts'</tt> or <tt>`\windows\hosts'</tt> file to
add an entry for your host.

<LI>

<A NAME="IDX553"></A>
<A NAME="IDX554"></A>
<A NAME="IDX555"></A>
<A NAME="IDX556"></A>
Remember that client programs will use connection parameters specified
in option files or environment variables.  If a client program seems to
be sending incorrect default connection parameters when you don't specify
them on the command line, check your environment and any applicable option
files. For example, if you get <code>Access denied</code> when you run a client
without any options, make sure that you haven't specified an old password in
any of your option files!

You can suppress the use of option files by a client program by invoking it
with the <code>--no-defaults</code> option. For example:


<PRE>
shell&#62; mysqladmin --no-defaults -u root version
</PRE>

The option files that clients use are listed in section <A HREF="manual_Using_MySQL_Programs.html#Option_files">4.3.2  Using Option Files</A>.
Environment variables are listed in section <A HREF="manual_Environment_variables.html#Environment_variables">F  Environment Variables</A>.

<LI>

If you get the following error, it means that you are using an incorrect
<code>root</code> password:


<PRE>
shell&#62; mysqladmin -u root -p<var>xxxx</var> ver
Access denied for user 'root'@'localhost' (using password: YES)
</PRE>

If the preceding error occurs even when you haven't specified a password,
it means that you have an incorrect password listed in some option
file. Try the <code>--no-defaults</code> option as described in the previous item.

For information on changing passwords, see section <A HREF="manual_MySQL_Database_Administration.html#Passwords">5.6.5  Assigning Account Passwords</A>.

If you have lost or forgotten the <code>root</code> password, you can restart
<code>mysqld</code> with <code>--skip-grant-tables</code> to change the password.
See section <A HREF="manual_Problems.html#Resetting_permissions">A.4.1  How to Reset the Root Password</A>.

<LI>

If you change a password by using <code>SET PASSWORD</code>, <code>INSERT</code>, or
<code>UPDATE</code>, you must encrypt the password using the <code>PASSWORD()</code>
function.  If you do not use <code>PASSWORD()</code> for these statements,
the password will not work. For example, the following statement sets a
password, but fails to encrypt it, so the user will not be able to connect
afterward:


<PRE>
mysql&#62; SET PASSWORD FOR 'abe'@'<var>host_name</var>' = 'eagle';
</PRE>

Instead, set the password like this:


<PRE>
mysql&#62; SET PASSWORD FOR 'abe'@'<var>host_name</var>' = PASSWORD('eagle');
</PRE>

The <code>PASSWORD()</code> function is unnecessary when you specify a password
using the <code>GRANT</code> statement or the <code>mysqladmin password</code> command,
both of which automatically use <code>PASSWORD()</code> to encrypt the password.
See section <A HREF="manual_MySQL_Database_Administration.html#Passwords">5.6.5  Assigning Account Passwords</A>.

<LI>

<code>localhost</code> is a synonym for your local hostname, and is also the
default host to which clients try to connect if you specify no host
explicitly.  However, connections to <code>localhost</code> on Unix systems
do not work if you are using a MySQL version older than 3.23.27 that uses
MIT-pthreads: <code>localhost</code> connections are made using Unix socket files,
which were not supported by MIT-pthreads at that time.

To avoid this problem on such systems, you can use a <code>--host=127.0.0.1</code>
option to name the server host explicitly.  This will make a TCP/IP
connection to the local <code>mysqld</code> server. You can also use TCP/IP by
specifying a <code>--host</code> option that uses the actual hostname of the
local host.  In this case, the hostname must be specified in a <code>user</code>
table entry on the server host, even though you are running the client
program on the same host as the server.

<LI>

If you get an <code>Access denied</code> error when trying to connect to the
database with <code>mysql -u user_name</code>, you may have a problem
with the <code>user</code> table. Check this by executing <code>mysql -u root
mysql</code> and issuing this SQL statement:


<PRE>
mysql&#62; SELECT * FROM user;
</PRE>

The result should include an entry with the <code>Host</code> and <code>User</code>
columns matching your computer's hostname and your MySQL username.

<LI>

The <code>Access denied</code> error message will tell you who you are trying
to log in as, the client host from which you are trying to connect, and whether
or not you were using a password. Normally, you should have one entry in
the <code>user</code> table that exactly matches the hostname and username
that were given in the error message. For example, if you get an error
message that contains <code>using password: NO</code>, it means that you
tried to log in without an password.

<LI>

If the following error occurs when you try to connect from a host other than
the one on which the MySQL server is running, it means that there is no row
in the <code>user</code> table with a <code>Host</code> value that matches the client
host:


<PRE>
Host ... is not allowed to connect to this MySQL server
</PRE>

You can fix this by setting up an account for the combination of client
hostname and username that you are using when trying to connect.

If you don't know the IP number
or hostname of the machine from which you are connecting, you should put
an entry with <code>'%'</code> as the <code>Host</code> column value in the <code>user</code>
table and restart <code>mysqld</code> with the <code>--log</code> option on the server
machine.  After trying to connect from the client machine, the information
in the MySQL log will indicate how you really did connect.  (Then change
the <code>'%'</code> in the <code>user</code> table entry to the actual hostname
that shows up in the log.  Otherwise, you'll have a system that is insecure
because it allows connections from any host for the given username.)

On Linux, another reason that this error might occur is that you are using
a binary MySQL version that is compiled with a different version of the
<code>glibc</code> library than the one you are using.  In this case, you should
either upgrade your operating system or <code>glibc</code>, or download a source
distribution of MySQL version and compile it yourself.  A source RPM is
normally trivial to compile and install, so this isn't a big problem.

<LI>

If you specify a hostname when trying to connect, but get an error message
where the hostname is not shown or is an IP number,
it means that the MySQL server got an error when trying to resolve the
IP number of the client host to a name:


<PRE>
shell&#62; mysqladmin -u root -p<var>xxxx</var> -h <var>some-hostname</var> ver
Access denied for user 'root'@'' (using password: YES)
</PRE>

This indicates a DNS problem.  To fix it, execute <code>mysqladmin
flush-hosts</code> to reset the internal DNS hostname cache. See section <A HREF="manual_MySQL_Optimization.html#DNS">7.5.6  How MySQL Uses DNS</A>.

Some permanent solutions are:


<UL>
<LI>

Try to find out what is wrong with your DNS server and fix it.

<LI>

Specify IP numbers rather than hostnames in the MySQL grant tables.

<LI>

Put an entry for the client machine name in <code>/etc/hosts</code>.

<LI>

Start <code>mysqld</code> with the <code>--skip-name-resolve</code> option.

<LI>

Start <code>mysqld</code> with the <code>--skip-host-cache</code> option.

<LI>

On Unix, if you are running the server and the client on the same machine,
connect to <code>localhost</code>. Unix connections to <code>localhost</code> use a Unix
socket file rather than TCP/IP.

<LI>

On Windows, if you are running the server and the client on the same machine
and the server supports named pipe connections, connect to the hostname
<code>.</code> (period). Connections to <code>.</code> use a named pipe rather than
TCP/IP.
</UL>

<LI>

If <code>mysql -u root test</code> works but <code>mysql -h <var>your_hostname</var> -u root
test</code> results in <code>Access denied</code> (where <var>your_hostname</var> is the
actual hostname of the local host), you may not have the correct name
for your host in the <code>user</code> table.  A common problem here is that the
<code>Host</code> value in the user table entry specifies an unqualified hostname,
but your system's name resolution routines return a fully qualified domain
name (or vice versa).  For example, if you have an entry with host
<code>'tcx'</code> in the <code>user</code> table, but your DNS tells MySQL that
your hostname is <code>'tcx.subnet.se'</code>, the entry will not work. Try adding
an entry to the <code>user</code> table that contains the IP number of your host as
the <code>Host</code> column value.  (Alternatively, you could add an entry to the
<code>user</code> table with a <code>Host</code> value that contains a wildcard; for
example, <code>'tcx.%'</code>.  However, use of hostnames ending with <samp>`%'</samp> is
<em>insecure</em> and is <em>not</em> recommended!)

<LI>

If <code>mysql -u <var>user_name</var> test</code> works but <code>mysql -u <var>user_name</var>
<var>other_db_name</var></code> does not, you have not granted database access for
<var>other_db_name</var> to the given user.

<LI>

If <code>mysql -u <var>user_name</var></code> works when executed on the server host, but
<code>mysql -h <var>host_name</var> -u <var>user_name</var></code> doesn't work when executed on a
remote client host, you have not enabled access to the server for the given
username from the remote host.

<LI>

If you can't figure out why you get <code>Access denied</code>, remove from the
<code>user</code> table all entries that have <code>Host</code> values containing
wildcards (entries that contain <samp>`%'</samp> or <samp>`_'</samp>).  A very common error
is to insert a new entry with <code>Host</code>=<code>'%'</code> and
<code>User</code>=<code>'<var>some_user</var>'</code>, thinking that this will allow you to specify
<code>localhost</code> to connect from the same machine.  The reason that this
doesn't work is that the default privileges include an entry with
<code>Host</code>=<code>'localhost'</code> and <code>User</code>=<code>''</code>.  Because that entry
has a <code>Host</code> value <code>'localhost'</code> that is more specific than
<code>'%'</code>, it is used in preference to the new entry when connecting from
<code>localhost</code>!  The correct procedure is to insert a second entry with
<code>Host</code>=<code>'localhost'</code> and <code>User</code>=<code>'<var>some_user</var>'</code>, or to
delete the entry with <code>Host</code>=<code>'localhost'</code> and
<code>User</code>=<code>''</code>.
After deleting the entry, remember to issue a <code>FLUSH PRIVILEGES</code>
statement to reload the grant tables.

<LI>

If you get the following error, you may have a problem with the <code>db</code> or
<code>host</code> table:


<PRE>
Access to database denied
</PRE>

If the entry selected from the <code>db</code> table has an empty value in the
<code>Host</code> column, make sure that there are one or more corresponding entries in
the <code>host</code> table specifying which hosts the <code>db</code> table entry
applies to.

<LI>

If you are able to connect to the MySQL server, but get an <code>Access
denied</code> message whenever you issue a <code>SELECT ...  INTO OUTFILE</code> or
<code>LOAD DATA INFILE</code> statement, your entry in the <code>user</code> table
doesn't have the <code>FILE</code> privilege enabled.

<LI>

If you change the grant tables directly (for example, by using <code>INSERT</code>,
<code>UPDATE</code>, or <code>DELETE</code> statements) and your changes seem to be
ignored, remember that you must execute a <code>FLUSH PRIVILEGES</code> statement
or a <code>mysqladmin flush-privileges</code> command to cause the server
to re-read the privilege tables. Otherwise, your changes have no effect
until the next time the server is restarted.  Remember that after you change
the <code>root</code> password with an <code>UPDATE</code> command, you won't need
to specify the new password until after you flush the privileges, because
the server won't know you've changed the password yet!

<LI>

If your privileges seem to have changed in the middle of a session, it may
be that a MySQL administrator has changed them.  Reloading the grant tables
affects new client connections, but it also affects existing connections
as indicated in section <A HREF="manual_MySQL_Database_Administration.html#Privilege_changes">5.5.7  When Privilege Changes Take Effect</A>.

<LI>

If you have access problems with a Perl, PHP, Python, or ODBC program, try to
connect to the server with <code>mysql -u <var>user_name</var> <var>db_name</var></code> or <code>mysql
-u <var>user_name</var> -p<var>your_pass</var> <var>db_name</var></code>.  If you are able to connect using the
<code>mysql</code> client, the problem lies with your program, not with the
access privileges.  (There is no space between <code>-p</code> and the
password; you can also use the <code>--password=<var>your_pass</var></code> syntax to specify
the password. If you use the <code>-p</code> option alone, MySQL will
prompt you for the password.)

<LI>

For testing, start the <code>mysqld</code> server with the
<code>--skip-grant-tables</code> option.  Then you can change the MySQL
grant tables and use the <code>mysqlaccess</code> script to check whether
your modifications have the desired effect.  When you are satisfied with your
changes, execute <code>mysqladmin flush-privileges</code> to tell the <code>mysqld</code>
server to start using the new grant tables.  (Reloading the
grant tables overrides the <code>--skip-grant-tables</code> option.  This allows
you to tell the server to begin using the grant tables again without stopping
and restarting it.)

<LI>

If everything else fails, start the <code>mysqld</code> server with a debugging
option (for example, <code>--debug=d,general,query</code>). This will print host and
user information about attempted connections, as well as information about
each command issued. See section <A HREF="manual_Porting.html#Making_trace_files">E.1.2  Creating Trace Files</A>.

<LI>

If you have any other problems with the MySQL grant tables and
feel you must post the problem to the mailing list, always provide a
dump of the MySQL grant tables. You can dump the tables with
the <code>mysqldump mysql</code> command. As always, post your problem using
the <code>mysqlbug</code> script.  See section <A HREF="manual_Introduction.html#Bug_reports">1.4.1.3  How to Report Bugs or Problems</A>.  In some cases, you may need
to restart <code>mysqld</code> with <code>--skip-grant-tables</code> to run
<code>mysqldump</code>.

</UL>



<H3><A NAME="Password_hashing" HREF="manual_toc.html#Password_hashing">5.5.9  Password Hashing in MySQL 4.1</A></H3>

<P>
MySQL user accounts are listed in the <code>user</code> table of the <code>mysql</code>
database. Each MySQL account is assigned a password, although
what is stored in the <code>Password</code> column of the <code>user</code> table is not the
plaintext version of the password, but a hash value computed from
it.  Password hash values are computed by the <code>PASSWORD()</code> function.

</P>
<P>
MySQL uses passwords in two phases of client/server communication:

</P>

<UL>

<LI>

When a client attempts to connect to the server, there is an initial
authentication step in which the client must present a password that has
a hash value matching the hash value stored in the <code>user</code> table for
the account that the client wants to use.

<LI>

After the client connects, it can (if it has sufficient privileges) set or
change the password hashes for accounts listed in the <code>user</code> table.
The client can do this by using the <code>PASSWORD()</code> function to generate a
password hash, or by using the <code>GRANT</code> or <code>SET PASSWORD</code>
statements.

</UL>

<P>
In other words, the server <em>uses</em> hash values during authentication when
a client first attempts to connect. The server <em>generates</em> hash values
if a connected client invokes the <code>PASSWORD()</code> function or uses a
<code>GRANT</code>
or <code>SET PASSWORD</code> statement to set or change a password.

</P>
<P>
The password hashing mechanism was updated in MySQL 4.1 to provide
better security and to reduce the risk of passwords being intercepted.
However, this new mechanism is understood only by the 4.1 server and
4.1 clients, which can result in some compatibility problems.
A 4.1 client can connect to a pre-4.1 server, because the client
understands both the old and new password hashing mechanisms. However,
a pre-4.1 client that attempts to connect to a 4.1 server may run into
difficulties.  For example, a 4.0 <code>mysql</code> client that attempts to connect
to a 4.1 server may fail with the following error message:

</P>

<PRE>
shell&#62; mysql -h localhost -u root
Client does not support authentication protocol requested
by server; consider upgrading MySQL client
</PRE>

<P>
The following discussion describes the differences between the old and
new password mechanisms, and what you should do if you upgrade your
server to 4.1 but need to maintain backward compatibility with pre-4.1
clients. Additional information can be found in section <A HREF="manual_Problems.html#Old_client">A.2.3  <code>Client does not support authentication protocol</code></A>.

</P>
<P>
<strong>Note</strong>: This discussion contrasts 4.1 behavior with pre-4.1 behavior,
but the 4.1 behavior described here actually begins with 4.1.1. MySQL
4.1.0 is an ``odd'' release because it has a slightly different mechanism
than that implemented in 4.1.1 and up.  Differences between 4.1.0 and
more recent versions are described further in section <A HREF="manual_MySQL_Database_Administration.html#Password_hashing_4.1.0">5.5.9.2  Password Hashing in MySQL 4.1.0</A>.

</P>
<P>
Prior to MySQL 4.1, password hashes computed by the <code>PASSWORD()</code> function
are 16 bytes long.  Such hashes look like this:

</P>

<PRE>
mysql&#62; SELECT PASSWORD('mypass');
+--------------------+
| PASSWORD('mypass') |
+--------------------+
| 6f8c114b58f2ce9e   |
+--------------------+
</PRE>

<P>
The <code>Password</code> column of the <code>user</code> table (in which these hashes are stored)
also is 16 bytes long before MySQL 4.1.

</P>
<P>
As of MySQL 4.1, the <code>PASSWORD()</code> function has been modified to produce
a longer 41-byte hash value:

</P>

<PRE>
mysql&#62; SELECT PASSWORD('mypass');
+-----------------------------------------------+
| PASSWORD('mypass')                            |
+-----------------------------------------------+
| *43c8aa34cdc98eddd3de1fe9a9c2c2a9f92bb2098d75 |
+-----------------------------------------------+
</PRE>

<P>
Accordingly, the <code>Password</code> column in the <code>user</code> table also must be 41
bytes long to store these values:

</P>

<UL>
<LI>

If you perform a new installation of MySQL 4.1, the <code>Password</code> column
will be made 41 bytes long automatically.

<LI>

If you upgrade an older installation to 4.1, you should run the
<code>mysql_fix_privilege_tables</code> script to increase the length of the
<code>Password</code>
column from 16 to 41 bytes. (The script does not change existing
password values, which remain 16 bytes long.)

</UL>

<P>
A widened <code>Password</code> column can store password hashes in both the old and
new formats. The format of any given password hash value can be
determined two ways:

</P>

<UL>
<LI>

The obvious difference is the length (16 bytes versus 41 bytes).

<LI>

A second difference is that password hashes in the new format always
begin with a <samp>`*'</samp> character, whereas passwords in the old format never do.

</UL>

<P>
The longer password hash format has better cryptographic properties, and
client authentication based on long hashes is more secure than that
based on the older short hashes.

</P>
<P>
The differences between short and long password hashes are relevant
both for how the server uses passwords during authentication and for
how it generates password hashes for connected clients that perform
password-changing operations.

</P>
<P>
The way in which the server uses password hashes during authentication
is affected by the width of the <code>Password</code> column:

</P>

<UL>

<LI>

If the column is short, only short-hash authentication is used.

<LI>

If the column is long, it can hold either short or long hashes, and
the server can use either format:


<UL>

<LI>

Pre-4.1 clients can connect, although because they know only about
the old hashing mechanism, they can authenticate only for accounts that
have short hashes.

<LI>

4.1 clients can authenticate for accounts that have short or long hashes.

</UL>

</UL>

<P>
For short-hash accounts, the authentication process is actually a bit
more secure for 4.1 clients than for older clients.  In terms of security,
the gradient from least to most secure is:

</P>

<UL>

<LI>

Pre-4.1 client authenticating for account with short password hash

<LI>

4.1 client authenticating for account with short password hash

<LI>

4.1 client authenticating for account with long password hash

</UL>

<P>
The way in which the server generates password hashes for connected
clients is affected by the width of the <code>Password</code> column and by the
<code>--old-passwords</code> option.  A 4.1 server generates long hashes only if certain
conditions are met:
The <code>Password</code> column must be wide enough to hold long
values and the <code>--old-passwords</code> option must not be given.
These conditions apply as follows:

</P>

<UL>

<LI>

The <code>Password</code> column must be wide enough to hold long hashes (41 bytes).
If the column has not been updated and still has the pre-4.1 width of
16 bytes, the server notices that long hashes cannot fit into it and
generates only short hashes when a client performs password-changing
operations using <code>PASSWORD()</code>, <code>GRANT</code>, or <code>SET PASSWORD</code>.
This is the behavior that
occurs if you have upgraded to 4.1 but have not yet run the
<code>mysql_fix_privilege_tables</code> script to widen the <code>Password</code> column.

<LI>

If the <code>Password</code> column is wide, it can store either short or long
password hashes. In this case, <code>PASSWORD()</code>, <code>GRANT</code>, and <code>SET PASSWORD</code>
generate long hashes unless the server was started with the
<code>--old-passwords</code> option. That option forces the server to generate
short password hashes instead.

</UL>

<P>
The purpose of the <code>--old-passwords</code> option is to allow you to maintain
backward compatibility with pre-4.1 clients under circumstances where
the server would otherwise generate long password hashes. The option doesn't
affect authentication (4.1 clients can still use accounts that have
long password hashes), but it does prevent creation of a long
password hash in the <code>user</code> table as the result of a password-changing
operation. Were that to occur, the account no longer could be used
by pre-4.1 clients. Without the <code>--old-passwords</code> option, the following
undesirable scenario is possible:

</P>

<UL>

<LI>

An old client connects to an account that has a short password hash.

<LI>

The client changes its own password. Without <code>--old-passwords</code>,
this results in the account having a long password hash.

<LI>

The next time the old client attempts to connect to the account, it cannot,
because the account now has a long password hash that requires the new
hashing mechanism during authentication. (Once an account has a long
password hash in the user table, only 4.1 clients can authenticate for it,
because pre-4.1 clients do not understand long hashes.)

</UL>

<P>
This scenario illustrates that, if you must support older pre-4.1 clients,
it is dangerous to run a 4.1 server without using the <code>--old-passwords</code>
option.  By running the server with <code>--old-passwords</code>, password-changing
operations will not generate long password hashes and thus do not cause
accounts to become inaccessible to older clients. (Those clients cannot
inadvertently lock themselves out by changing their password and ending
up with a long password hash.)

</P>
<P>
The downside of the <code>--old-passwords</code> option is that any passwords you
create or change will use short hashes, even for 4.1 clients. Thus, you
lose the additional security provided by long password hashes. If you want
to create an account that has a long hash (for example, for use by 4.1
clients), you must do so while running the server without
<code>--old-passwords</code>.

</P>
<P>
The following scenarios are possible for running a 4.1 server:

</P>
<P>
<strong>Scenario 1:</strong> Short <code>Password</code> column in user table:

</P>

<UL>

<LI>

Only short hashes can be stored in the <code>Password</code> column.

<LI>

The server uses only short hashes during client authentication.

<LI>

For connected clients, password hash-generating operations
involving <code>PASSWORD()</code>, <code>GRANT</code>, or <code>SET PASSWORD</code> use short hashes
exclusively.  Any change to an account's password results in
that account having a short password hash.

<LI>

The <code>--old-passwords</code> option can be used but is superfluous because
with a short <code>Password</code> column, the server will generate only short
password hashes anyway.

</UL>

<P>
<strong>Scenario 2:</strong> Long <code>Password</code> column; server not started with
<code>--old-passwords</code> option:

</P>

<UL>

<LI>

Short or long hashes can be stored in the <code>Password</code> column.

<LI>

4.1 clients can authenticate for accounts that have short or long
hashes.

<LI>

Pre-4.1 clients can authenticate only for accounts that have short
hashes.

<LI>

For connected clients, password hash-generating operations involving
<code>PASSWORD()</code>, <code>GRANT</code>, or <code>SET PASSWORD</code> use long hashes
exclusively.  A change to an account's password results in that account
having a long password hash.

</UL>

<P>
As indicated earlier, a danger in this scenario is that it is possible for
accounts that have a short password hash to become inaccessible to pre-4.1
clients. A change to such an account's password made via <code>GRANT</code>,
<code>PASSWORD()</code>, or <code>SET PASSWORD</code> results in the account being
given a long password hash. From that point on, no pre-4.1 client can
authenticate to that account until the client upgrades to 4.1.

</P>
<P>
To deal with this problem, you can change a password in a special way.
For example, normally you use <code>SET PASSWORD</code> as follows to change
an account password:

</P>

<PRE>
mysql&#62; SET PASSWORD FOR '<var>some_user</var>'@'<var>some_host</var>' = PASSWORD('mypass');
</PRE>

<P>
To change the password but create a short hash, use the
<code>OLD_PASSWORD()</code> function instead:

</P>

<PRE>
mysql&#62; SET PASSWORD FOR '<var>some_user</var>'@'<var>some_host</var>' = OLD_PASSWORD('mypass');
</PRE>

<P>
<code>OLD_PASSWORD()</code> is useful for situations in which you explicitly want
to generate a short hash.

</P>
<P>
<strong>Scenario 3:</strong> Long <code>Password</code> column; server started with
<code>--old-passwords</code> option:

</P>

<UL>

<LI>

Short or long hashes can be stored in the <code>Password</code> column.

<LI>

4.1 clients can authenticate for accounts that have short or long
hashes (but note that it is possible to create long hashes only when
the server is started without <code>--old-passwords</code>).

<LI>

Pre-4.1 clients can authenticate only for accounts that have short
hashes.

<LI>

For connected clients, password hash-generating operations
involving <code>PASSWORD()</code>, <code>GRANT</code>, or <code>SET PASSWORD</code> use short hashes
exclusively.  Any change to an account's password results in that
account having a short password hash.

</UL>

<P>
In this scenario, you cannot create accounts that have long password
hashes, because the <code>--old-passwords</code> option prevents generation of long hashes.  Also,
if you create an account with a long hash before using the
<code>--old-passwords</code>
option, changing the account's password while <code>--old-passwords</code> is in
effect results in the account being given a short password, causing it
to lose the security benefits of a longer hash.

</P>
<P>
The disadvantages for these scenarios may be summarized as follows:

</P>
<P>
In scenario 1, you cannot take advantage of longer hashes that provide more
secure authentication.

</P>
<P>
In scenario 2, accounts with short hashes become inaccessible to pre-4.1
clients if you change their passwords without explicitly using
<code>OLD_PASSWORD()</code>.

</P>
<P>
In scenario 3, <code>--old-passwords</code> prevents accounts with short hashes from
becoming inaccessible, but password-changing operations cause accounts
with long hashes to revert to short hashes, and you cannot change them
back to long hashes while <code>--old-passwords</code> is in effect.

</P>



<H4><A NAME="Application_password_use" HREF="manual_toc.html#Application_password_use">5.5.9.1  Implications of Password Hashing Changes for Application Programs</A></H4>

<P>
An upgrade to MySQL 4.1 can cause a compatibility issue for
applications that use <code>PASSWORD()</code> to generate passwords for their own
purposes. Applications really should not do this, because <code>PASSWORD()</code>
should be used only to manage passwords for MySQL accounts. But some
applications use <code>PASSWORD()</code> for their own purposes anyway.

</P>
<P>
If you upgrade to 4.1 and run the server under conditions where it
generates long password hashes, an application that uses <code>PASSWORD()</code>
for its own passwords will break.  The recommended course of action is
to modify the application to use another function, such as <code>SHA1()</code>
or <code>MD5()</code>, to produce hashed values.  If that is not possible, you
can use the <code>OLD_PASSWORD()</code> function, which is provided to generate
short hashes in the old format. But note that <code>OLD_PASSWORD()</code> may
one day no longer be supported.

</P>
<P>
If the server is running under circumstances where it generates short hashes,
<code>OLD_PASSWORD()</code> is available but is equivalent to <code>PASSWORD()</code>.

</P>


<H4><A NAME="Password_hashing_4.1.0" HREF="manual_toc.html#Password_hashing_4.1.0">5.5.9.2  Password Hashing in MySQL 4.1.0</A></H4>

<P>
Password hashing in MySQL 4.1.0 differs from hashing in 4.1.1 and up.
The 4.1.0 differences are:

</P>

<UL>

<LI>

Password hashes are 45 bytes long rather than 41 bytes.

<LI>

The <code>PASSWORD()</code> function is non-repeatable.  That is, with a given
argument <var>X</var>, successive calls to <code>PASSWORD(<var>X</var>)</code> generate different
results.

</UL>

<P>
These differences make authentication in 4.1.0 incompatible with that of
releases that follow it.  If you have upgraded to MySQL 4.1.0, it is
recommended that you upgrade to a newer version as soon as possible. After
you do, reassign any long passwords in the <code>user</code> table so that they are
compatible with the 41-byte format.

</P>



<H2><A NAME="User_Account_Management" HREF="manual_toc.html#User_Account_Management">5.6  MySQL User Account Management</A></H2>

<P>
This section describes how to set up accounts for clients of your MySQL
server. It discusses the following topics:

</P>

<UL>
<LI>

The meaning of account names and passwords as used in MySQL and how that
compares to names and passwords used by your operating system

<LI>

How to set up new accounts and remove existing accounts

<LI>

How to change passwords

<LI>

Guidelines for using passwords securely

<LI>

How to use secure connections with SSL

</UL>



<H3><A NAME="User_names" HREF="manual_toc.html#User_names">5.6.1  MySQL Usernames and Passwords</A></H3>

<P>
<A NAME="IDX557"></A>
<A NAME="IDX558"></A>

</P>
<P>
A MySQL account is defined in terms of a username and the client host or hosts
from which the user can connect to the server. The account also has a
password.
There are several distinctions between the way usernames and passwords are
used by MySQL and the way they are used by your operating system:

</P>

<UL>
<LI>

Usernames, as used by MySQL for authentication purposes, have nothing to do
with usernames (login names) as used by Windows or Unix.  On Unix, most
MySQL clients by default try to log in using the current Unix username as
the MySQL username, but that is for convenience only. The default can be
overridden easily, because client programs allow any username to be
specified with a <code>-u</code> or <code>--user</code> option. Because this means
that anyone can attempt to connect to the server using any username, you
can't make a database secure in any way unless all MySQL accounts have
passwords.  Anyone who specifies a username for an account that
has no password will be able to connect successfully to the server.

<LI>

MySQL usernames can be up to 16 characters long. Operating system usernames
might have a different maximum length. For example, Unix usernames typically
are limited to eight characters.

<LI>

MySQL passwords have nothing to do with passwords for logging in to your
operating system.  There is no necessary connection between the password
you use to log in to a Windows or Unix machine and the password you use
to access the MySQL server on that machine.

<LI>

MySQL encrypts passwords using its own algorithm. This encryption is
different from that used during the Unix login process.  MySQL password
encryption is the same as that implemented by the <code>PASSWORD()</code> SQL
function.  Unix password encryption is the same as that implemented by the
<code>ENCRYPT()</code> SQL function.  See the descriptions of the
<code>PASSWORD()</code> and <code>ENCRYPT()</code> functions in section <A HREF="manual_Functions.html#Encryption_functions">12.8.2  Encryption Functions</A>.  From version 4.1 on, MySQL employs a stronger authentication
method that has better password protection during the connection process
than in earlier versions. It is secure even if TCP/IP packets are sniffed or
the <code>mysql</code> database is captured.  (In earlier versions, even though
passwords are stored in encrypted form in the <code>user</code> table, knowledge
of the encrypted password value could be used to connect to the MySQL
server.)

</UL>

<P>
When you install MySQL, the grant tables are populated with an initial set of
accounts. These accounts have names and access privileges that are described
in section <A HREF="manual_Installing.html#Default_privileges">2.9.3  Securing the Initial MySQL Accounts</A>, which also discusses how to assign passwords
to them.  Thereafter, you normally set up, modify, and remove MySQL accounts
using the <code>GRANT</code> and <code>REVOKE</code> statements.
See section <A HREF="manual_SQL_Syntax.html#GRANT">13.5.1.2  <code>GRANT</code> and <code>REVOKE</code> Syntax</A>.

</P>
<P>
When you connect to a MySQL server with a command-line client, you
should specify the username and password for the account that you want to use:

</P>

<PRE>
shell&#62; mysql --user=monty --password=<var>guess</var> <var>db_name</var>
</PRE>

<P>
If you prefer short options, the command looks like this:

</P>

<PRE>
shell&#62; mysql -u monty -p<var>guess</var> <var>db_name</var>
</PRE>

<P>
There must be <em>no space</em> between the <code>-p</code> option and the
following password value.
See section <A HREF="manual_MySQL_Database_Administration.html#Connecting">5.5.4  Connecting to the MySQL Server</A>.

</P>
<P>
The preceding commands include the password value on the command line, which
can be a security risk.
See section <A HREF="manual_MySQL_Database_Administration.html#Password_security">5.6.6  Keeping Your Password Secure</A>.
To avoid this, specify the <code>--password</code> or <code>-p</code> option without any
following password value:

</P>

<PRE>
shell&#62; mysql --user=monty --password <var>db_name</var>
shell&#62; mysql -u monty -p <var>db_name</var>
</PRE>

<P>
Then the client program will print a prompt and wait for you to enter
the password.
(In these examples, <var>db_name</var> is <em>not</em> interpreted as a
password, because it is separated from the preceding password option by a
space.)

</P>
<P>
On some systems, the library call that MySQL uses to prompt for a password
automatically limits the password to eight characters.  That is a problem
with the system library, not with MySQL.  Internally, MySQL doesn't have
any limit for the length of the password.  To work around the problem,
change your MySQL password to a value that is eight or fewer characters
long, or put your password in an option file.

</P>



<H3><A NAME="Adding_users" HREF="manual_toc.html#Adding_users">5.6.2  Adding New User Accounts to MySQL</A></H3>

<P>
<A NAME="IDX559"></A>
<A NAME="IDX560"></A>

</P>
<P>
<A NAME="IDX561"></A>
<A NAME="IDX562"></A>
<A NAME="IDX563"></A>
<A NAME="IDX564"></A>
<A NAME="IDX565"></A>

</P>
<P>
You can create MySQL accounts in two ways:

</P>

<UL>
<LI>

By using <code>GRANT</code> statements
<LI>

By manipulating the MySQL grant tables directly
</UL>

<P>
The preferred method is to use <code>GRANT</code> statements, because they are
more concise and less error-prone. <code>GRANT</code> is available as of MySQL
3.22.11; its syntax is described in
section <A HREF="manual_SQL_Syntax.html#GRANT">13.5.1.2  <code>GRANT</code> and <code>REVOKE</code> Syntax</A>.

</P>
<P>
Another option for creating accounts is to use one of several available
third-party programs that offer capabilities for MySQL account
administration.  <code>phpMyAdmin</code> is one such program.

</P>
<P>
The following examples show how to use the <code>mysql</code> client program to
set up new users.  These examples assume that privileges are set up
according to the defaults described in section <A HREF="manual_Installing.html#Default_privileges">2.9.3  Securing the Initial MySQL Accounts</A>.  This means
that to make changes, you must connect to the MySQL server as the MySQL
<code>root</code> user, and the <code>root</code> account must have the <code>INSERT</code>
privilege for the <code>mysql</code> database and the <code>RELOAD</code> administrative
privilege.

</P>
<P>
First, use the <code>mysql</code> program to connect to the server as the
MySQL <code>root</code> user:

</P>

<PRE>
shell&#62; mysql --user=root mysql
</PRE>

<P>
If you have assigned a password to the <code>root</code> account, you'll also
need to supply a <code>--password</code> or <code>-p</code> option for this <code>mysql</code>
command and also for those later in this section.

</P>
<P>
After connecting to the server as <code>root</code>, you can add new accounts.  The following
statements use <code>GRANT</code> to set up four new accounts:

</P>

<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON *.* TO 'monty'@'localhost'
    -&#62;     IDENTIFIED BY 'some_pass' WITH GRANT OPTION;
mysql&#62; GRANT ALL PRIVILEGES ON *.* TO 'monty'@'%'
    -&#62;     IDENTIFIED BY 'some_pass' WITH GRANT OPTION;
mysql&#62; GRANT RELOAD,PROCESS ON *.* TO 'admin'@'localhost';
mysql&#62; GRANT USAGE ON *.* TO 'dummy'@'localhost';
</PRE>

<P>
The accounts created by these <code>GRANT</code> statements have the
following properties:

</P>

<UL>
<LI>

Two of the accounts have a username of <code>monty</code> and a password of
<code>some_pass</code>. Both accounts are superuser accounts with full privileges
to do anything. One account (<code>'monty'@'localhost'</code>) can be used only
when connecting from the local host. The other (<code>'monty'@'%'</code>) can be
used to connect from any other host.  Note that it is necessary to have both
accounts for <code>monty</code> to be able to connect from anywhere as
<code>monty</code>.  Without the <code>localhost</code> account, the anonymous-user
account for <code>localhost</code> that is created by <code>mysql_install_db</code>
would take precedence when <code>monty</code> connects from the local host. As a
result, <code>monty</code> would be treated as an anonymous user.  The reason for
this is that the anonymous-user account has a more specific <code>Host</code>
column value than the <code>'monty'@'%'</code> account and thus comes earlier in
the <code>user</code> table sort order.  (<code>user</code> table sorting is discussed
in section <A HREF="manual_MySQL_Database_Administration.html#Connection_access">5.5.5  Access Control, Stage 1: Connection Verification</A>.)

<LI>

One account has a username of <code>admin</code> and no password.  This account
can be used only by connecting from the local host.  It is granted the
<code>RELOAD</code> and <code>PROCESS</code> administrative privileges.  These
privileges allow the <code>admin</code> user to execute the <code>mysqladmin
reload</code>, <code>mysqladmin refresh</code>, and <code>mysqladmin flush-<var>xxx</var></code> commands,
as well as <code>mysqladmin processlist</code> .  No privileges are granted for
accessing any databases. You could add such privileges later by issuing
additional <code>GRANT</code> statements.

<LI>

One account has a username of <code>dummy</code> and no password.  This account
can be used only by connecting from the local host.  No privileges are
granted. The <code>USAGE</code> privilege in the <code>GRANT</code> statement allows you
to create an account without giving it any privileges. It has the effect of
setting all the global privileges to <code>'N'</code>.  It is assumed that you
will grant specific privileges to the account later.

</UL>

<P>
<A NAME="IDX566"></A>
<A NAME="IDX567"></A>

</P>
<P>
As an alternative to <code>GRANT</code>, you can create the same accounts
directly by issuing <code>INSERT</code> statements and then telling
the server to reload the grant tables:

</P>

<PRE>
shell&#62; mysql --user=root mysql
mysql&#62; INSERT INTO user
    -&#62;     VALUES('localhost','monty',PASSWORD('some_pass'),
    -&#62;     'Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y');
mysql&#62; INSERT INTO user
    -&#62;     VALUES('%','monty',PASSWORD('some_pass'),
    -&#62;     'Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y','Y');
mysql&#62; INSERT INTO user SET Host='localhost',User='admin',
    -&#62;     Reload_priv='Y', Process_priv='Y';
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62;     VALUES('localhost','dummy','');
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
The reason for using <code>FLUSH PRIVILEGES</code> when you create accounts with
<code>INSERT</code> is to tell the server to re-read the grant tables.
Otherwise, the changes will go unnoticed until you restart the server. With
<code>GRANT</code>, <code>FLUSH PRIVILEGES</code> is unnecessary.

</P>
<P>
The reason for using the <code>PASSWORD()</code> function with <code>INSERT</code> is to
encrypt the password. The <code>GRANT</code> statement encrypts the password for
you, so <code>PASSWORD()</code> is unnecessary.

</P>
<P>
The <code>'Y'</code> values enable privileges for the accounts.  Depending on your
MySQL version, you may have to use a different number of <code>'Y'</code> values
in the first two <code>INSERT</code> statements. (Versions prior to 3.22.11 have
fewer privilege columns, and versions from 4.0.2 on have more.)  For the
<code>admin</code> account, the more readable extended <code>INSERT</code> syntax using
<code>SET</code> that is available starting with MySQL 3.22.11 is used.

</P>
<P>
In the <code>INSERT</code> statement for the <code>dummy</code> account, only the
<code>Host</code>, <code>User</code>, and <code>Password</code> columns in the <code>user</code>
table record are assigned values. None of the privilege columns are set
explicitly, so MySQL assigns them all the default value of <code>'N'</code>.
This is equivalent to what <code>GRANT USAGE</code> does.

</P>
<P>
Note that to set up a superuser account, it is necessary only to create a
<code>user</code> table entry with the privilege columns set to <code>'Y'</code>.
<code>user</code> table privileges are global, so no entries in any of the other
grant tables are needed.

</P>
<P>
The next examples create three accounts and give them access to specific
databases. Each of them has a username of <code>custom</code> and password of
<code>obscure</code>.

</P>
<P>
To create the accounts with <code>GRANT</code>, use the following statements:

</P>

<PRE>
shell&#62; mysql --user=root mysql
mysql&#62; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
    -&#62;     ON bankaccount.*
    -&#62;     TO 'custom'@'localhost'
    -&#62;     IDENTIFIED BY 'obscure';
mysql&#62; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
    -&#62;     ON expenses.*
    -&#62;     TO 'custom'@'whitehouse.gov'
    -&#62;     IDENTIFIED BY 'obscure';
mysql&#62; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,DROP
    -&#62;     ON customer.*
    -&#62;     TO 'custom'@'server.domain'
    -&#62;     IDENTIFIED BY 'obscure';
</PRE>

<P>
The three accounts can be used as follows:

</P>

<UL>
<LI>

The first account can
access the <code>bankaccount</code> database, but only from the local host.
<LI>

The second account can access
the <code>expenses</code> database, but only from the host <code>whitehouse.gov</code>.
<LI>

The third account can access
the <code>customer</code> database, but only from the host <code>server.domain</code>.
</UL>

<P>
To set up the <code>custom</code> accounts without <code>GRANT</code>, use <code>INSERT</code>
statements as follows to modify the grant tables directly:

</P>

<PRE>
shell&#62; mysql --user=root mysql
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62;     VALUES('localhost','custom',PASSWORD('obscure'));
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62;     VALUES('whitehouse.gov','custom',PASSWORD('obscure'));
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62;     VALUES('server.domain','custom',PASSWORD('obscure'));
mysql&#62; INSERT INTO db
    -&#62;     (Host,Db,User,Select_priv,Insert_priv,
    -&#62;     Update_priv,Delete_priv,Create_priv,Drop_priv)
    -&#62;     VALUES('localhost','bankaccount','custom',
    -&#62;     'Y','Y','Y','Y','Y','Y');
mysql&#62; INSERT INTO db
    -&#62;     (Host,Db,User,Select_priv,Insert_priv,
    -&#62;     Update_priv,Delete_priv,Create_priv,Drop_priv)
    -&#62;     VALUES('whitehouse.gov','expenses','custom',
    -&#62;     'Y','Y','Y','Y','Y','Y');
mysql&#62; INSERT INTO db
    -&#62;     (Host,Db,User,Select_priv,Insert_priv,
    -&#62;     Update_priv,Delete_priv,Create_priv,Drop_priv)
    -&#62;     VALUES('server.domain','customer','custom',
    -&#62;     'Y','Y','Y','Y','Y','Y');
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
The first three <code>INSERT</code> statements add <code>user</code> table entries that
allow the user <code>custom</code> to connect from the various hosts with the given
password, but grant no global privileges (all privileges are set to the
default value of <code>'N'</code>).  The next three <code>INSERT</code> statements add
<code>db</code> table entries that grant privileges to <code>custom</code> for the
<code>bankaccount</code>, <code>expenses</code>, and <code>customer</code> databases, but only
when accessed from the proper hosts.  As usual when you modify the grant
tables directly, you tell the server to reload them with
<code>FLUSH PRIVILEGES</code> so that the privilege changes take effect.

</P>
<P>
If you want to give a specific user access from all machines in a given
domain (for example, <code>mydomain.com</code>), you can issue a <code>GRANT</code>
statement that uses the <samp>`%'</samp> wildcard character in the host part of the
account name:

</P>

<PRE>
mysql&#62; GRANT ...
    -&#62;     ON *.*
    -&#62;     TO 'myname'@'%.mydomain.com'
    -&#62;     IDENTIFIED BY 'mypass';
</PRE>

<P>
To do the same thing by modifying the grant tables directly, do this:

</P>

<PRE>
mysql&#62; INSERT INTO user (Host,User,Password,...)
    -&#62;     VALUES('%.mydomain.com','myname',PASSWORD('mypass'),...);
mysql&#62; FLUSH PRIVILEGES;
</PRE>



<H3><A NAME="Removing_users" HREF="manual_toc.html#Removing_users">5.6.3  Removing User Accounts from MySQL</A></H3>

<P>
<A NAME="IDX568"></A>
<A NAME="IDX569"></A>
<A NAME="IDX570"></A>
<A NAME="IDX571"></A>
<A NAME="IDX572"></A>
<A NAME="IDX573"></A>
<A NAME="IDX574"></A>
<A NAME="IDX575"></A>

</P>
<P>
To remove an account, use the <code>DROP USER</code> statement, which was added in
MySQL 4.1.1.  For older versions of MySQL, use <code>DELETE</code> instead.
The account removal procedure is described in section <A HREF="manual_SQL_Syntax.html#DROP_USER">13.5.1.1  <code>DROP USER</code> Syntax</A>.

</P>



<H3><A NAME="User_resources" HREF="manual_toc.html#User_resources">5.6.4  Limiting Account Resources</A></H3>

<P>
Before MySQL 4.0.2, the only available method for limiting use of MySQL
server resources is to set the <code>max_user_connections</code> system
variable to a non-zero value. But that method is strictly global.  It does
not allow for management of individual accounts. Also, it limits only the
number of simultaneous connections made using a single account, not
what a client can do once connected. Both types of control are
interest to many MySQL administrators, particularly those for Internet
Service Providers.

</P>
<P>
Starting from MySQL 4.0.2, you can limit the following server resources for
individual accounts:

</P>

<UL>
<LI>

The number of queries that an account can issue per hour
<LI>

The number of updates that an account can issue per hour
<LI>

The number of times an account can connect to the server per hour
</UL>

<P>
Any statement that a client can issue counts against the query limit.
Only statements that modify databases or tables count against the update
limit.

</P>
<P>
An account in this context is a single record in the <code>user</code> table. Each
account is uniquely identified by its <code>User</code> and <code>Host</code> column
values.

</P>
<P>
As a prerequisite for using this feature, the <code>user</code> table in the
<code>mysql</code> database must contain the resource-related columns.  Resource
limits are stored in the <code>max_questions</code>, <code>max_updates</code>, and
<code>max_connections</code> columns.  If your <code>user</code> table doesn't have
these columns, it must be upgraded; see section <A HREF="manual_Installing.html#Upgrading-grant-tables">2.10.7  Upgrading the Grant Tables</A>.

</P>
<P>
To set resource limits with a <code>GRANT</code> statement, use a <code>WITH</code>
clause that names each resource to be limited and a per-hour count
indicating the limit value.  For example, to create a new account that can
access the <code>customer</code> database, but only in a limited fashion, issue
this statement:

</P>

<PRE>
mysql&#62; GRANT ALL ON customer.* TO 'francis'@'localhost'
    -&#62;     IDENTIFIED BY 'frank'
    -&#62;     WITH MAX_QUERIES_PER_HOUR 20
    -&#62;          MAX_UPDATES_PER_HOUR 10
    -&#62;          MAX_CONNECTIONS_PER_HOUR 5;
</PRE>

<P>
The limit types need not all be named in the <code>WITH</code> clause, but those
named can be present in any order. The value for each limit should be an
integer representing a count per hour. If the <code>GRANT</code> statement has no
<code>WITH</code> clause, the limits are each set to the default value of zero
(that is, no limit).

</P>
<P>
To set or change limits for an existing account, use a <code>GRANT USAGE</code>
statement at the global level (<code>ON *.*</code>). The following statement
changes the query limit for <code>francis</code> to 100:

</P>

<PRE>
mysql&#62; GRANT USAGE ON *.* TO 'francis'@'localhost'
    -&#62;     WITH MAX_QUERIES_PER_HOUR 100;
</PRE>

<P>
This statement leaves the account's existing privileges unchanged and
modifies only the limit values specified.

</P>
<P>
To remove an existing limit, set its value to zero. For example, to remove the
limit on how many times per hour <code>francis</code> can connect, use this
statement:

</P>

<PRE>
mysql&#62; GRANT USAGE ON *.* TO 'francis'@'localhost'
    -&#62;     WITH MAX_CONNECTIONS_PER_HOUR 0;
</PRE>

<P>
Resource-use counting takes place when any account has a non-zero limit
placed on its use of any of the resources.

</P>
<P>
As the server runs, it counts the number of times each account uses
resources.  If an account reaches its limit on number of connections within
the last hour, further connections for the account are rejected until that
hour is up. Similarly, if the account reaches its limit on the number of
queries or updates, further queries or updates are rejected until the hour
is up. In all such cases, an appropriate error message is issued.

</P>
<P>
Resource counting is done per account, not per client. For example, if your
account has a query limit of 50, you cannot increase your limit to 100 by
making two simultaneous client connections to the server.  Queries issued on
both connections are counted together.

</P>
<P>
The current resource-use counts can be reset globally for all accounts, or
individually for a given count:

</P>

<UL>
<LI>

To reset the current counts to zero for all accounts, issue a <code>FLUSH
USER_RESOURCES</code> statement. The counts also can be reset by reloading the
grant tables (for example, with a <code>FLUSH PRIVILEGES</code> statement or a
<code>mysqladmin reload</code> command).
<LI>

The counts for an individual account can be set to zero by re-granting
it any of its limits. To do this, use <code>GRANT USAGE</code> as described earlier
and specify a limit value equal to the value that the account
already has.

</UL>



<H3><A NAME="Passwords" HREF="manual_toc.html#Passwords">5.6.5  Assigning Account Passwords</A></H3>

<P>
<A NAME="IDX576"></A>
<A NAME="IDX577"></A>

</P>
<P>
<A NAME="IDX578"></A>
<A NAME="IDX579"></A>

</P>
<P>
Passwords may be assigned from the command line by using the <code>mysqladmin</code>
command:

</P>

<PRE>
shell&#62; mysqladmin -u <var>user_name</var> -h <var>host_name</var> password "<var>newpwd</var>"
</PRE>

<P>
The account for which this command resets the password is the one with a
<code>user</code> table record that matches <var>user_name</var> in the <code>User</code>
column and the client host <em>from which you connect</em> in the
<code>Host</code> column.

</P>
<P>
Another way to assign a password to an account is to issue a <code>SET
PASSWORD</code> statement:

</P>

<PRE>
mysql&#62; SET PASSWORD FOR 'jeffrey'@'%' = PASSWORD('biscuit');
</PRE>

<P>
Only users such as <code>root</code> with update access to the <code>mysql</code>
database can change the password for other users.  If you are not connected
as an anonymous user, you can change your own password by omitting the
<code>FOR</code> clause:

</P>

<PRE>
mysql&#62; SET PASSWORD = PASSWORD('biscuit');
</PRE>

<P>
You can also use a <code>GRANT USAGE</code> statement at the global level
(<code>ON *.*</code>) to assign a password to an account without affecting the
account's current privileges:

</P>

<PRE>
mysql&#62; GRANT USAGE ON *.* TO 'jeffrey'@'%' IDENTIFIED BY 'biscuit';
</PRE>

<P>
Although it is generally preferable to assign passwords using one of the
preceding methods, you can also do so by modifying the <code>user</code> table
directly:

</P>

<UL>
<LI>

To establish a password when creating a new account, provide a
value for the <code>Password</code> column:


<PRE>
shell&#62; mysql -u root mysql
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62; VALUES('%','jeffrey',PASSWORD('biscuit'));
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<LI>

To change the password for an existing account, use <code>UPDATE</code> to set the
<code>Password</code> column value:


<PRE>
shell&#62; mysql -u root mysql
mysql&#62; UPDATE user SET Password = PASSWORD('bagel')
    -&#62; WHERE Host = '%' AND User = 'francis';
mysql&#62; FLUSH PRIVILEGES;
</PRE>

</UL>

<P>
When you assign an account a password using <code>SET PASSWORD</code>,
<code>INSERT</code>, or <code>UPDATE</code>, you must use the <code>PASSWORD()</code> function
to encrypt it.  (The only exception is that you need not use
<code>PASSWORD()</code> if the password is empty.) <code>PASSWORD()</code> is
necessary because the <code>user</code> table stores passwords in encrypted form,
not as plaintext.  If you forget that fact, you are likely to set passwords
like this:

</P>

<PRE>
shell&#62; mysql -u root mysql
mysql&#62; INSERT INTO user (Host,User,Password)
    -&#62; VALUES('%','jeffrey','biscuit');
mysql&#62; FLUSH PRIVILEGES;
</PRE>

<P>
The result is that the literal value <code>'biscuit'</code> is stored as the
password in the <code>user</code> table, not the encrypted value.  When
<code>jeffrey</code> attempts to connect to the server using this password, the
value is encrypted and compared to the value stored in the <code>user</code>
table.  However, the stored value is the literal string <code>'biscuit'</code>, so
the comparison fails and the server rejects the connection:

</P>

<PRE>
shell&#62; mysql -u jeffrey -pbiscuit test
Access denied
</PRE>

<P>
If you set passwords using the <code>GRANT ... IDENTIFIED BY</code> statement or
the <code>mysqladmin password</code> command, they both take care of encrypting
the password for you.  The <code>PASSWORD()</code> function is unnecessary.

</P>
<P>
<strong>Note</strong>: <code>PASSWORD()</code> encryption is different from Unix password
encryption.
See section <A HREF="manual_MySQL_Database_Administration.html#User_names">5.6.1  MySQL Usernames and Passwords</A>.

</P>



<H3><A NAME="Password_security" HREF="manual_toc.html#Password_security">5.6.6  Keeping Your Password Secure</A></H3>

<P>
On an administrative level, you should never grant access to the
<code>mysql.user</code> table to any non-administrative accounts. Passwords in the
<code>user</code> table are stored in encrypted form, but in versions of MySQL
earlier than 4.1, knowing the encrypted password for an account makes it
possible to connect to the server using that account.

</P>
<P>
When you run a client program to connect to the MySQL server, it is
inadvisable to specify your password in a way that exposes it to discovery
by other users.  The methods you can use to specify your password when you
run client programs are listed here, along with an assessment of the risks
of each method:

</P>

<UL>
<LI>

<A NAME="IDX580"></A>
<A NAME="IDX581"></A>
Use a <code>-p<var>your_pass</var></code> or <code>--password=<var>your_pass</var></code> option on the command
line.  For example:


<PRE>
shell&#62; mysql -u francis -pfrank <var>db_name</var>
</PRE>

This is convenient but insecure, because your password becomes visible to
system status programs such as <code>ps</code> that may be invoked by other users
to display command lines.  MySQL clients typically overwrite the
command-line password argument with zeros during their initialization
sequence, but there is still a brief interval during which the value is
visible.

<LI>

Use a <code>-p</code> or <code>--password</code> option with no password value
specified.  In this case, the client program solicits the password from
the terminal:


<PRE>
shell&#62; mysql -u francis -p <var>db_name</var>
Enter password: ********
</PRE>

The <samp>`*'</samp> characters indicate where you enter your password. The password
is not displayed as you enter it.

It is more secure to enter your password this way than to specify it on the
command line because it is not visible to other users.  However, this method
of entering a password is suitable only for programs that you run
interactively.  If you want to invoke a client from a script that runs
non-interactively, there is no opportunity to enter the password from the
terminal. On some systems, you may even find that the first line of your
script is read and interpreted (incorrectly) as your password!

<LI>

<A NAME="IDX582"></A>
Store your password in an option file.  For example, on Unix you can list your
password in the <code>[client]</code> section of the <tt>`.my.cnf'</tt> file in your
home directory:


<PRE>
[client]
password=your_pass
</PRE>

If you store your password in <tt>`.my.cnf'</tt>, the file should not be
accessible to anyone but yourself. To ensure this, set the file access mode to
<code>400</code> or <code>600</code>. For example:


<PRE>
shell&#62; chmod 600 .my.cnf
</PRE>

section <A HREF="manual_Using_MySQL_Programs.html#Option_files">4.3.2  Using Option Files</A> discusses option files in more detail.

<LI>

Store your password in the <code>MYSQL_PWD</code> environment variable.
This method of specifying your MySQL password must be considered
extremely insecure and should not be used.  Some versions of <code>ps</code>
include an option to display the environment of running processes. If you
set <code>MYSQL_PWD</code>, your password will be exposed to any other user who
runs <code>ps</code>.  Even on systems without such a version of <code>ps</code>, it is
unwise to assume that there are no other methods by which users can examine
process environments.
See section <A HREF="manual_Environment_variables.html#Environment_variables">F  Environment Variables</A>.

</UL>

<P>
All in all, the safest methods are to have the client program prompt for the
password or to specify the password in a properly protected option file.

</P>


<H3><A NAME="Secure_connections" HREF="manual_toc.html#Secure_connections">5.6.7  Using Secure Connections</A></H3>

<P>
<A NAME="IDX583"></A>
<A NAME="IDX584"></A>

</P>
<P>
Beginning with version 4.0.0, MySQL has support for secure (encrypted)
connections between MySQL clients and the server using the Secure Sockets
Layer (SSL) protocol.  This section discusses how to use SSL connections.
It also describes a way to set up SSH on Windows.

</P>
<P>
The standard configuration of MySQL is intended to be as fast as possible,
so encrypted connections are not used by default.  Doing so would make the
client/server protocol much slower.  Encrypting data is a CPU-intensive
operation that requires the computer to do additional work and can delay
other MySQL tasks.  For applications that require the security provided by
encrypted connections, the extra computation is warranted.

</P>
<P>
MySQL allows encryption to be enabled on a per-connection basis. You can
choose a normal unencrypted connection or a secure encrypted SSL connection
according the requirements of individual applications.

</P>



<H4><A NAME="Secure_basics" HREF="manual_toc.html#Secure_basics">5.6.7.1  Basic SSL Concepts</A></H4>

<P>
To understand how MySQL
uses SSL, it's necessary to explain some basic SSL and X509 concepts. People
who are already familiar with them can skip this part.

</P>
<P>
By default, MySQL uses unencrypted connections between the client and the
server. This means that someone with access to the network could watch all
your traffic and look at the data being sent or received.  They could even
change the data while it is in transit between client and server. To improve
security a little, you can compress client/server traffic by using the
<code>--compress</code> option when invoking client programs.  However, this will
not foil a determined attacker.

</P>
<P>
<A NAME="IDX585"></A>
When you need to move information over a network in a secure fashion,
an unencrypted connection is unacceptable.  Encryption is the way to make
any kind of data unreadable. In fact, today's practice requires many
additional security elements from encryption algorithms.  They should resist
many kind of known attacks such as changing the order of encrypted messages
or replaying data twice.

</P>
<P>
SSL is a protocol that uses different encryption algorithms to ensure that
data received over a public network can be trusted. It has mechanisms to
detect any data change, loss, or replay. SSL also incorporates algorithms
that provide identity verification using the X509 standard.

</P>
<P>
<A NAME="IDX586"></A>
X509 makes it possible to identify someone on the Internet.  It is most
commonly used in e-commerce applications. In basic terms, there should be
some company called a ``Certificate Authority'' (or CA) that assigns electronic
certificates to anyone who needs them. Certificates rely on asymmetric
encryption algorithms that have two encryption keys (a public key and a
secret key). A certificate owner can show the certificate to another party
as proof of identity. A certificate consists of its owner's public key. Any
data encrypted with this public key can be decrypted only using the
corresponding secret key, which is held by the owner of the certificate.

</P>
<P>
If you need more information about SSL, X509, or encryption, use your
favorite Internet search engine to search for keywords in which you are
interested.

</P>


<H4><A NAME="Secure_requirements" HREF="manual_toc.html#Secure_requirements">5.6.7.2  Requirements</A></H4>

<P>
To use SSL connections between the MySQL server and client programs, your
system must be able to support OpenSSL and your version of MySQL must be
4.0.0 or newer.

</P>
<P>
To get secure connections to work with MySQL, you must do the following:

</P>

<OL>
<LI>

Install the OpenSSL library. We have tested MySQL with OpenSSL 0.9.6.
If you need OpenSSL, visit <a HREF="http://www.openssl.org">http://www.openssl.org</a>.
<LI>

When you configure MySQL, run the <code>configure</code> script with the
<code>--with-vio</code> and <code>--with-openssl</code> options.
<LI>

Make sure that you have upgraded your grant tables to include the SSL-related
columns in the <code>mysql.user</code> table.
This is necessary if your grant tables date from a version prior to MySQL
4.0.0.  The upgrade procedure is described in section <A HREF="manual_Installing.html#Upgrading-grant-tables">2.10.7  Upgrading the Grant Tables</A>.
<LI>

To check whether a running <code>mysqld</code> server supports OpenSSL,
examine the value of the <code>have_openssl</code> system variable:


<PRE>
mysql&#62; SHOW VARIABLES LIKE 'have_openssl';
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| have_openssl  | YES   |
+---------------+-------+
</PRE>

If the value is <code>YES</code>, the server supports OpenSSL connections.
</OL>



<H4><A NAME="Secure_create_certs" HREF="manual_toc.html#Secure_create_certs">5.6.7.3  Setting Up SSL Certificates for MySQL</A></H4>

<P>
Here is an example for setting up SSL certificates for MySQL:

</P>

<PRE>
DIR=`pwd`/openssl
PRIV=$DIR/private

mkdir $DIR $PRIV $DIR/newcerts
cp /usr/share/ssl/openssl.cnf $DIR
replace ./demoCA $DIR -- $DIR/openssl.cnf

# Create necessary files: $database, $serial and $new_certs_dir 
# directory (optional)

touch $DIR/index.txt
echo "01" &#62; $DIR/serial

#
# Generation of Certificate Authority(CA)
#

openssl req -new -x509 -keyout $PRIV/cakey.pem -out $DIR/cacert.pem \
    -config $DIR/openssl.cnf

# Sample output:
# Using configuration from /home/monty/openssl/openssl.cnf
# Generating a 1024 bit RSA private key
# ................++++++
# .........++++++
# writing new private key to '/home/monty/openssl/private/cakey.pem'
# Enter PEM pass phrase:
# Verifying password - Enter PEM pass phrase:
# -----
# You are about to be asked to enter information that will be
# incorporated into your certificate request.
# What you are about to enter is what is called a Distinguished Name
# or a DN.
# There are quite a few fields but you can leave some blank
# For some fields there will be a default value,
# If you enter '.', the field will be left blank.
# -----
# Country Name (2 letter code) [AU]:FI
# State or Province Name (full name) [Some-State]:.
# Locality Name (eg, city) []:
# Organization Name (eg, company) [Internet Widgits Pty Ltd]:MySQL AB
# Organizational Unit Name (eg, section) []:
# Common Name (eg, YOUR name) []:MySQL admin
# Email Address []:

#
# Create server request and key
#
openssl req -new -keyout $DIR/server-key.pem -out \
    $DIR/server-req.pem -days 3600 -config $DIR/openssl.cnf

# Sample output:
# Using configuration from /home/monty/openssl/openssl.cnf
# Generating a 1024 bit RSA private key
# ..++++++
# ..........++++++
# writing new private key to '/home/monty/openssl/server-key.pem'
# Enter PEM pass phrase:
# Verifying password - Enter PEM pass phrase:
# -----
# You are about to be asked to enter information that will be
# incorporated into your certificate request.
# What you are about to enter is what is called a Distinguished Name
# or a DN.
# There are quite a few fields but you can leave some blank
# For some fields there will be a default value,
# If you enter '.', the field will be left blank.
# -----
# Country Name (2 letter code) [AU]:FI
# State or Province Name (full name) [Some-State]:.
# Locality Name (eg, city) []:
# Organization Name (eg, company) [Internet Widgits Pty Ltd]:MySQL AB
# Organizational Unit Name (eg, section) []:
# Common Name (eg, YOUR name) []:MySQL server
# Email Address []:
# 
# Please enter the following 'extra' attributes
# to be sent with your certificate request
# A challenge password []:
# An optional company name []:

#
# Remove the passphrase from the key (optional)
#

openssl rsa -in $DIR/server-key.pem -out $DIR/server-key.pem

#
# Sign server cert
#
openssl ca  -policy policy_anything -out $DIR/server-cert.pem \
    -config $DIR/openssl.cnf -infiles $DIR/server-req.pem

# Sample output:
# Using configuration from /home/monty/openssl/openssl.cnf
# Enter PEM pass phrase:
# Check that the request matches the signature
# Signature ok
# The Subjects Distinguished Name is as follows
# countryName           :PRINTABLE:'FI'
# organizationName      :PRINTABLE:'MySQL AB'
# commonName            :PRINTABLE:'MySQL admin'
# Certificate is to be certified until Sep 13 14:22:46 2003 GMT
# (365 days)
# Sign the certificate? [y/n]:y
# 
# 
# 1 out of 1 certificate requests certified, commit? [y/n]y
# Write out database with 1 new entries
# Data Base Updated

#
# Create client request and key
#
openssl req -new -keyout $DIR/client-key.pem -out \
    $DIR/client-req.pem -days 3600 -config $DIR/openssl.cnf

# Sample output:
# Using configuration from /home/monty/openssl/openssl.cnf
# Generating a 1024 bit RSA private key
# .....................................++++++
# .............................................++++++
# writing new private key to '/home/monty/openssl/client-key.pem'
# Enter PEM pass phrase:
# Verifying password - Enter PEM pass phrase:
# -----
# You are about to be asked to enter information that will be
# incorporated into your certificate request.
# What you are about to enter is what is called a Distinguished Name
# or a DN.
# There are quite a few fields but you can leave some blank
# For some fields there will be a default value,
# If you enter '.', the field will be left blank.
# -----
# Country Name (2 letter code) [AU]:FI
# State or Province Name (full name) [Some-State]:.
# Locality Name (eg, city) []:
# Organization Name (eg, company) [Internet Widgits Pty Ltd]:MySQL AB
# Organizational Unit Name (eg, section) []:
# Common Name (eg, YOUR name) []:MySQL user
# Email Address []:
# 
# Please enter the following 'extra' attributes
# to be sent with your certificate request
# A challenge password []:
# An optional company name []:

#
# Remove a passphrase from the key (optional)
#
openssl rsa -in $DIR/client-key.pem -out $DIR/client-key.pem

#
# Sign client cert
#

openssl ca  -policy policy_anything -out $DIR/client-cert.pem \
    -config $DIR/openssl.cnf -infiles $DIR/client-req.pem

# Sample output:
# Using configuration from /home/monty/openssl/openssl.cnf
# Enter PEM pass phrase:
# Check that the request matches the signature
# Signature ok
# The Subjects Distinguished Name is as follows
# countryName           :PRINTABLE:'FI'
# organizationName      :PRINTABLE:'MySQL AB'
# commonName            :PRINTABLE:'MySQL user'
# Certificate is to be certified until Sep 13 16:45:17 2003 GMT
# (365 days)
# Sign the certificate? [y/n]:y
# 
# 
# 1 out of 1 certificate requests certified, commit? [y/n]y
# Write out database with 1 new entries
# Data Base Updated

#
# Create a my.cnf file that you can use to test the certificates
#

cnf=""
cnf="$cnf [client]"
cnf="$cnf ssl-ca=$DIR/cacert.pem"
cnf="$cnf ssl-cert=$DIR/client-cert.pem"
cnf="$cnf ssl-key=$DIR/client-key.pem"
cnf="$cnf [mysqld]"
cnf="$cnf ssl-ca=$DIR/cacert.pem"
cnf="$cnf ssl-cert=$DIR/server-cert.pem"
cnf="$cnf ssl-key=$DIR/server-key.pem"
echo $cnf | replace " " '
' &#62; $DIR/my.cnf
</PRE>

<P>
To test SSL connections, start the server as follows, where <code>$DIR</code> is the
pathname to the directory where the sample <tt>`my.cnf'</tt> option file is
located:

</P>

<PRE>
shell&#62; mysqld --defaults-file=$DIR/my.cnf &#38;
</PRE>

<P>
Then invoke a client program using the same option file:

</P>

<PRE>
shell&#62; mysql --defaults-file=$DIR/my.cnf
</PRE>

<P>
If you have a MySQL source distribution, you can also test your setup by
modifying the preceding <tt>`my.cnf'</tt> file to refer to the demonstration
certificate and key files in the <tt>`SSL'</tt> directory of the distribution.

</P>



<H4><A NAME="Secure_GRANT" HREF="manual_toc.html#Secure_GRANT">5.6.7.4  SSL <code>GRANT</code> Options</A></H4>

<P>
<A NAME="IDX587"></A>
<A NAME="IDX588"></A>
<A NAME="IDX589"></A>

</P>
<P>
MySQL can check X509 certificate attributes in addition to the usual
authentication that is based on the username and password.  To specify
SSL-related options for a MySQL account, use the <code>REQUIRE</code> clause of
the <code>GRANT</code> statement.
See section <A HREF="manual_SQL_Syntax.html#GRANT">13.5.1.2  <code>GRANT</code> and <code>REVOKE</code> Syntax</A>.

</P>
<P>
There are different possibilities for limiting connection types for an account:

</P>

<UL>
<LI>

If an account has no SSL or X509 requirements, unencrypted connections are
allowed if the username and password are valid. However, encrypted
connections also can be used at the client's option, if the client has the
proper certificate and key files.

<LI>

<code>REQUIRE SSL</code> option limits the server to allow only SSL
encrypted connections for the account. Note that this option can be omitted
if there are any ACL records that allow non-SSL connections.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret' REQUIRE SSL;
</PRE>

<LI>

<code>REQUIRE X509</code> means that the client must have a valid certificate
but that the exact certificate, issuer, and subject do not matter.
The only requirement is that it should be possible to verify its
signature with one of the CA certificates.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret' REQUIRE X509;
</PRE>

<LI>

<code>REQUIRE ISSUER 'issuer'</code> places the restriction on connection attempts
that the client must present a valid X509 certificate issued by CA
<code>'issuer'</code>.  If the client presents a certificate that is valid but has
a different issuer, the server rejects the connection.  Use of X509
certificates always implies encryption, so the <code>SSL</code> option is
unneccessary.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE ISSUER '/C=FI/ST=Some-State/L=Helsinki/
       O=MySQL Finland AB/CN=Tonu Samuel/Email=tonu@example.com';
</PRE>

Note that the <code>ISSUER</code> value should be entered as a single string.

<LI>

<code>REQUIRE SUBJECT 'subject'</code> places the restriction on connection
attempts that the client must present a valid X509 certificate with subject
<code>'subject'</code> on it.  If the client presents a certificate that is valid
but has a different subject, the server rejects the connection.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE SUBJECT '/C=EE/ST=Some-State/L=Tallinn/
       O=MySQL demo client certificate/
       CN=Tonu Samuel/Email=tonu@example.com';
</PRE>

Note that the <code>SUBJECT</code> value should be entered as a single string.

<LI>

<code>REQUIRE CIPHER 'cipher'</code> is needed to ensure that strong enough ciphers
and key lengths will be used. SSL itself can be weak if old algorithms
with short encryption keys are used. Using this option, we can ask for
some exact cipher method to allow a connection.


<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE CIPHER 'EDH-RSA-DES-CBC3-SHA';
</PRE>

</UL>

<P>
The <code>SUBJECT</code>, <code>ISSUER</code>, and <code>CIPHER</code> options can be
combined in the <code>REQUIRE</code> clause like this:

</P>

<PRE>
mysql&#62; GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
    -&#62; IDENTIFIED BY 'goodsecret'
    -&#62; REQUIRE SUBJECT '/C=EE/ST=Some-State/L=Tallinn/
       O=MySQL demo client certificate/
       CN=Tonu Samuel/Email=tonu@example.com'
    -&#62; AND ISSUER '/C=FI/ST=Some-State/L=Helsinki/
       O=MySQL Finland AB/CN=Tonu Samuel/Email=tonu@example.com'
    -&#62; AND CIPHER 'EDH-RSA-DES-CBC3-SHA';
</PRE>

<P>
Note that the <code>SUBJECT</code> and <code>ISSUER</code> values each should be entered
as a single string.

</P>
<P>
Starting from MySQL 4.0.4, the <code>AND</code> keyword is optional between
<code>REQUIRE</code> options.

</P>
<P>
The order of the options does not matter, but no option can be specified
twice.

</P>



<H4><A NAME="SSL_options" HREF="manual_toc.html#SSL_options">5.6.7.5  SSL Command-Line Options</A></H4>

<P>
<A NAME="IDX590"></A>

</P>
<P>
The following list describes options that are used for specifying the
use of SSL, certificate files, and key files.
These options are available beginning with MySQL 4.0. They may
be given on the command line or in an option file.

</P>
<DL COMPACT>

<DT><code>--ssl</code>
<DD>
For the server, this option specifies that the server allows SSL connections.
For a client program, it allows the client to connect to the server using SSL.
This option is not sufficient in itself to cause an SSL connection to be used.
You must also specify the
<code>--ssl-ca</code>, <code>--ssl-cert</code>, and <code>--ssl-key</code> options.

This option is more often used in its opposite form to indicate that SSL
should <em>not</em> be used. To do this, specify the option as
<code>--skip-ssl</code> or <code>--ssl=0</code>.

Note that use of <code>--ssl</code> doesn't <em>require</em> an SSL connection.
For example, if the server or client is compiled without SSL support,
a normal unencrypted connection will be used.

The secure way to ensure that an SSL connection will be used is
to create an account on the server that includes a
<code>REQUIRE SSL</code> clause in the <code>GRANT</code> statement.
Then use this account to connect to the server, with both a server and client
that have SSL support enabled.

<DT><code>--ssl-ca=<var>file_name</var></code>
<DD>
The path to a file with a list of trusted SSL CAs.

<DT><code>--ssl-capath=<var>directory_name</var></code>
<DD>
The path to a directory that contains trusted 
SSL CA certificates in pem format.

<DT><code>--ssl-cert=<var>file_name</var></code>
<DD>
The name of the SSL certificate file to use
for establishing a secure connection.

<DT><code>--ssl-cipher=<var>cipher_list</var></code>
<DD>
A list of allowable ciphers to use for SSL encryption.
<var>cipher_list</var> has the same format as the <code>openssl ciphers</code>
command.

Example: <code>--ssl-cipher=ALL:-AES:-EXP</code>

<DT><code>--ssl-key=<var>file_name</var></code>
<DD>
The name of the SSL key file to use
for establishing a secure connection.

</DL>



<H4><A NAME="Windows_and_SSH" HREF="manual_toc.html#Windows_and_SSH">5.6.7.6  Connecting to MySQL Remotely from Windows with SSH</A></H4>

<P>
<A NAME="IDX591"></A>
<A NAME="IDX592"></A>

</P>
<P>
Here is a note about how to connect to get a secure connection to remote
MySQL server with SSH (by David Carlson <a HREF="mailto:dcarlson@mplcomm.com">dcarlson@mplcomm.com</a>):

</P>

<OL>
<LI>

Install an SSH client on your Windows machine.  As a user, the best non-free
one I've found is from <code>SecureCRT</code> from <a HREF="http://www.vandyke.com/">http://www.vandyke.com/</a>.
Another option is <code>f-secure</code> from <a HREF="http://www.f-secure.com/">http://www.f-secure.com/</a>. You
can also find some free ones on <code>Google</code> at
<a HREF="http://directory.google.com/Top/Computers/Security/Products_and_Tools/Cryptography/SSH/Clients/Windows/">http://directory.google.com/Top/Computers/Security/Products_and_Tools/Cryptography/SSH/Clients/Windows/</a>.

<LI>

Start your Windows SSH client.
Set <code>Host_Name = yourmysqlserver_URL_or_IP</code>.
Set <code>userid=your_userid</code> to log in to your server. This <code>userid</code>
value may not be the same as the username of your MySQL account.

<LI>

Set up port forwarding. Either do a remote forward (Set <code>local_port: 3306</code>, <code>remote_host: yourmysqlservername_or_ip</code>, <code>remote_port: 3306</code> )
or a local forward (Set <code>port: 3306</code>,  <code>host: localhost</code>, <code>remote port: 3306</code>).

<LI>

Save everything, otherwise you'll have to redo it the next time.

<LI>

Log in to your server with the SSH session you just created.

<LI>

On your Windows machine, start some ODBC application (such as Access).

<LI>

Create a new file in Windows and link to MySQL using the ODBC
driver the same way you normally do, except type in <code>localhost</code>
for the MySQL host server, not <code>yourmysqlservername</code>.
</OL>

<P>
You should now have an ODBC connection to MySQL, encrypted using SSH.

</P>



<H2><A NAME="Disaster_Prevention" HREF="manual_toc.html#Disaster_Prevention">5.7  Disaster Prevention and Recovery</A></H2>

<P>
This section discusses how to make database backups (full and incremental)
and how to perform
table maintenance.  The syntax of the SQL statements described here is
given in section <A HREF="manual_SQL_Syntax.html#Database_Administration">13.5  Database Administration Statements</A>.
Much of the information here pertains primarily to <code>MyISAM</code> tables.
<code>InnoDB</code> backup procedures are given in section <A HREF="manual_InnoDB.html#Backing_up">15.9  Backing Up and Recovering an <code>InnoDB</code> Database</A>.

</P>



<H3><A NAME="Backup" HREF="manual_toc.html#Backup">5.7.1  Database Backups</A></H3>

<P>
<A NAME="IDX593"></A>
<A NAME="IDX594"></A>

</P>
<P>
Because MySQL tables are stored as files, it is easy to do a
backup. To get a consistent backup, do a <code>LOCK TABLES</code> on the
relevant tables, followed by <code>FLUSH TABLES</code> for the tables.
See section <A HREF="manual_SQL_Syntax.html#LOCK_TABLES">13.4.5  <code>LOCK TABLES</code> and <code>UNLOCK TABLES</code> Syntax</A> and
section <A HREF="manual_SQL_Syntax.html#FLUSH">13.5.5.2  <code>FLUSH</code> Syntax</A>.
You need only a read lock; this allows other clients to continue to
query the tables while you are making a copy of the files in the
database directory.  The <code>FLUSH TABLES</code> statement is needed to ensure that
the all active index pages are written to disk before you start the backup.

</P>

<P>
If you want to make an SQL-level backup of a table, you can use
<code>SELECT INTO ... OUTFILE</code> or <code>BACKUP TABLE</code>.
For <code>SELECT INTO ... OUTFILE</code>, the output file cannot already exist.
For <code>BACKUP TABLE</code>, the same is true as of
MySQL 3.23.56 and 4.0.12, because this would be a security risk.
See section <A HREF="manual_SQL_Syntax.html#SELECT">13.1.7  <code>SELECT</code> Syntax</A> and
section <A HREF="manual_SQL_Syntax.html#BACKUP_TABLE">13.5.2.2  <code>BACKUP TABLE</code> Syntax</A>.

</P>
<P>
Another way to back up a database is to use the <code>mysqldump</code> program or
the <code>mysqlhotcopy script</code>.
See section <A HREF="manual_Client-Side_Scripts.html#mysqldump">8.8  The <code>mysqldump</code> Database Backup Program</A> and
section <A HREF="manual_Client-Side_Scripts.html#mysqlhotcopy">8.9  The <code>mysqlhotcopy</code> Database Backup Program</A>.

</P>

<OL>
<LI>

Do a full backup of your database:


<PRE>
shell&#62; mysqldump --tab=<var>/path/to/some/dir</var> --opt <var>db_name</var>
</PRE>

Or:


<PRE>
shell&#62; mysqlhotcopy <var>db_name</var> <var>/path/to/some/dir</var>
</PRE>

You can also simply copy all table files (<tt>`*.frm'</tt>, <tt>`*.MYD'</tt>, and
<tt>`*.MYI'</tt> files) as long as the server isn't updating anything.
The <code>mysqlhotcopy</code> script uses this method.  (But note that these
methods
will not work if your database contains <code>InnoDB</code> tables.  <code>InnoDB</code>
does not store table contents in database directories, and <code>mysqlhotcopy</code>
works only for <code>MyISAM</code> and <code>ISAM</code> tables.)

<LI>

<A NAME="IDX595"></A>
Stop <code>mysqld</code> if it's running, then start it with the
<code>--log-bin[=file_name]</code> option.  See section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>. The binary
log files provide you with the information you need to replicate
changes to the database that are made subsequent to the point at which
you executed <code>mysqldump</code>.
</OL>

<P>
For <code>InnoDB</code> tables, it's possible to perform an online backup that
takes no locks on tables; see section <A HREF="manual_Client-Side_Scripts.html#mysqldump">8.8  The <code>mysqldump</code> Database Backup Program</A>

</P>
<P>
MySQL supports incremental backups: You need to start the server with the
<code>--log-bin</code> option to enable binary logging; see section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>.
At the moment you want to make an incremental backup (containing all
changes that happened since the last full or incremental backup), you should
rotate the binary log by using <code>FLUSH LOGS</code>. This done, you need to
copy to the backup location all binary logs which range from the one of the
moment of the last full or incremental backup to the last but one. These
binary logs are the incremental backup; at restore time, you apply them
as explained further below. The next time you do a full backup, you should
also rotate the binary log using <code>FLUSH LOGS</code>, <code>mysqldump
--flush-logs</code>, or <code>mysqlhotcopy --flushlogs</code>. See section <A HREF="manual_Client-Side_Scripts.html#mysqldump">8.8  The <code>mysqldump</code> Database Backup Program</A> and section <A HREF="manual_Client-Side_Scripts.html#mysqlhotcopy">8.9  The <code>mysqlhotcopy</code> Database Backup Program</A>.

</P>
<P>
If your MySQL server is a slave replication server, then regardless of the
backup method you choose, you should also back up the
<tt>`master.info'</tt> and <tt>`relay-log.info'</tt> files
when you back up your slave's data. These files
are always needed to resume replication after you restore
the slave's data. If your slave is subject to replicating <code>LOAD
DATA INFILE</code> commands, you should also back up any <tt>`SQL_LOAD-*'</tt> files
that may exist in the directory specified by the <code>--slave-load-tmpdir</code>
option. (This location defaults to the value of the <code>tmpdir</code> variable
if not specified.) The slave needs these files to resume
replication of any interrupted <code>LOAD DATA INFILE</code> operations. 

</P>
<P>
If you have to restore <code>MyISAM</code> tables, try to recover them using
<code>REPAIR TABLE</code> or <code>myisamchk -r</code> first.  That should work in
99.9% of all cases.  If <code>myisamchk</code> fails, try the following procedure.
Note that it will work only if you have enabled binary logging by starting
MySQL with the <code>--log-bin</code> option; see section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>.

</P>

<OL>
<LI>

Restore the original <code>mysqldump</code> backup, or binary backup.
<LI>

Execute the following command to re-run the updates in the binary logs:


<PRE>
shell&#62; mysqlbinlog hostname-bin.[0-9]* | mysql
</PRE>

In your case, you may want to re-run only certain binary logs, from
certain positions (usually you want to re-run all binary logs from the
date of the restored backup, excepting possibly some incorrect queries).
See section <A HREF="manual_Client-Side_Scripts.html#mysqlbinlog">8.5  The <code>mysqlbinlog</code> Binary Log Utility</A> for more information on
the <code>mysqlbinlog</code> utility and how to use it.

If you are using the update logs instead (which is a deprecated feature removed
in MySQL 5.0), you can process their contents like this:


<PRE>
shell&#62; ls -1 -t -r hostname.[0-9]* | xargs cat | mysql
</PRE>

<code>ls</code> is used to sort the update log filenames into the right order.

</OL>

<P>
You can also do selective backups of individual files:

</P>

<UL>
<LI>

To dump the table, use
<code>SELECT * INTO OUTFILE '<var>file_name</var>' FROM <var>tbl_name</var></code>.

<LI>

To reload the table, use and restore with
<code>LOAD DATA INFILE 'file_name' REPLACE ...</code>
To avoid duplicate records, the table must have a <code>PRIMARY KEY</code> or a
<code>UNIQUE</code> index. The <code>REPLACE</code> keyword causes old records
to be replaced with new ones when a new record duplicates an old record on
a unique key value.

</UL>

<P>
If you have performance problems with your server while making backups, one
strategy that can help is to set up replication and perform backups on the
slave rather than on the master.
See section <A HREF="manual_Replication.html#Replication_Intro">6.1  Introduction to Replication</A>.

</P>
<P>
If you are using a Veritas filesystem, you can make a backup like this:

</P>

<OL>
<LI>

From a client program, execute <code>FLUSH TABLES WITH READ LOCK</code>.

<LI>

From another shell, execute <code>mount vxfs snapshot</code>.

<LI>

From the first client, execute <code>UNLOCK TABLES</code>.

<LI>

Copy files from the snapshot.

<LI>

Unmount the snapshot.
</OL>



<H3><A NAME="Table_maintenance" HREF="manual_toc.html#Table_maintenance">5.7.2  Table Maintenance and Crash Recovery</A></H3>

<P>
The following text discusses how to use <code>myisamchk</code> to check or repair
<code>MyISAM</code> tables (tables with <tt>`.MYI'</tt> and <tt>`.MYD'</tt> files).
The same concepts apply to using <code>isamchk</code> to check or repair
<code>ISAM</code> tables (tables with <tt>`.ISM'</tt> and <tt>`.ISD'</tt> files).
See section <A HREF="manual_Storage_engines.html#Storage_engines">14  MySQL Storage Engines and Table Types</A>.

</P>
<P>
You can use the <code>myisamchk</code> utility to get information about your
database tables or to check, repair, or optimize them.  The following
sections describe how to invoke <code>myisamchk</code> (including a
description of its options), how to set up a table maintenance schedule,
and how to use <code>myisamchk</code> to perform its various functions.

</P>
<P>
Even though table repair with <code>myisamchk</code> is quite secure, it's
always a good idea to make a backup <em>before</em> doing a repair (or any
maintenance operation that could make a lot of changes to a table)

</P>
<P>
<code>myisamchk</code> operations that affect indexes can cause
<code>FULLTEXT</code> indexes to be rebuilt with full-text parameters that
are incompatible with the values used by the MySQL server. To avoid this,
read the instructions in
section <A HREF="manual_MySQL_Database_Administration.html#myisamchk_general_options">5.7.2.2  General Options for <code>myisamchk</code></A>.

</P>
<P>
In many cases, you may find it simpler to do <code>MyISAM</code> table maintenance
using the SQL statements that perform operations that <code>myisamchk</code> can
do:

</P>

<UL>
<LI>

To check or repair <code>MyISAM</code> tables, use <code>CHECK TABLE</code> or
<code>REPAIR TABLE</code>.

<LI>

To optimize <code>MyISAM</code> tables, use <code>OPTIMIZE TABLE</code>.

<LI>

To analyze <code>MyISAM</code> tables, use <code>ANALYZE TABLE</code>.

</UL>

<P>
These statements were introduced in different versions, but all are available
from MySQL 3.23.14 on.
See
section <A HREF="manual_SQL_Syntax.html#ANALYZE_TABLE">13.5.2.1  <code>ANALYZE TABLE</code> Syntax</A>,
section <A HREF="manual_SQL_Syntax.html#CHECK_TABLE">13.5.2.3  <code>CHECK TABLE</code> Syntax</A>,
section <A HREF="manual_SQL_Syntax.html#OPTIMIZE_TABLE">13.5.2.5  <code>OPTIMIZE TABLE</code> Syntax</A>,
and section <A HREF="manual_SQL_Syntax.html#REPAIR_TABLE">13.5.2.6  <code>REPAIR TABLE</code> Syntax</A>.
The statements can be used directly, or by means of the <code>mysqlcheck</code>
client program, which provides a command-line interface to them.

</P>
<P>
One advantage of these statements over <code>myisamchk</code> is that the server
does all the work. With <code>myisamchk</code>, you must make sure that the server
does not use the tables at the same time. Otherwise, there can be unwanted
interaction betweeen <code>myisamchk</code> and the server.

</P>



<H4><A NAME="myisamchk_syntax" HREF="manual_toc.html#myisamchk_syntax">5.7.2.1  <code>myisamchk</code> Invocation Syntax</A></H4>

<P>
Invoke <code>myisamchk</code> like this:

</P>

<PRE>
shell&#62; myisamchk [<var>options</var>] <var>tbl_name</var>
</PRE>

<P>
The <var>options</var> specify what you want <code>myisamchk</code> to do.  They are
described in the following sections.  You can also get a list of options by
invoking <code>myisamchk --help</code>.

</P>
<P>
With no options, <code>myisamchk</code> simply checks your table as the default
operation.  To get more information or to tell <code>myisamchk</code> to take
corrective action, specify options as described in the following discussion.

</P>
<P>
<var>tbl_name</var> is the database table you want to check or repair.  If you run
<code>myisamchk</code> somewhere other than in the database directory, you must
specify the path to the database directory, because <code>myisamchk</code> has no
idea where the
database is located.  In fact, <code>myisamchk</code> doesn't actually care whether
the files you are working on are located in a database directory. You can
copy the files that correspond to a database table into some other location and
perform recovery operations on them there.

</P>
<P>
You can name several tables on the <code>myisamchk</code> command line if you
wish.  You can also specify a table by naming its index file (the file with
the <tt>`.MYI'</tt> suffix). This allows you to specify all tables in a
directory by using the pattern <tt>`*.MYI'</tt>.  For example, if you are in a
database directory, you can check all the <code>MyISAM</code> tables in that
directory like this:

</P>

<PRE>
shell&#62; myisamchk *.MYI
</PRE>

<P>
If you are not in the database directory, you can check all the tables there
by specifying the path to the directory:

</P>

<PRE>
shell&#62; myisamchk /path/to/database_dir/*.MYI
</PRE>

<P>
You can even check all tables in all databases by specifying a wildcard
with the path to the MySQL data directory:

</P>

<PRE>
shell&#62; myisamchk /path/to/datadir/*/*.MYI
</PRE>

<P>
The recommended way to quickly check all <code>MyISAM</code> and <code>ISAM</code>
tables is:

</P>

<PRE>
shell&#62; myisamchk --silent --fast /path/to/datadir/*/*.MYI
shell&#62; isamchk --silent /path/to/datadir/*/*.ISM
</PRE>

<P>
If you want to check all <code>MyISAM</code> and <code>ISAM</code> tables and repair any
that are corrupted, you can use the following commands:

</P>

<PRE>
shell&#62; myisamchk --silent --force --fast --update-state \
          -O key_buffer=64M -O sort_buffer=64M \
          -O read_buffer=1M -O write_buffer=1M \
          /path/to/datadir/*/*.MYI
shell&#62; isamchk --silent --force -O key_buffer=64M \
          -O sort_buffer=64M -O read_buffer=1M -O write_buffer=1M \
          /path/to/datadir/*/*.ISM
</PRE>

<P>
These commands assume that you have more than 64MB free.
For more information about memory allocation with <code>myisamchk</code>, see
section <A HREF="manual_MySQL_Database_Administration.html#myisamchk_memory">5.7.2.6  <code>myisamchk</code> Memory Usage</A>.

</P>
<P>
You must ensure that no other program is using the tables while you are
running <code>myisamchk</code>.  Otherwise, when you run <code>myisamchk</code>, it may
display the following error message:

</P>

<PRE>
warning: clients are using or haven't closed the table properly
</PRE>

<P>
This means that you are trying to check a table that has been updated by
another program (such as the <code>mysqld</code> server) that hasn't yet closed
the file or that has died without closing the file properly.

</P>
<P>
If <code>mysqld</code> is running, you must force it to flush any table
modifications that are still buffered in memory by using <code>FLUSH
TABLES</code>. You should then ensure that no one is using the tables while you
are running <code>myisamchk</code>.  The easiest way to
avoid this problem is to use <code>CHECK TABLE</code> instead of <code>myisamchk</code>
to check tables.

</P>


<H4><A NAME="myisamchk_general_options" HREF="manual_toc.html#myisamchk_general_options">5.7.2.2  General Options for <code>myisamchk</code></A></H4>

<P>
<A NAME="IDX596"></A>
<A NAME="IDX597"></A>

</P>
<P>
The options described in this section can be used for any
type of table maintenance operation performed by <code>myisamchk</code>.
The sections following this one describe options that pertain only to specific
operations, such as table checking or repairing.

</P>
<DL COMPACT>

<DT><code>--help, -?</code>
<DD>
Display a help message and exit.

<DT><code>--debug=<var>debug_options</var>, -# <var>debug_options</var></code>
<DD>
Write a debugging log. The <var>debug_options</var> string often is
<code>'d:t:o,<var>file_name</var>'</code>.

<DT><code>--silent, -s</code>
<DD>
Silent mode.  Write output only when errors occur. You can use <code>-s</code>
twice (<code>-ss</code>) to make <code>myisamchk</code> very silent.

<DT><code>--verbose, -v</code>
<DD>
Verbose mode.  Print more information. This can be used with <code>-d</code> and
<code>-e</code>. Use <code>-v</code> multiple times (<code>-vv</code>, <code>-vvv</code>) for even
more output.

<DT><code>--version, -V</code>
<DD>
Display version information and exit.

<DT><code>--wait, -w</code>
<DD>
Instead of terminating with an error if the table is locked, wait until the
table is unlocked before continuing.  Note that if you are running
<code>mysqld</code> with the <code>--skip-external-locking</code> option, the table can
be locked only by another <code>myisamchk</code> command.

</DL>

<P>
You can also set the following variables by using <code>--<var>var_name</var>=<var>value</var></code>
options:

</P>
<P>
<A NAME="IDX598"></A>
<A NAME="IDX599"></A>
<A NAME="IDX600"></A>
<A NAME="IDX601"></A>
<A NAME="IDX602"></A>
<A NAME="IDX603"></A>
<A NAME="IDX604"></A>
<A NAME="IDX605"></A>
<A NAME="IDX606"></A>
<A NAME="IDX607"></A>

</P>
<TABLE BORDER>
<TR><TD><strong>Variable</strong> </TD><TD> <strong>Default Value</strong>
</TD></TR>
<TR><TD><code>decode_bits</code> </TD><TD> 9
</TD></TR>
<TR><TD><code>ft_max_word_len</code> </TD><TD> version-dependent
</TD></TR>
<TR><TD><code>ft_min_word_len</code> </TD><TD> 4
</TD></TR>
<TR><TD><code>ft_stopword_file</code> </TD><TD> built-in list
</TD></TR>
<TR><TD><code>key_buffer_size</code> </TD><TD> 523264
</TD></TR>
<TR><TD><code>myisam_block_size</code> </TD><TD> 1024
</TD></TR>
<TR><TD><code>read_buffer_size</code> </TD><TD> 262136
</TD></TR>
<TR><TD><code>sort_buffer_size</code> </TD><TD> 2097144
</TD></TR>
<TR><TD><code>sort_key_blocks</code> </TD><TD> 16
</TD></TR>
<TR><TD><code>write_buffer_size</code> </TD><TD> 262136
</TD></TR>
</TABLE>

<P>
It is also possible to set variables by using
<code>--set-variable=<var>var_name</var>=<var>value</var></code> or <code>-O <var>var_name</var>=<var>value</var></code>
syntax. However, this syntax is deprecated as of MySQL 4.0.

</P>
<P>
The possible <code>myisamchk</code> variables and their default values
can be examined with <code>myisamchk --help</code>:

</P>
<P>
<code>sort_buffer_size</code> is used when the keys are repaired by sorting
keys, which is the normal case when you use <code>--recover</code>.

</P>
<P>
<code>key_buffer_size</code> is used when you are checking the table with
<code>--extend-check</code> or when the keys are repaired by inserting keys
row by row into the table (like when doing normal inserts). Repairing
through the key buffer is used in the following cases:

</P>

<UL>

<LI>

You use <code>--safe-recover</code>.

<LI>

The temporary files needed to sort the keys would be more than twice as
big as when creating the key file directly.  This is often the case when you
have large key values for  <code>CHAR</code>, <code>VARCHAR</code>, or <code>TEXT</code>
columns, because the sort operation needs to store the complete key values
as it proceeds. If you have lots of temporary space and you can force
<code>myisamchk</code> to repair by sorting, you can use the <code>--sort-recover</code>
option.

</UL>

<P>
Repairing through the key buffer takes much less disk space than using
sorting, but is also much slower.

</P>
<P>
If you want a faster repair, set the <code>key_buffer_size</code> and
<code>sort_buffer_size</code> variables to about 25% of your available memory.
You can set both variables to large values, because only one of them is used
at a time.

</P>
<P>
<code>myisam_block_size</code> is the size used for index blocks. It is available
as of MySQL 4.0.0.

</P>
<P>
The <code>ft_min_word_len</code> and <code>ft_max_word_len</code> variables are
available as of MySQL 4.0.0.  <code>ft_stopword_file</code> is available as of
MySQL 4.0.19.

</P>
<P>
<code>ft_min_word_len</code> and <code>ft_max_word_len</code> indicate the minimum and
maximum word length for <code>FULLTEXT</code> indexes. <code>ft_stopword_file</code>
names the stopword file. These need to be set under the following
circumstances.

</P>
<P>
If you use <code>myisamchk</code> to perform an operation that modifies
table indexes (such as repair or analyze), the <code>FULLTEXT</code> indexes
are rebuilt using the default full-text parameter values for minimum and
maximum word length and the stopword file unless you specify otherwise.
This can result in queries failing.

</P>
<P>
The problem occurs because these parameters are known only by the server.
They are not stored in <code>MyISAM</code> index files.  To avoid the problem if
you have modified the minimum or maximum word length or the stopword file in
the server, specify the same <code>ft_min_word_len</code>, <code>ft_max_word_len</code>,
and <code>ft_stopword_file</code> values to <code>myisamchk</code> that you use for
<code>mysqld</code>. For example, if you have set the minimum word length to 3,
you can repair a table with <code>myisamchk</code> like this:

</P>

<PRE>
shell&#62; myisamchk --recover --ft_min_word_len=3 <var>tbl_name</var>.MYI
</PRE>

<P>
To ensure that <code>myisamchk</code> and the server use the same values for
full-text parameters, you can place each one in both the <code>[mysqld]</code>
and <code>[myisamchk]</code> sections of an option file:

</P>

<PRE>
[mysqld]
ft_min_word_len=3

[myisamchk]
ft_min_word_len=3
</PRE>

<P>
An alternative to using <code>myisamchk</code> is to use the <code>REPAIR TABLE</code>,
<code>ANALYZE TABLE</code>, <code>OPTIMIZE TABLE</code>, or <code>ALTER TABLE</code>.
These statements are performed by the server, which knows the proper
full-text parameter values to use.

</P>



<H4><A NAME="myisamchk_check_options" HREF="manual_toc.html#myisamchk_check_options">5.7.2.3  Check Options for <code>myisamchk</code></A></H4>

<P>
<A NAME="IDX608"></A>
<A NAME="IDX609"></A>

</P>
<P>
<code>myisamchk</code> supports the following options for table checking operations:

</P>
<DL COMPACT>

<DT><code>--check, -c</code>
<DD>
Check the table for errors. This is the default operation if you specify no
option that selects an operation type explicitly.

<DT><code>--check-only-changed, -C</code>
<DD>
Check only tables that have changed since the last check.

<DT><code>--extend-check, -e</code>
<DD>
Check the table very thoroughly. This is quite slow if the table has many
indexes.  This option should only be used in extreme cases.  Normally,
<code>myisamchk</code> or <code>myisamchk --medium-check</code> should
be able to determine whether there are any errors in the table.

If you are using <code>--extend-check</code> and have plenty of memory, setting
the <code>key_buffer_size</code> variable to a large value will help the repair
operation run faster.

<DT><code>--fast, -F</code>
<DD>
Check only tables that haven't been closed properly.

<DT><code>--force, -f</code>
<DD>
Do a repair operation automatically if
<code>myisamchk</code> finds any errors in the table.
The repair type is the same as that specified with the <code>--repair</code> or
<code>-r</code> option.

<DT><code>--information, -i</code>
<DD>
Print informational statistics about the table that is checked.

<DT><code>--medium-check, -m</code>
<DD>
Do a check that is faster than an <code>--extend-check</code> operation.
This finds only 99.99% of all errors, which should be good enough in most cases.

<DT><code>--read-only, -T</code>
<DD>
Don't mark the table as checked. This is useful if you use <code>myisamchk</code>
to check a table that is in use by some other application that doesn't
use locking, such as <code>mysqld</code> when run with the
<code>--skip-external-locking</code> option.

<DT><code>--update-state, -U</code>
<DD>
Store information in the <tt>`.MYI'</tt> file to indicate when the table was
checked and whether the table crashed.  This should be used to get full benefit of the
<code>--check-only-changed</code> option, but you shouldn't use this
option if the <code>mysqld</code> server is using the table and you are
running it with the <code>--skip-external-locking</code> option.

</DL>



<H4><A NAME="myisamchk_repair_options" HREF="manual_toc.html#myisamchk_repair_options">5.7.2.4  Repair Options for <code>myisamchk</code></A></H4>

<P>
<A NAME="IDX610"></A>
<A NAME="IDX611"></A>

</P>
<P>
<code>myisamchk</code> supports the following options for table repair operations:

</P>
<DL COMPACT>

<DT><code>--backup, -B</code>
<DD>
Make a backup of the <tt>`.MYD'</tt> file as <tt>`file_name-time.BAK'</tt>

<DT><code>--character-sets-dir=<var>path</var></code>
<DD>
The directory where character sets are installed.  See section <A HREF="manual_MySQL_Database_Administration.html#Character_sets">5.8.1  The Character Set Used for Data and Sorting</A>.

<DT><code>--correct-checksum</code>
<DD>
Correct the checksum information for the table.

<DT><code>--data-file-length=<var>#</var>, -D <var>#</var></code>
<DD>
Maximum length of the data file (when re-creating data file when it's ``full'').

<DT><code>--extend-check, -e</code>
<DD>
Do a repair that tries
to recover every possible row from the data file.
Normally this will also find a lot of garbage rows. Don't use this option
unless you are totally desperate.

<DT><code>--force, -f</code>
<DD>
Overwrite old temporary files (files with names like <tt>`<var>tbl_name</var>.TMD'</tt>)
instead of aborting.

<DT><code>--keys-used=<var>#</var>, -k <var>#</var></code>
<DD>
For <code>myisamchk</code>, the option value indicates which indexes to update.
Each binary bit of the option value corresponds to a table index, where the
first index is bit 0.
For <code>isamchk</code>, the option value indicates that only the first <var>#</var> of
the table indexes should be updated.
In either case, an option value of 0 disables updates to all indexes, which
can be used to get faster inserts.
Deactivated indexes can be reactivated by using <code>myisamchk -r</code>
or (<code>isamchk -r</code>).

<DT><code>--no-symlinks, -l</code>
<DD>
Do not follow symbolic links. Normally <code>myisamchk</code> repairs the
table that a symlink points to.  This option doesn't exist as of MySQL 4.0,
because versions from 4.0 on will not remove symlinks during repair operations.

<DT><code>--parallel-recover, -p</code>
<DD>
Uses the same technique as <code>-r</code> and <code>-n</code>, but creates
all the keys in parallel, using different threads.
This option was added in MySQL 4.0.2.
<em>This is alpha code. Use at your own risk!</em>

<DT><code>--quick, -q</code>
<DD>
Achieve a faster repair by not modifying the data file. You can specify this
option twice to force <code>myisamchk</code> to modify the original data file in
case of duplicate keys.

<DT><code>--recover, -r</code>
<DD>
Do a repair that can fix almost any problem except unique keys that aren't
unique (which is an extremely unlikely error with <code>ISAM</code>/<code>MyISAM</code>
tables).  If you want to recover a table, this is the option to try
first. You should try <code>-o</code> only if <code>myisamchk</code> reports that the
table can't be recovered by <code>-r</code>.  (In the unlikely case
that <code>-r</code> fails, the data file is still intact.)

If you have lots of memory, you should increase the value of
<code>sort_buffer_size</code>.

<DT><code>--safe-recover, -o</code>
<DD>
Do a repair using
an old recovery method that reads through all rows in order and updates
all index trees based on the rows found.  This is an order of magnitude
slower than <code>-r</code>, but can handle a couple of very unlikely cases that
<code>-r</code> cannot.  This recovery method also uses much less disk
space than <code>-r</code>. Normally, you should repair first with
<code>-r</code>, and then with <code>-o</code> only if <code>-r</code> fails.

If you have lots of memory, you should increase the value of
<code>key_buffer_size</code>.

<DT><code>--set-character-set=<var>name</var></code>
<DD>
Change the character set used by the table indexes.

<DT><code>--sort-recover, -n</code>
<DD>
Force <code>myisamchk</code> to use sorting to resolve the keys even if the
temporary files should be very big.

<DT><code>--tmpdir=<var>path</var>, -t <var>path</var></code>
<DD>
Path of the directory to be used for storing temporary files. If this is not
set, <code>myisamchk</code> uses the value of the <code>TMPDIR</code> environment variable.
Starting from MySQL 4.1, <code>tmpdir</code> can be set to a list of directory paths
that will be used successively in round-robin fashion for creating
temporary files. The separator character between directory names should be
colon (<samp>`:'</samp>) on Unix and semicolon (<samp>`;'</samp>) on Windows, NetWare, and
OS/2.

<DT><code>--unpack, -u</code>
<DD>
Unpack a table that was packed with <code>myisampack</code>.
</DL>



<H4><A NAME="myisamchk_other_options" HREF="manual_toc.html#myisamchk_other_options">5.7.2.5  Other Options for <code>myisamchk</code></A></H4>

<P>
<code>myisamchk</code> supports the following options for actions other than
table checks and repairs:

</P>
<DL COMPACT>

<DT><code>--analyze, -a</code>
<DD>
Analyze the distribution of keys. This improves join performance by enabling
the join optimizer to better choose the order in which to join the tables
and which keys it should use. To obtain information about the distribution,
use a <code>myisamchk --description --verbose <var>tbl_name</var></code> command or the
<code>SHOW KEYS FROM <var>tbl_name</var></code> statement.

<DT><code>--description, -d</code>
<DD>
Print some descriptive information about the table.

<DT><code>--set-auto-increment[=<var>value</var>], -A[<var>value</var>]</code>
<DD>
Force <code>AUTO_INCREMENT</code> numbering for new records to start at the given
value (or higher, if there are already records with <code>AUTO_INCREMENT</code>
values this large). If <var>value</var> is not specified, <code>AUTO_INCREMENT</code>
number for new records begins with the largest value currently in the table,
plus one.

<DT><code>--sort-index, -S</code>
<DD>
Sort the index tree blocks in high-low order.
This optimizes seeks and makes table scanning by key faster.

<DT><code>--sort-records=<var>#</var>, -R <var>#</var></code>
<DD>
Sort records according to a particular index.  This makes your data much
more localized and may speed up range-based <code>SELECT</code> and <code>ORDER
BY</code> operations that use this index. (The first time you use this option to
sort a table, it may be very slow.) To determine a table's index numbers,
use <code>SHOW KEYS</code>, which displays a table's indexes in the same order
that <code>myisamchk</code> sees them.  Indexes are numbered beginning with 1.

</DL>



<H4><A NAME="myisamchk_memory" HREF="manual_toc.html#myisamchk_memory">5.7.2.6  <code>myisamchk</code> Memory Usage</A></H4>

<P>
<A NAME="IDX612"></A>

</P>
<P>
Memory allocation is important when you run <code>myisamchk</code>.
<code>myisamchk</code> uses no more memory than you specify with the <code>-O</code>
options.  If you are going to use <code>myisamchk</code> on very large tables,
you should first decide how much memory you want it to use.  The default
is to use only about 3MB to perform repairs.  By using larger values, you can
get <code>myisamchk</code> to operate faster.  For example, if you have more
than 32MB RAM, you could use options such as these (in addition to any
other options you might specify):

</P>

<PRE>
shell&#62; myisamchk -O sort=16M -O key=16M -O read=1M -O write=1M ...
</PRE>

<P>
Using <code>-O sort=16M</code> should probably be enough for most cases.

</P>
<P>
Be aware that <code>myisamchk</code> uses temporary files in <code>TMPDIR</code>. If
<code>TMPDIR</code> points to a memory filesystem, you may easily get out of
memory errors. If this happens, set <code>TMPDIR</code> to point at some directory
located on a filesystem
with more space and run <code>myisamchk</code> again.

</P>
<P>
When repairing, <code>myisamchk</code> will also need a lot of disk space:

</P>

<UL>
<LI>

Double the size of the data file (the original one and a copy).  This
space is not needed if you do a repair with <code>--quick</code>; in this
case, only the index file is re-created.  This space is needed on the same
filesystem as the original data file! (The copy is created in the
same directory as the original.)

<LI>

Space for the new index file that replaces the old one. The old index file
is truncated at the start of the repair operation, so you usually ignore
this space.  This space is needed on the same filesystem as the original
index file!

<LI>

When using <code>--recover</code> or <code>--sort-recover</code>
(but not when using <code>--safe-recover</code>), you will need space for a
sort buffer. The amount of space required is:


<PRE>
(<var>largest_key</var> + <var>row_pointer_length</var>) * <var>number_of_rows</var> * 2
</PRE>

You can check the length of the keys and the <code>row_pointer_length</code>
with <code>myisamchk -dv <var>tbl_name</var></code>.  This space is allocated in the temporary
directory (specified by <code>TMPDIR</code> or <code>--tmpdir=<var>path</var></code>).

</UL>

<P>
If you have a problem with disk space during repair, you can try to use
<code>--safe-recover</code> instead of <code>--recover</code>.

</P>



<H4><A NAME="Crash_recovery" HREF="manual_toc.html#Crash_recovery">5.7.2.7  Using <code>myisamchk</code> for Crash Recovery</A></H4>

<P>
<A NAME="IDX613"></A>
<A NAME="IDX614"></A>

</P>
<P>
If you run <code>mysqld</code> with <code>--skip-external-locking</code> (which is the
default on some systems, such as Linux), you can't reliably use <code>myisamchk</code>
to check a table when <code>mysqld</code> is using the same table.  If you
can be sure that no one is accessing the tables through <code>mysqld</code>
while you run <code>myisamchk</code>, you only have to do <code>mysqladmin
flush-tables</code> before you start checking the tables.  If you can't
guarantee this, then you must stop <code>mysqld</code> while you
check the tables.  If you run <code>myisamchk</code> while <code>mysqld</code> is updating
the tables, you may get a warning that a table is corrupt even when it
isn't.

</P>
<P>
If you are not using <code>--skip-external-locking</code>, you can use
<code>myisamchk</code> to check tables at any time.  While you do this, all clients
that try to update the table will wait until <code>myisamchk</code> is ready before
continuing.

</P>
<P>
If you use <code>myisamchk</code> to repair or optimize tables, you
<em>must</em> always ensure that the <code>mysqld</code> server is not using
the table (this also applies if you are using <code>--skip-external-locking</code>).
If you don't take down <code>mysqld</code>, you should at least do a
<code>mysqladmin flush-tables</code> before you run <code>myisamchk</code>.
Your tables <em>may become corrupted</em> if the server and <code>myisamchk</code>
access the tables simultaneously.

</P>
<P>
This section describes how to check for and deal with data corruption
in MySQL databases.  If your tables get corrupted frequently you should
try to find the reason why.
See section <A HREF="manual_Problems.html#Crashing">A.4.2  What to Do If MySQL Keeps Crashing</A>.

</P>
<P>
The <code>MyISAM</code> table section contains reason for why a table could be
corrupted. See section <A HREF="manual_Storage_engines.html#MyISAM_table_problems">14.1.4  <code>MyISAM</code> Table Problems</A>.

</P>
<P>
When performing crash recovery, it is important to understand that each
<code>MyISAM</code> table <var>tbl_name</var> in a database corresponds to three files
in the database directory:

</P>
<TABLE BORDER>
<TR><TD><strong>File</strong> </TD><TD> <strong>Purpose</strong>
</TD></TR>
<TR><TD><tt>`<var>tbl_name</var>.frm'</tt> </TD><TD> Definition (format) file
</TD></TR>
<TR><TD><tt>`<var>tbl_name</var>.MYD'</tt> </TD><TD> Data file
</TD></TR>
<TR><TD><tt>`<var>tbl_name</var>.MYI'</tt> </TD><TD> Index file
</TD></TR>
</TABLE>

<P>
Each of these three file types is subject to corruption in various ways, but
problems occur most often in data files and index files.

</P>
<P>
<code>myisamchk</code> works by creating a copy of the <tt>`.MYD'</tt> data file
row by row. It ends the repair stage by removing the old <tt>`.MYD'</tt>
file and renaming the new file to the original file name.  If you use
<code>--quick</code>, <code>myisamchk</code> does not create a temporary <tt>`.MYD'</tt>
file, but instead assumes that the <tt>`.MYD'</tt> file is correct and only
generates a new index file without touching the <tt>`.MYD'</tt> file. This is
safe, because <code>myisamchk</code> automatically detects whether the <tt>`.MYD'</tt>
file is corrupt and aborts the repair if it is.  You can also specify
the <code>--quick</code> option twice to <code>myisamchk</code>.  In this case,
<code>myisamchk</code> does not abort on some errors (such as duplicate-key
errors) but instead tries to resolve them by modifying the <tt>`.MYD'</tt>
file. Normally the use of two <code>--quick</code> options is useful only if you
have too little free disk space to perform a normal repair.  In this case,
you should at least make a backup before running <code>myisamchk</code>.

</P>



<H4><A NAME="Check" HREF="manual_toc.html#Check">5.7.2.8  How to Check <code>MyISAM</code> Tables for Errors</A></H4>

<P>
<A NAME="IDX615"></A>
<A NAME="IDX616"></A>
<A NAME="IDX617"></A>

</P>
<P>
To check a <code>MyISAM</code> table, use the following commands:

</P>
<DL COMPACT>

<DT><code>myisamchk <var>tbl_name</var></code>
<DD>
This finds 99.99% of all errors. What it can't find is corruption that
involves <em>only</em> the data file (which is very unusual). If you want
to check a table, you should normally run <code>myisamchk</code> without options or
with either the <code>-s</code> or <code>--silent</code> option.

<DT><code>myisamchk -m <var>tbl_name</var></code>
<DD>
This finds 99.999% of all errors. It first checks all index entries for
errors and then reads through all rows. It calculates a checksum for
all keys in the rows and verifies that the checksum matches the checksum
for the keys in the index tree.

<DT><code>myisamchk -e <var>tbl_name</var></code>
<DD>
This does a complete and thorough check of all data (<code>-e</code> means
``extended check''). It does a check-read of every key for each row to verify
that they indeed point to the correct row.  This may take a long time for a
large table that has many indexes.  Normally, <code>myisamchk</code> stops after
the first error it finds. If you want to obtain more information, you can
add the <code>--verbose</code> (<code>-v</code>) option.  This causes <code>myisamchk</code>
to keep going, up through a maximum of 20 errors.

<DT><code>myisamchk -e -i <var>tbl_name</var></code>
<DD>
Like the previous command, but the <code>-i</code> option tells <code>myisamchk</code> to
print some informational statistics, too.

</DL>

<P>
In most cases, a simple <code>myisamchk</code> with no arguments other than the
table name is sufficient to check a table.

</P>



<H4><A NAME="Repair" HREF="manual_toc.html#Repair">5.7.2.9  How to Repair Tables</A></H4>

<P>
<A NAME="IDX618"></A>
<A NAME="IDX619"></A>

</P>
<P>
The discussion in this section describes how to use <code>myisamchk</code> on
<code>MyISAM</code> tables (extensions <tt>`.MYI'</tt> and <tt>`.MYD'</tt>).  If you
are using <code>ISAM</code> tables (extensions <tt>`.ISM'</tt> and <tt>`.ISD'</tt>),
you should use <code>isamchk</code> instead; the concepts are similar.

</P>
<P>
If you are using MySQL 3.23.16 and above, you can (and
should) use the <code>CHECK TABLE</code> and <code>REPAIR TABLE</code> statements to
check and repair <code>MyISAM</code> tables.
See section <A HREF="manual_SQL_Syntax.html#CHECK_TABLE">13.5.2.3  <code>CHECK TABLE</code> Syntax</A>
and section <A HREF="manual_SQL_Syntax.html#REPAIR_TABLE">13.5.2.6  <code>REPAIR TABLE</code> Syntax</A>.

</P>
<P>
The symptoms of a corrupted table include queries that abort unexpectedly
and observable errors such as these:

</P>

<UL>
<LI>

<tt>`<var>tbl_name</var>.frm'</tt> is locked against change
<LI>

Can't find file <tt>`<var>tbl_name</var>.MYI'</tt> (Errcode: <var>###</var>)
<LI>

Unexpected end of file
<LI>

Record file is crashed
<LI>

Got error <var>###</var> from table handler
</UL>

<P>
To get more information about the error you can run <code>perror</code> <var>###</var>,
where <var>###</var> is the error number. The following example shows how to use
<code>perror</code> to find the meanings for the most common error numbers that
indicate a problem with a table:

</P>

<PRE>
shell&#62; perror 126 127 132 134 135 136 141 144 145
126 = Index file is crashed / Wrong file format
127 = Record-file is crashed
132 = Old database file
134 = Record was already deleted (or record file crashed)
135 = No more room in record file
136 = No more room in index file
141 = Duplicate unique key or constraint on write or update
144 = Table is crashed and last repair failed
145 = Table was marked as crashed and should be repaired
</PRE>

<P>
Note that error 135 (no more room in record file) and error 136 (no more
room in index file) are not errors that can be fixed by a simple repair. In
this case, you have to use <code>ALTER TABLE</code> to increase the
<code>MAX_ROWS</code> and <code>AVG_ROW_LENGTH</code> table option values:

</P>

<PRE>
ALTER TABLE <var>tbl_name</var> MAX_ROWS=<var>xxx</var> AVG_ROW_LENGTH=<var>yyy</var>;
</PRE>

<P>
If you don't know the current table option values, use <code>SHOW CREATE TABLE
tbl_name</code>.

</P>
<P>
For the other errors, you must repair your tables. <code>myisamchk</code> can
usually detect and fix most problems that occur.

</P>
<P>
The repair process involves up to four stages, described here. Before you
begin, you should change location to the database directory and check the
permissions of the table files. On Unix, make sure that they are readable by
the user that <code>mysqld</code> runs as (and to you, because you need to access
the files you are checking).  If it turns out you need to modify files, they
must also be writable by you.

</P>
<P>
The options that you can use for table maintenance with <code>myisamchk</code>
and <code>isamchk</code> are described in several of the earlier subsections of
section <A HREF="manual_MySQL_Database_Administration.html#Table_maintenance">5.7.2  Table Maintenance and Crash Recovery</A>.

</P>
<P>
The following section is for the cases where the above command fails or
if you want to use the extended features that <code>myisamchk</code> and
<code>isamchk</code> provide.

</P>
<P>
If you are going to repair a table from the command line, you must first
stop the <code>mysqld</code> server. Note that when you do
<code>mysqladmin shutdown</code> on a remote server, the <code>mysqld</code> server
will still be alive for a while after <code>mysqladmin</code> returns, until
all queries are stopped and all keys have been flushed to disk.

</P>
<P>
<strong>Stage 1: Checking your tables</strong>

</P>
<P>
Run <code>myisamchk *.MYI</code> or <code>myisamchk -e *.MYI</code> if you have
more time.  Use the <code>-s</code> (silent) option to suppress unnecessary
information.

</P>
<P>
If the <code>mysqld</code> server is down, you should use the <code>--update-state</code>
option to tell <code>myisamchk</code> to mark the table as 'checked'.

</P>
<P>
You have to repair only those tables for which <code>myisamchk</code> announces an
error.  For such tables, proceed to Stage 2.

</P>
<P>
If you get weird errors when checking (such as <code>out of
memory</code> errors), or if <code>myisamchk</code> crashes, go to Stage 3.

</P>
<P>
<strong>Stage 2: Easy safe repair</strong>

</P>
<P>
Note: If you want a repair operation to go much faster, you should set the
values of the <code>sort_buffer_size</code> and <code>key_buffer_size</code> variables
each to about 25% of your available memory when running <code>myisamchk</code>
or <code>isamchk</code>.

</P>
<P>
First, try <code>myisamchk -r -q <var>tbl_name</var></code> (<code>-r -q</code> means ``quick
recovery mode''). This will attempt to repair the index file without
touching the data file.  If the data file contains everything that it
should and the delete links point at the correct locations within the
data file, this should work, and the table is fixed. Start repairing the
next table.  Otherwise, use the following procedure:

</P>

<OL>
<LI>

Make a backup of the data file before continuing.

<LI>

Use <code>myisamchk -r <var>tbl_name</var></code> (<code>-r</code> means ``recovery mode''). This will
remove incorrect records and deleted records from the data file and
reconstruct the index file.

<LI>

If the preceding step fails, use <code>myisamchk --safe-recover <var>tbl_name</var></code>.
Safe recovery mode uses an old recovery method that handles a few cases that
regular recovery mode doesn't (but is slower).
</OL>

<P>
If you get weird errors when repairing (such as <code>out of
memory</code> errors), or if <code>myisamchk</code> crashes, go to Stage 3.

</P>
<P>
<strong>Stage 3: Difficult repair</strong>

</P>
<P>
You should reach this stage only if the first 16KB block in the index file is
destroyed or contains incorrect information, or if the index file is
missing.  In this case, it's necessary to create a new index file. Do so as
follows:

</P>

<OL>
<LI>

Move the data file to some safe place.

<LI>

Use the table description file to create new (empty) data and index files:


<PRE>
shell&#62; mysql <var>db_name</var>
mysql&#62; SET AUTOCOMMIT=1;
mysql&#62; TRUNCATE TABLE <var>tbl_name</var>;
mysql&#62; quit
</PRE>

If your version of MySQL doesn't have <code>TRUNCATE TABLE</code>, use
<code>DELETE FROM <var>tbl_name</var></code> instead.

<LI>

Copy the old data file back onto the newly created data file.
(Don't just move the old file back onto the new file; you want to retain
a copy in case something goes wrong.)
</OL>

<P>
Go back to Stage 2.  <code>myisamchk -r -q</code> should work now.  (This shouldn't
be an endless loop.)

</P>
<P>
As of MySQL 4.0.2, you can also use <code>REPAIR TABLE <var>tbl_name</var> USE_FRM</code>,
which performs the whole procedure automatically.

</P>
<P>
<strong>Stage 4: Very difficult repair</strong>

</P>
<P>
You should reach this stage only if the <tt>`.frm'</tt> description file has also
crashed. That should never happen, because the description file isn't changed
after the table is created:

</P>

<OL>
<LI>

Restore the description file from a backup and go back to Stage 3.  You can
also restore the index file and go back to Stage 2.  In the latter case, you
should start with <code>myisamchk -r</code>.

<LI>

If you don't have a backup but know exactly how the table was created,
create a copy of the table in another database.  Remove the new data file,
then move the <tt>`.frm'</tt> description and <tt>`.MYI'</tt> index files from the
other database to your crashed database.  This gives you new description
and index files, but leaves the <tt>`.MYD'</tt> data file alone.  Go back to
Stage 2 and attempt to reconstruct the index file.

</OL>



<H4><A NAME="Optimization" HREF="manual_toc.html#Optimization">5.7.2.10  Table Optimization</A></H4>

<P>
<A NAME="IDX620"></A>
<A NAME="IDX621"></A>

</P>
<P>
To coalesce fragmented records and eliminate wasted space resulting from
deleting or updating records, run <code>myisamchk</code> in recovery mode:

</P>

<PRE>
shell&#62; myisamchk -r <var>tbl_name</var>
</PRE>

<P>
You can optimize a table in the same way by using the SQL <code>OPTIMIZE TABLE</code>
statement.  <code>OPTIMIZE TABLE</code> does a repair of the table and a key
analysis, and also sorts the index tree to give faster key lookups.
There is also no possibility of unwanted interaction between a utility
and the server, because the server does all the work when you use
<code>OPTIMIZE TABLE</code>. See section <A HREF="manual_SQL_Syntax.html#OPTIMIZE_TABLE">13.5.2.5  <code>OPTIMIZE TABLE</code> Syntax</A>.

</P>
<P>
<code>myisamchk</code> also has a number of other options you can use to improve
the performance of a table:

</P>

<UL>
<LI><code>-S</code>, <code>--sort-index</code>

<LI><code>-R <var>index_num</var></code>, <code>--sort-records=<var>index_num</var></code>

<LI><code>-a</code>, <code>--analyze</code>

</UL>

<P>
For a full description of the options, see section <A HREF="manual_MySQL_Database_Administration.html#myisamchk_syntax">5.7.2.1  <code>myisamchk</code> Invocation Syntax</A>.

</P>



<H3><A NAME="Maintenance_schedule" HREF="manual_toc.html#Maintenance_schedule">5.7.3  Setting Up a Table Maintenance Schedule</A></H3>

<P>
<A NAME="IDX622"></A>
<A NAME="IDX623"></A>

</P>
<P>
It is a good idea to perform table checks on a regular basis rather than
waiting for problems to occur.
One way to check and repair <code>MyISAM</code> tables is
with the <code>CHECK TABLE</code> and <code>REPAIR TABLE</code> statements.
These are available starting with MySQL 3.23.16.
See section <A HREF="manual_SQL_Syntax.html#CHECK_TABLE">13.5.2.3  <code>CHECK TABLE</code> Syntax</A> and
section <A HREF="manual_SQL_Syntax.html#REPAIR_TABLE">13.5.2.6  <code>REPAIR TABLE</code> Syntax</A>.

</P>
<P>
Another way to check tables is to use <code>myisamchk</code>.  For maintenance
purposes, you can use <code>myisamchk -s</code>.  The <code>-s</code> option (short for
<code>--silent</code>) causes <code>myisamchk</code> to run in silent mode, printing
messages only when errors occur.

</P>
<P>
<A NAME="IDX624"></A>
It's also a good idea to check tables when the server starts.
For example, whenever the machine has done a restart in the middle of an
update, you usually need to check all the tables that could have been
affected. (These are ``expected crashed tables.'')
To check <code>MyISAM</code> tables automatically, start the server with the <code>--myisam-recover</code> option, available as of MySQL 3.23.25.
If your server is too old to support this option, you could
add a test to
<code>mysqld_safe</code> that runs <code>myisamchk</code> to check all tables that have
been modified during the last 24 hours if there is an old <tt>`.pid'</tt>
(process ID) file left after a restart.  (The <tt>`.pid'</tt> file is created by
<code>mysqld</code> when it starts and removed when it terminates normally.  The
presence of a <tt>`.pid'</tt> file at system startup time indicates that
<code>mysqld</code> terminated abnormally.)

</P>
<P>
An even better test would be to check any table whose last-modified time
is more recent than that of the <tt>`.pid'</tt> file.

</P>
<P>
You should also check your tables regularly during normal system
operation.  At MySQL AB, we run a <code>cron</code> job to check all
our important tables once a week, using a line like this in a <tt>`crontab'</tt>
file:

</P>

<PRE>
35 0 * * 0 /path/to/myisamchk --fast --silent /path/to/datadir/*/*.MYI
</PRE>

<P>
This prints out information about crashed tables so that we can examine and
repair them when needed.

</P>
<P>
Because we haven't had any unexpectedly crashed tables (tables that become
corrupted for reasons other than hardware trouble)
for a couple of years now (this is really true), once a week is
more than enough for us.

</P>
<P>
We recommend that to start with, you execute <code>myisamchk -s</code> each
night on all tables that have been updated during the last 24 hours,
until you come to trust MySQL as much as we do.

</P>
<P>
<A NAME="IDX625"></A>
Normally, MySQL tables need little maintenance.  If you are changing
<code>MyISAM</code> tables with dynamic-sized rows (tables with <code>VARCHAR</code>,
<code>BLOB</code>, or <code>TEXT</code> columns) or have tables with many deleted rows
you may want to defragment/reclaim space from the tables
from time to time (once a month?).

</P>
<P>
You can do this by using <code>OPTIMIZE TABLE</code> on the tables in question.
Or, if you can stop the <code>mysqld</code> server for a while, change location
into the data directory and use this command while the server is stopped:

</P>

<PRE>
shell&#62; myisamchk -r -s --sort-index -O sort_buffer_size=16M */*.MYI
</PRE>

<P>
For <code>ISAM</code> tables, the command is similar:

</P>

<PRE>
shell&#62; isamchk -r -s --sort-index -O sort_buffer_size=16M */*.ISM
</PRE>



<H3><A NAME="Table-info" HREF="manual_toc.html#Table-info">5.7.4  Getting Information About a Table</A></H3>

<P>
<A NAME="IDX626"></A>

</P>
<P>
To obtain a description of a table or statistics about it, use the commands shown
here. We explain some of the information in more detail later:

</P>

<UL>
<LI><code>myisamchk -d <var>tbl_name</var></code>

Runs <code>myisamchk</code> in ``describe mode'' to produce a description of
your table. If you start the MySQL server using the
<code>--skip-external-locking</code> option, <code>myisamchk</code> may report an error
for a table that is updated while it runs.  However, because <code>myisamchk</code>
doesn't change the table in describe mode, there is no risk of
destroying data.

<LI><code>myisamchk -d -v <var>tbl_name</var></code>

Adding <code>-v</code> runs <code>myisamchk</code> in verbose mode so that it produces
more information about what it is doing.

<LI><code>myisamchk -eis <var>tbl_name</var></code>

Shows only the most important information from a table. This operation is slow
because it must read the entire table.

<LI><code>myisamchk -eiv <var>tbl_name</var></code>

This is like <code>-eis</code>, but tells you what is being done.

</UL>

<P>
<A NAME="IDX627"></A>
<A NAME="IDX628"></A>

</P>
<P>
Sample output for some of these commands follows. They are based on a table
with these data and index file sizes:

</P>

<PRE>
-rw-rw-r--   1 monty    tcx     317235748 Jan 12 17:30 company.MYD
-rw-rw-r--   1 davida   tcx      96482304 Jan 12 18:35 company.MYM
</PRE>

<P>
Example of <code>myisamchk -d</code> output:

</P>

<PRE>
MyISAM file:     company.MYI
Record format:   Fixed length
Data records:    1403698  Deleted blocks:         0
Recordlength:    226

table description:
Key Start Len Index   Type
1   2     8   unique  double
2   15    10  multip. text packed stripped
3   219   8   multip. double
4   63    10  multip. text packed stripped
5   167   2   multip. unsigned short
6   177   4   multip. unsigned long
7   155   4   multip. text
8   138   4   multip. unsigned long
9   177   4   multip. unsigned long
    193   1           text
</PRE>

<P>
Example of <code>myisamchk -d -v</code> output:

</P>

<PRE>
MyISAM file:         company
Record format:       Fixed length
File-version:        1
Creation time:       1999-10-30 12:12:51
Recover time:        1999-10-31 19:13:01
Status:              checked
Data records:            1403698  Deleted blocks:              0
Datafile parts:          1403698  Deleted data:                0
Datafile pointer (bytes):      3  Keyfile pointer (bytes):     3
Max datafile length:  3791650815  Max keyfile length: 4294967294
Recordlength:                226

table description:
Key Start Len Index   Type                  Rec/key     Root Blocksize
1   2     8   unique  double                      1 15845376      1024
2   15    10  multip. text packed stripped        2 25062400      1024
3   219   8   multip. double                     73 40907776      1024
4   63    10  multip. text packed stripped        5 48097280      1024
5   167   2   multip. unsigned short           4840 55200768      1024
6   177   4   multip. unsigned long            1346 65145856      1024
7   155   4   multip. text                     4995 75090944      1024
8   138   4   multip. unsigned long              87 85036032      1024
9   177   4   multip. unsigned long             178 96481280      1024
    193   1           text
</PRE>

<P>
Example of <code>myisamchk -eis</code> output:

</P>

<PRE>
Checking MyISAM file: company
Key:  1:  Keyblocks used:  97%  Packed:    0%  Max levels:  4
Key:  2:  Keyblocks used:  98%  Packed:   50%  Max levels:  4
Key:  3:  Keyblocks used:  97%  Packed:    0%  Max levels:  4
Key:  4:  Keyblocks used:  99%  Packed:   60%  Max levels:  3
Key:  5:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
Key:  6:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
Key:  7:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
Key:  8:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
Key:  9:  Keyblocks used:  98%  Packed:    0%  Max levels:  4
Total:    Keyblocks used:  98%  Packed:   17%

Records:          1403698    M.recordlength:     226
Packed:             0%
Recordspace used:     100%   Empty space:          0%
Blocks/Record:   1.00
Record blocks:    1403698    Delete blocks:        0
Recorddata:     317235748    Deleted data:         0
Lost space:             0    Linkdata:             0

User time 1626.51, System time 232.36
Maximum resident set size 0, Integral resident set size 0
Non physical pagefaults 0, Physical pagefaults 627, Swaps 0
Blocks in 0 out 0, Messages in 0 out 0, Signals 0
Voluntary context switches 639, Involuntary context switches 28966
</PRE>

<P>
Example of <code>myisamchk -eiv</code> output:

</P>

<PRE>
Checking MyISAM file: company
Data records: 1403698   Deleted blocks:       0
- check file-size
- check delete-chain
block_size 1024:
index  1:
index  2:
index  3:
index  4:
index  5:
index  6:
index  7:
index  8:
index  9:
No recordlinks
- check index reference
- check data record references index: 1
Key:  1:  Keyblocks used:  97%  Packed:    0%  Max levels:  4
- check data record references index: 2
Key:  2:  Keyblocks used:  98%  Packed:   50%  Max levels:  4
- check data record references index: 3
Key:  3:  Keyblocks used:  97%  Packed:    0%  Max levels:  4
- check data record references index: 4
Key:  4:  Keyblocks used:  99%  Packed:   60%  Max levels:  3
- check data record references index: 5
Key:  5:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
- check data record references index: 6
Key:  6:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
- check data record references index: 7
Key:  7:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
- check data record references index: 8
Key:  8:  Keyblocks used:  99%  Packed:    0%  Max levels:  3
- check data record references index: 9
Key:  9:  Keyblocks used:  98%  Packed:    0%  Max levels:  4
Total:    Keyblocks used:   9%  Packed:   17%

- check records and index references
[LOTS OF ROW NUMBERS DELETED]

Records:         1403698   M.recordlength:   226   Packed:           0%
Recordspace used:    100%  Empty space:        0%  Blocks/Record: 1.00
Record blocks:   1403698   Delete blocks:      0
Recorddata:    317235748   Deleted data:       0
Lost space:            0   Linkdata:           0

User time 1639.63, System time 251.61
Maximum resident set size 0, Integral resident set size 0
Non physical pagefaults 0, Physical pagefaults 10580, Swaps 0
Blocks in 4 out 0, Messages in 0 out 0, Signals 0
Voluntary context switches 10604, Involuntary context switches 122798
</PRE>

<P>
Explanations for the types of information <code>myisamchk</code> produces are
given here.  ``Keyfile'' refers to the index file.  ``Record'' and ``row''
are synonymous.

</P>

<UL>
<LI><code>MyISAM file</code>

Name of the <code>MyISAM</code> (index) file.

<LI><code>File-version</code>

Version of <code>MyISAM</code> format. Currently always 2.

<LI><code>Creation time</code>

When the data file was created.

<LI><code>Recover time</code>

When the index/data file was last reconstructed.

<LI><code>Data records</code>

How many records are in the table.

<LI><code>Deleted blocks</code>

How many deleted blocks still have reserved space.
You can optimize your table to minimize this space.
See section <A HREF="manual_MySQL_Database_Administration.html#Optimization">5.7.2.10  Table Optimization</A>.

<LI><code>Datafile parts</code>

For dynamic record format, this indicates how many data blocks there are. For
an optimized table without fragmented records, this is the same as <code>Data
records</code>.

<LI><code>Deleted data</code>

How many bytes of unreclaimed deleted data there are.
You can optimize your table to minimize this space.
See section <A HREF="manual_MySQL_Database_Administration.html#Optimization">5.7.2.10  Table Optimization</A>.

<LI><code>Datafile pointer</code>

The size of the data file pointer, in bytes. It is usually 2, 3, 4, or 5
bytes. Most tables manage with 2 bytes, but this cannot be controlled
from MySQL yet. For fixed tables, this is a record address. For
dynamic tables, this is a byte address.

<LI><code>Keyfile pointer</code>

The size of the index file pointer, in bytes. It is usually 1, 2, or 3
bytes. Most tables manage with 2 bytes, but this is calculated
automatically by MySQL. It is always a block address.

<LI><code>Max datafile length</code>

How long the table data file can become, in bytes.

<LI><code>Max keyfile length</code>

How long the table index file can become, in bytes.

<LI><code>Recordlength</code>

How much space each record takes, in bytes.

<LI><code>Record format</code>

The format used to store table rows.
The preceding examples use <code>Fixed length</code>.
Other possible values are <code>Compressed</code> and <code>Packed</code>.

<LI><code>table description</code>

A list of all keys in the table. For each key, <code>myisamchk</code> displays
some low-level information:


<UL>
<LI><code>Key</code>

This key's number.

<LI><code>Start</code>

Where in the record this index part starts.

<LI><code>Len</code>

How long this index part is. For packed numbers, this should always be
the full length of the column. For strings, it may be shorter than the full
length of the indexed column, because you can index a prefix of a string
column.

<LI><code>Index</code>

Whether a key value can exist multiple times in the index. Values are
<code>unique</code> or <code>multip.</code> (multiple).

<LI><code>Type</code>

What data type this index part has. This is a <code>MyISAM</code> data type
with the options <code>packed</code>, <code>stripped</code>, or <code>empty</code>.

<LI><code>Root</code>

Address of the root index block.

<LI><code>Blocksize</code>

The size of each index block. By default this is 1024, but the value may be
changed at compile time when MySQL is built from source.

<LI><code>Rec/key</code>

This is a statistical value used by the optimizer. It tells how many
records there are per value for this key. A unique key always has a
value of 1. This may be updated after a table is loaded (or greatly
changed) with <code>myisamchk -a</code>. If this is not updated at all, a default
value of 30 is given.
</UL>

For the table shown in the examples, there are two <code>table description</code>
lines for the ninth index. This indicates that it is a multiple-part index
with two parts.

<LI><code>Keyblocks used</code>

What percentage of the keyblocks are used. When a table has just been
reorganized with <code>myisamchk</code>, as for the table in the examples, the
values are very high (very near the theoretical maximum).

<LI><code>Packed</code>

MySQL tries to pack keys with a common suffix. This can only be used
for indexes on <code>CHAR</code>, <code>VARCHAR</code>, or <code>DECIMAL</code> columns. For
long indexed strings that have similar leftmost parts,
this can significantly reduce the space used. In the third example
above, the fourth key is 10 characters long and a 60% reduction in space is
achieved.

<LI><code>Max levels</code>

How deep the B-tree for this key is. Large tables with long key values get high
values.

<LI><code>Records</code>

How many rows are in the table.

<LI><code>M.recordlength</code>

The average record length.  This is the exact record length for tables
with fixed-length records, because all records have the same length.

<LI><code>Packed</code>

MySQL strips spaces from the end of strings. The <code>Packed</code>
value indicates the percentage of savings achieved by doing this.

<LI><code>Recordspace used</code>

What percentage of the data file is used.

<LI><code>Empty space</code>

What percentage of the data file is unused.

<LI><code>Blocks/Record</code>

Average number of blocks per record (that is, how many links a fragmented
record is composed of). This is always 1.0 for fixed-format tables. This
value should stay as close to 1.0 as possible. If it gets too big, you can
reorganize the table.
See section <A HREF="manual_MySQL_Database_Administration.html#Optimization">5.7.2.10  Table Optimization</A>.

<LI><code>Recordblocks</code>

How many blocks (links) are used. For fixed format, this is the same as the number
of records.

<LI><code>Deleteblocks</code>

How many blocks (links) are deleted.

<LI><code>Recorddata</code>

How many bytes in the data file are used.

<LI><code>Deleted data</code>

How many bytes in the data file are deleted (unused).

<LI><code>Lost space</code>

If a record is updated to a shorter length, some space is lost. This is
the sum of all such losses, in bytes.

<LI><code>Linkdata</code>

When the dynamic table format is used, record fragments are linked with
pointers (4 to 7 bytes each). <code>Linkdata</code> is the sum of the amount of
storage used by all such pointers.

</UL>

<P>
If a table has been compressed with <code>myisampack</code>, <code>myisamchk
-d</code> prints additional information about each table column.  See
section <A HREF="manual_Client-Side_Scripts.html#myisampack">8.2  <code>myisampack</code>, the MySQL Compressed Read-only Table Generator</A>, for an example of this
information and a description of what it means.

</P>


<H2><A NAME="Localisation" HREF="manual_toc.html#Localisation">5.8  MySQL Localization and International Usage</A></H2>

<P>
This section describes how to configure the server to use different
character sets.  It also discusses how to set the server's time zone
and enable per-connection time zone support.

</P>



<H3><A NAME="Character_sets" HREF="manual_toc.html#Character_sets">5.8.1  The Character Set Used for Data and Sorting</A></H3>

<P>
<A NAME="IDX629"></A>
<A NAME="IDX630"></A>
<A NAME="IDX631"></A>

</P>
<P>
By default, MySQL uses the ISO-8859-1 (Latin1) character set
with sorting according to Swedish/Finnish rules. These defaults are suitable
for the United States and most of western Europe.

</P>
<P>
All MySQL binary distributions are compiled with
<code>--with-extra-charsets=complex</code>.  This adds code to all
standard programs that enables them to handle <code>latin1</code> and all multi-byte
character sets within the binary. Other character sets will be
loaded from a character-set definition file when needed.

</P>
<P>
The character set determines what characters are allowed in names. It also
determines how strings are sorted by the <code>ORDER BY</code> and <code>GROUP
BY</code> clauses of the <code>SELECT</code> statement.

</P>
<P>
You can change the character set with the <code>--default-character-set</code>
option when you start the server.  The character sets available depend
on the <code>--with-charset=<var>charset</var></code> and <code>--with-extra-charsets=
<var>list-of-charsets</var> | complex | all | none</code> options to <code>configure</code>, and the
character set configuration files listed in
<tt>`SHAREDIR/charsets/Index'</tt>.
See section <A HREF="manual_Installing.html#configure_options">2.8.2  Typical <code>configure</code> Options</A>.

</P>
<P>
As of MySQL 4.1.1, you can also change the character set collation with the
<code>--default-collation</code> option when you start the server.  The collation
must be a legal collation for the default character set.  (Use the
<code>SHOW COLLATION</code> statement to determine which collations are available
for each character set.)
See section <A HREF="manual_Installing.html#configure_options">2.8.2  Typical <code>configure</code> Options</A>.

</P>
<P>
If you change the character set when running MySQL, that may also
change the sort order.  Consequently, you must run <code>myisamchk -r -q
--set-character-set=<var>charset</var></code> on all tables, or your indexes may not be
ordered correctly.

</P>
<P>
When a client connects to a MySQL server, the server indicates to the
client what the server's default character set is.  The client will switch
to use this character set for this connection.

</P>
<P>
You should use <code>mysql_real_escape_string()</code> when escaping strings
for an SQL query.  <code>mysql_real_escape_string()</code> is identical to the
old <code>mysql_escape_string()</code> function, except that it takes the <code>MYSQL</code>
connection handle as the first parameter so that the appropriate character set
can be taken into account when escaping characters.

</P>
<P>
If the client is compiled with different paths than where the server is
installed and the user who configured MySQL didn't include all character
sets in the MySQL binary, you must tell the client where it can find the
additional character sets it will need if the server runs with a different
character set than the client.

</P>
<P>
You can do this by specifying a <code>--character-sets-dir</code> option to
indicate the path to the directory in which the dynamic MySQL character
sets are stored. For example, you can put the following in an option file:

</P>

<PRE>
[client]
character-sets-dir=/usr/local/mysql/share/mysql/charsets
</PRE>

<P>
You can force the client to use specific character set as follows:

</P>

<PRE>
[client]
default-character-set=<var>charset</var>
</PRE>

<P>
This is normally unnecessary, however.

</P>



<H4><A NAME="German_character_set" HREF="manual_toc.html#German_character_set">5.8.1.1  Using the German Character Set</A></H4>

<P>
In MySQL 4.0, to get German sorting order, you should start <code>mysqld</code>
with a <code>--default-character-set=latin1_de</code> option.  This affects server
behavior in several ways:

</P>

<UL>
<LI>

When sorting and comparing strings, the following mapping is performed on the
strings before doing the comparison:


<PRE>
&auml;  -&#62;  ae
&ouml;  -&#62;  oe
&uuml;  -&#62;  ue
&szlig;  -&#62;  ss
</PRE>

<LI>

All accented characters are converted to their unaccented uppercase
counterpart.  All letters are converted to uppercase.

<LI>

When comparing strings with <code>LIKE</code>, the one-character to two-character mapping
is not done. All letters are converted to uppercase. Accents are removed
from all letters except <code>&Uuml;</code>, <code>&uuml;</code>, <code>&Ouml;</code>, <code>&ouml;</code>,
<code>&Auml;</code>, and <code>&auml;</code>.

</UL>

<P>
In MySQL 4.1 and up, character set and collation are specified separately.
You should select the <code>latin1</code> character set and either the
<code>latin1_german1_ci</code> or <code>latin1_german2_ci</code> collation.  For
example, to start the server with the <code>latin1_german1_ci</code> collation,
use the <code>--character-set-server=latin1</code> and
<code>--collation-server=latin1_german1_ci</code> options.

</P>
<P>
For information on the differences between these two collations, see
section <A HREF="manual_Charset.html#Charset-we-sets">10.11.2  West European Character Sets</A>.

</P>



<H3><A NAME="Languages" HREF="manual_toc.html#Languages">5.8.2  Setting the Error Message Language</A></H3>

<P>
<A NAME="IDX632"></A>
<A NAME="IDX633"></A>
<A NAME="IDX634"></A>
<A NAME="IDX635"></A>

</P>
<P>
By default, <code>mysqld</code> produces error messages in English, but they can
also be displayed in any of these other languages:
Czech, Danish, Dutch, Estonian, French, German, Greek,
Hungarian, Italian, Japanese, Korean, Norwegian, Norwegian-ny, Polish,
Portuguese, Romanian, Russian, Slovak, Spanish, or Swedish.

</P>
<P>
To start <code>mysqld</code> with a particular language for error messages, use the
<code>--language</code> or <code>-L</code> option. The option value can be a language name
or the full path to the error message file.
For example:

</P>

<PRE>
shell&#62; mysqld --language=swedish
</PRE>

<P>
Or:

</P>

<PRE>
shell&#62; mysqld --language=/usr/local/share/swedish
</PRE>

<P>
The language name should be specified in lowercase.

</P>
<P>
The language files are located (by default) in the
<tt>`share/<var>LANGUAGE</var>'</tt> directory under the MySQL base
directory.

</P>
<P>
To change the error message file, you should edit the <tt>`errmsg.txt'</tt> file,
and then execute the following command to generate the <tt>`errmsg.sys'</tt> file:

</P>

<PRE>
shell&#62; comp_err errmsg.txt errmsg.sys
</PRE>

<P>
If you upgrade to a newer version of MySQL, remember to repeat
your changes with the new <tt>`errmsg.txt'</tt> file.

</P>



<H3><A NAME="Adding_character_set" HREF="manual_toc.html#Adding_character_set">5.8.3  Adding a New Character Set</A></H3>

<P>
<A NAME="IDX636"></A>
<A NAME="IDX637"></A>

</P>
<P>
This section discusses the procedure for adding add another character set to
MySQL.  You must have a MySQL source distribution to use these instructions.

</P>
<P>
To choose the proper procedure, decide whether the character
set is simple or complex:

</P>

<UL>

<LI>

If the character set does not need to use special string collating routines
for sorting and does not need multi-byte character support, it is simple.

<LI>

If it needs either of those features, it is complex.

</UL>

<P>
For example, <code>latin1</code> and <code>danish</code> are simple character sets,
whereas <code>big5</code> and <code>czech</code> are complex character sets.

</P>
<P>
In the following procedures, the name of your character
set is represented by <var>MYSET</var>.

</P>
<P>
For a simple character set, do the following:

</P>

<OL>
<LI>

Add <var>MYSET</var> to the end of the <tt>`sql/share/charsets/Index'</tt> file.
Assign a unique number to it.

<LI>

Create the file <tt>`sql/share/charsets/<var>MYSET</var>.conf'</tt>.
(You can use a copy of <tt>`sql/share/charsets/latin1.conf'</tt> as the basis for
this file.)

The syntax for the file is very simple:


<UL>
<LI>

Comments start with a <samp>`#'</samp> character and proceed to the end of the line.
<LI>

Words are separated by arbitrary amounts of whitespace.
<LI>

When defining the character set, every word must be a number in hexadecimal
format.
<LI>

The <code>ctype</code> array takes up the first 257 words. The
<code>to_lower[]</code>, <code>to_upper[]</code> and <code>sort_order[]</code> arrays take up
256 words each after that.
</UL>

See section <A HREF="manual_MySQL_Database_Administration.html#Character_arrays">5.8.4  The Character Definition Arrays</A>.

<LI>

Add the character set name to the <code>CHARSETS_AVAILABLE</code> and
<code>COMPILED_CHARSETS</code> lists in <code>configure.in</code>.

<LI>

Reconfigure, recompile, and test.

</OL>

<P>
For a complex character set, do the following:

</P>

<OL>
<LI>

Create the file <tt>`strings/ctype-<var>MYSET</var>.c'</tt> in the MySQL source
distribution.

<LI>

Add <var>MYSET</var> to the end of the <tt>`sql/share/charsets/Index'</tt> file.
Assign a unique number to it.

<LI>

Look at one of the existing <tt>`ctype-*.c'</tt> files (such as
<tt>`strings/ctype-big5.c'</tt>) to see what needs to be defined.
Note that the
arrays in your file must have names like <code>ctype_<var>MYSET</var></code>,
<code>to_lower_<var>MYSET</var></code>, and so on.  These correspond to the arrays
for a simple character set. See section <A HREF="manual_MySQL_Database_Administration.html#Character_arrays">5.8.4  The Character Definition Arrays</A>.

<LI>

Near the top of the file, place a special comment like this:


<PRE>
/*
 * This comment is parsed by configure to create ctype.c,
 * so don't change it unless you know what you are doing.
 *
 * .configure. number_<var>MYSET</var>=<var>MYNUMBER</var>
 * .configure. strxfrm_multiply_<var>MYSET</var>=<var>N</var>
 * .configure. mbmaxlen_<var>MYSET</var>=<var>N</var>
 */
</PRE>

The <code>configure</code> program uses this comment to include
the character set into the MySQL library automatically.

The <code>strxfrm_multiply</code> and <code>mbmaxlen</code> lines are explained in
the following sections.  You need include them only if you need the string
collating functions or the multi-byte character set functions,
respectively.

<LI>

You should then create some of the following functions:


<UL>
<LI><code>my_strncoll_<var>MYSET</var>()</code>

<LI><code>my_strcoll_<var>MYSET</var>()</code>

<LI><code>my_strxfrm_<var>MYSET</var>()</code>

<LI><code>my_like_range_<var>MYSET</var>()</code>

</UL>

See section <A HREF="manual_MySQL_Database_Administration.html#String_collating">5.8.5  String Collating Support</A>.

<LI>

Add the character set name to the <code>CHARSETS_AVAILABLE</code> and
<code>COMPILED_CHARSETS</code> lists in <code>configure.in</code>.

<LI>

Reconfigure, recompile, and test.
</OL>

<P>
The <tt>`sql/share/charsets/README'</tt> file includes additional instructions.

</P>
<P>
If you want to have the character set included in the MySQL
distribution, mail a patch to the MySQL <code>internals</code> mailing list.
See section <A HREF="manual_Introduction.html#Mailing-list">1.4.1.1  The MySQL Mailing Lists</A>.

</P>



<H3><A NAME="Character_arrays" HREF="manual_toc.html#Character_arrays">5.8.4  The Character Definition Arrays</A></H3>

<P>
<code>to_lower[]</code> and <code>to_upper[]</code> are simple arrays that hold the
lowercase and uppercase characters corresponding to each member of the
character set.  For example:

</P>

<PRE>
to_lower['A'] should contain 'a'
to_upper['a'] should contain 'A'
</PRE>

<P>
<code>sort_order[]</code> is a map indicating how characters should be ordered for
comparison and sorting purposes. Quite often (but not for all character sets)
this is the same as <code>to_upper[]</code>, which means that sorting will be
case-insensitive. MySQL will sort characters based on the values of
<code>sort_order[]</code> elements.  For more complicated sorting rules, see
the discussion of string collating in section <A HREF="manual_MySQL_Database_Administration.html#String_collating">5.8.5  String Collating Support</A>.

</P>
<P>
<code>ctype[]</code> is an array of bit values, with one element for one character.
(Note that <code>to_lower[]</code>, <code>to_upper[]</code>, and <code>sort_order[]</code>
are indexed by character value, but <code>ctype[]</code> is indexed by character
value + 1.  This is an old legacy convention to be able to handle <code>EOF</code>.)

</P>
<P>
You can find the following bitmask definitions in <tt>`m_ctype.h'</tt>:

</P>

<PRE>
#define _U      01      /* Uppercase */
#define _L      02      /* Lowercase */
#define _N      04      /* Numeral (digit) */
#define _S      010     /* Spacing character */
#define _P      020     /* Punctuation */
#define _C      040     /* Control character */
#define _B      0100    /* Blank */
#define _X      0200    /* heXadecimal digit */
</PRE>

<P>
The <code>ctype[]</code> entry for each character should be the union of the
applicable bitmask values that describe the character.  For example,
<code>'A'</code> is an uppercase character (<code>_U</code>) as well as a
hexadecimal digit (<code>_X</code>), so <code>ctype['A'+1]</code> should contain the
value:

</P>

<PRE>
_U + _X = 01 + 0200 = 0201
</PRE>



<H3><A NAME="String_collating" HREF="manual_toc.html#String_collating">5.8.5  String Collating Support</A></H3>

<P>
<A NAME="IDX638"></A>
<A NAME="IDX639"></A>

</P>
<P>
If the sorting rules for your language are too complex to be handled
with the simple <code>sort_order[]</code> table, you need to use the string
collating functions.

</P>
<P>
Right now the best documentation for this is the character sets that are
already implemented.  Look at the <code>big5</code>, <code>czech</code>, <code>gbk</code>,
<code>sjis</code>, and <code>tis160</code> character sets for examples.

</P>
<P>
You must specify the <code>strxfrm_multiply_<var>MYSET</var>=<var>N</var></code> value in the
special comment at the top of the file.  <var>N</var> should be set to
the maximum ratio the strings may grow during <code>my_strxfrm_<var>MYSET</var></code> (it
must be a positive integer).

</P>



<H3><A NAME="Multi-byte_characters" HREF="manual_toc.html#Multi-byte_characters">5.8.6  Multi-Byte Character Support</A></H3>

<P>
<A NAME="IDX640"></A>
<A NAME="IDX641"></A>

</P>
<P>
If you want to add support for a new character set that includes
multi-byte characters, you need to use the multi-byte character
functions.

</P>
<P>
Right now the best documentation on this consists of the character sets that are
already implemented.  Look at the <code>euc_kr</code>, <code>gb2312</code>,
<code>gbk</code>, <code>sjis</code>, and <code>ujis</code> character sets for
examples. These are implemented in the <tt>`ctype-<var>charset</var>.c'</tt> files
in the <tt>`strings'</tt> directory.

</P>
<P>
You must specify the <code>mbmaxlen_<var>MYSET</var>=<var>N</var></code> value in the special
comment at the top of the source file.  <var>N</var> should be set to the
size in bytes of the largest character in the set.

</P>


<H3><A NAME="Problems_with_character_sets" HREF="manual_toc.html#Problems_with_character_sets">5.8.7  Problems With Character Sets</A></H3>

<P>
If you try to use a character set that is not compiled into your binary,
you might run into the following problems:

</P>

<UL>
<LI>

Your program has an incorrect path to where the character sets are stored.
(Default <tt>`/usr/local/mysql/share/mysql/charsets'</tt>).
This can be fixed by using the <code>--character-sets-dir</code>
option when you run the program in question.
<LI>

The character set is a multi-byte character set that can't be loaded
dynamically.  In this case, you must recompile the program with
support for the character set.
<LI>

The character set is a dynamic character set, but you don't have a
configure file for it.  In this case, you should install the configure
file for the character set from a new MySQL distribution.
<LI>

If your <tt>`Index'</tt> file doesn't contain the name for the character set, your
program will display the following error message:


<PRE>
ERROR 1105: File '/usr/local/share/mysql/charsets/?.conf'
not found (Errcode: 2)
</PRE>

In this case, you should either get a new <code>Index</code> file or manually add
the name of any missing character sets to the current file.
</UL>

<P>
For <code>MyISAM</code> tables, you can check the character set name and number for a
table with <code>myisamchk -dvv <var>tbl_name</var></code>.

</P>



<H3><A NAME="Time_zone_support" HREF="manual_toc.html#Time_zone_support">5.8.8  MySQL Server Time Zone Support</A></H3>

<P>
Before MySQL 4.1.3, you can set the time zone for the server with the
<code>--timezone=<var>timezone_name</var></code> option to <code>mysqld_safe</code>.  You can
also set it by setting the <code>TZ</code> environment variable before you
start <code>mysqld</code>.

</P>
<P>
The allowable values for <code>--timezone</code> or <code>TZ</code> are
system-dependent. Consult your operating system documentation to see
what values are acceptable.

</P>
<P>
Beginning with MySQL 4.1.3, the server maintains several time zone settings:

</P>

<UL>
<LI>

The system time zone.  When the server starts, it attempts to determine the
time zone of the host machine and uses it to set the <code>system_time_zone</code>
system variable.

<LI>

The server's current time zone. The global <code>time_zone</code> system variable
indicates the time zone the server currently is operating in. The initial
value is <code>'SYSTEM'</code>, which indicates that the server time zone is the
same as the system time zone. The initial value can be specified explicitly
with the <code>--default-time-zone=<var>timezone</var></code> option.  If you have the
<code>SUPER</code> privilege, you can set the global value at runtime with this
statement:


<PRE>
mysql&#62; SET GLOBAL time_zone = <var>timezone</var>;
</PRE>

<LI>

Per-connection time zones. Each client that connects has its own time
zone setting, given by the session <code>time_zone</code> variable. Initially
this is the same as the global <code>time_zone</code> variable, but can be
reset with this statement:


<PRE>
mysql&#62; SET time_zone = <var>timezone</var>;
</PRE>

</UL>

<P>
The current values of the global and per-connection time zones can be
retrieved like this:

</P>

<PRE>
mysql&#62; SELECT @@global.time_zone, @@session.time_zone;
</PRE>

<P>
<var>timezone</var> values can be given as strings indicating an offset
from UTC, such as <code>'+10:00'</code> or <code>'-6:00'</code>. If the time zone-related
tables in the <code>mysql</code> database have been created and populated, you
can also used named time zones, such as <code>'Europe/Helsinki'</code>,
<code>'US/Eastern'</code>, or <code>'MET'</code>. The value <code>'SYSTEM'</code> indicates
that the time zone should be the same as the system time zone.  Time zone
names are not case sensitive.

</P>
<P>
The MySQL installation procedure creates the time zone tables in the
<code>mysql</code> database, but does not load them. You must do so manually.
(If you are upgrading to MySQL 4.1.3 or later from an earlier version, you
should create the tables by upgrading your <code>mysql</code> database. Use the
instructions in section <A HREF="manual_Installing.html#Upgrading-grant-tables">2.10.7  Upgrading the Grant Tables</A>.)

</P>
<P>
If your system has its own zoneinfo database (the set of files describing
time zones), you should use the <code>mysql_tzinfo_to_sql</code> program for
filling the time zone tables. Examples of such systems are Linux, FreeBSD,
Sun Solaris, and Mac OS X. One likely location for these files is the
<tt>`/usr/share/zoneinfo'</tt> directory. If your system does not have a
zoneinfo database, you can use the downloadable package described later in
this section.

</P>
<P>
The <code>mysql_tzinfo_to_sql</code> program is used to load the time zone
tables.  On the command line, pass the zoneinfo directory pathname to
<code>mysql_tzinfo_to_sql</code> and send the output into the <code>mysql</code>
program. For example:

</P>

<PRE>
shell&#62; mysql_tzinfo_to_sql /usr/share/zoneinfo | mysql -u root mysql
</PRE>

<P>
<code>mysql_tzinfo_to_sql</code> reads your system's time zone files and
generates SQL statements from them.  <code>mysql</code> processes those
statements to load the time zone tables.

</P>
<P>
<code>mysql_tzinfo_to_sql</code> also can be used to load a single time zone
file, and to generate leap second information.

</P>
<P>
To load a single time zone file <var>tz_file</var> that corresponds to a
time zone name <var>tz_name</var>, invoke <code>mysql_tzinfo_to_sql</code> like this:

</P>

<PRE>
shell&#62; mysql_tzinfo_to_sql <var>tz_file</var> <var>tz_name</var> | mysql -u root mysql
</PRE>

<P>
If your time zone needs to account for leap seconds, initialize the
leap second information like this, where <var>tz_file</var> is the name of
your time zone file:

</P>

<PRE>
shell&#62; mysql_tzinfo_to_sql --leap <var>tz_file</var> | mysql -u root mysql
</PRE>

<P>
If your system doesn't have a zoneinfo database (for example, Windows or
HP-UX), you can use the package of pre-built time zone tables that is
available for download at
<a HREF="http://dev.mysql.com/downloads/timezones.html">http://dev.mysql.com/downloads/timezones.html</a>.  This package contains
<tt>`.frm'</tt>, <tt>`.MYD'</tt>, and <tt>`.MYI'</tt> files for the <code>MyISAM</code> time
zone tables.  These tables should belong to the <code>mysql</code> database, so
you should place the files in the <tt>`mysql'</tt> subdirectory of your MySQL
server's data directory. The server should be shut down while you do this.

</P>
<P>
<strong>Warning!</strong> Please don't use the downloadable package if your system
has a zoneinfo database. Use the <code>mysql_tzinfo_to_sql</code> utility
instead! Otherwise, you may cause a difference in datetime handling between
MySQL and other applications on your system.

</P>



<H2><A NAME="Log_Files" HREF="manual_toc.html#Log_Files">5.9  The MySQL Log Files</A></H2>

<P>
<A NAME="IDX642"></A>

</P>
<P>
MySQL has several different log files that can help you find
out what's going on inside <code>mysqld</code>:

</P>
<TABLE BORDER>
<TR><TD><strong>Log File</strong> </TD><TD> <strong>Types of Information Logged to File</strong>
</TD></TR>
<TR><TD>The error log </TD><TD> Logs problems encountered starting, running, or
stopping <code>mysqld</code>.
</TD></TR>
<TR><TD>The isam log </TD><TD> Logs all changes to the <code>ISAM</code> tables. Used only for debugging the isam code.
</TD></TR>
<TR><TD>The query log </TD><TD> Logs established client connections and executed statements.
</TD></TR>
<TR><TD>The update log </TD><TD> Logs statements that change data. This log is deprecated.
</TD></TR>
<TR><TD>The binary log </TD><TD> Logs all statements that change data. Also used for replication.
</TD></TR>
<TR><TD>The slow log </TD><TD> Logs all queries that took more than <code>long_query_time</code> seconds to execute or didn't use indexes.
</TD></TR>
</TABLE>

<P>
By default, all logs are created in the <code>mysqld</code> data directory.  You can
force <code>mysqld</code> to close and reopen the log files (or in some cases
switch to a new log) by flushing the logs. Log flushing occurs when you
issue a <code>FLUSH LOGS</code> statement or execute <code>mysqladmin flush-logs</code> or
<code>mysqladmin refresh</code>.
See section <A HREF="manual_SQL_Syntax.html#FLUSH">13.5.5.2  <code>FLUSH</code> Syntax</A>.

</P>
<P>
If you are using MySQL replication capabilities, slave replication servers
maintain additional log files called relay logs. These are discussed in
section <A HREF="manual_Replication.html#Replication">6  Replication in MySQL</A>.

</P>



<H3><A NAME="Error_log" HREF="manual_toc.html#Error_log">5.9.1  The Error Log</A></H3>

<P>
The error log file contains information indicating when <code>mysqld</code>
was started and stopped and also any critical errors that occur while the
server is running.

</P>
<P>
If <code>mysqld</code> dies unexpectedly and <code>mysqld_safe</code> needs to
restart it, <code>mysqld_safe</code> will write a <code>restarted
mysqld</code> message to the error log.  If
<code>mysqld</code> notices a table that needs to be automatically checked or
repaired, it writes a message to the error log.

</P>
<P>
On some operating systems, the error log will contain a stack trace if
<code>mysqld</code> dies. The trace can be used to determine where
<code>mysqld</code> died.  See section <A HREF="manual_Porting.html#Using_stack_trace">E.1.4  Using a Stack Trace</A>.

</P>
<P>
Beginning with MySQL 4.0.10, you can specify where <code>mysqld</code> stores the
error log file with the <code>--log-error[=<var>file_name</var>]</code> option. If no
<var>file_name</var> value is given, <code>mysqld</code> uses the name
<tt>`<var>host_name</var>.err'</tt> and writes the file in the data directory.
(Prior to MySQL 4.0.10, the Windows error log name is <tt>`mysql.err'</tt>.)
If you execute <code>FLUSH LOGS</code>, the error log is renamed with a suffix
of <code>-old</code> and <code>mysqld</code> creates a new empty log file.

</P>
<P>
In older MySQL versions on Unix, error log handling was done by
<code>mysqld_safe</code> which redirected the error file to
<code><var>host_name</var>.err</code>.  You could change this filename by specifying a
<code>--err-log=<var>file_name</var></code> option to <code>mysqld_safe</code>.

</P>
<P>
If you don't specify <code>--log-error</code>, or (on Windows) if you use the
<code>--console</code> option, errors are written to stderr, the standard error
output. Usually this is your terminal.

</P>
<P>
On Windows, error output is always written to the <code>.err</code> file if
<code>--console</code> is not given.

</P>


<H3><A NAME="Query_log" HREF="manual_toc.html#Query_log">5.9.2  The General Query Log</A></H3>

<P>
<A NAME="IDX643"></A>
<A NAME="IDX644"></A>

</P>
<P>
If you want to know what happens within <code>mysqld</code>, you should start
it with the <code>--log[=<var>file_name</var>]</code> or <code>-l [<var>file_name</var>]</code> option.
If no <var>file_name</var> value is given, the default name is
<tt>`<var>host_name</var>.log'</tt>
This will log all connections and statements to the log file.
This log can be very useful when you suspect an error in a client and want
to know exactly what the client sent to <code>mysqld</code>.

</P>
<P>
Older versions of the <code>mysql.server</code> script (from MySQL 3.23.4 to 3.23.8)
pass a <code>--log</code> option to <code>safe_mysqld</code> to enable the general query log.
If you need better performance when you start using MySQL in a production
environment, you can remove the <code>--log</code> option from <code>mysql.server</code>
or change it to <code>--log-bin</code>. See section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>.

</P>
<P>
<code>mysqld</code> writes statements to the query log in the order that it
receives them.  This may be different from the order in which they are
executed.  This is in contrast to the update log and the binary log, which
are written after the query is executed, but before any locks are released.
(The query log also contains all statements, whereas the update and binary
logs do not contain statements that only select data.)

</P>
<P>
Server restarts and log flushing do not cause a new general query log file
to be generated (although flushing closes and reopens it). On Unix, you can
rename the file and create a new one by using the following commands:

</P>

<PRE>
shell&#62; mv hostname.log hostname-old.log
shell&#62; mysqladmin flush-logs
shell&#62; cp hostname-old.log to-backup-directory
shell&#62; rm hostname-old.log
</PRE>

<P>
On Windows, you cannot rename the log file while the server has it open.
You must stop the server and rename the log. Then restart the server to create
a new log.

</P>



<H3><A NAME="Update_log" HREF="manual_toc.html#Update_log">5.9.3  The Update Log</A></H3>

<P>
<A NAME="IDX645"></A>
<A NAME="IDX646"></A>

</P>
<P>
<strong>Note</strong>: The update log has been deprecated and replaced by the binary
log. See section <A HREF="manual_MySQL_Database_Administration.html#Binary_log">5.9.4  The Binary Log</A>.  The binary log can do anything the old update log
could do, and more. <em>The update log is unavailable as of MySQL
5.0.0</em>.

</P>
<P>
When started with the <code>--log-update[=<var>file_name</var>]</code> option,
<code>mysqld</code> writes a log file containing all SQL statements that update
data. If no <var>file_name</var> value is given, the default name is name of the host
machine. If a filename is given, but it doesn't contain a leading path, the file
is written in the data directory. If <tt>`file_name'</tt> doesn't have an
extension, <code>mysqld</code> creates log files with names of the form
<var>file_name.###</var>, where <var>###</var> is a number that is incremented each
time you start the server or flush the logs.

</P>
<P>
<strong>Note</strong>: For this naming scheme to work, you must not create
your own files with the same names as those that might be used for the log
file sequence.

</P>
<P>
Update logging is smart because it logs only statements that really update
data. So, an <code>UPDATE</code> or a <code>DELETE</code> with a <code>WHERE</code> that finds no
rows is not written to the log. It even skips <code>UPDATE</code> statements that
set a column to the value it already has.

</P>
<P>
The update logging is done immediately after a query completes but before
any locks are released or any commit is done. This ensures that statements
are logged in execution order.

</P>
<P>
If you want to update a database from update log files, you could do the
following (assuming that your update logs have names of the form
<tt>`file_name.###'</tt>):

</P>

<PRE>
shell&#62; ls -1 -t -r file_name.[0-9]* | xargs cat | mysql
</PRE>

<P>
<code>ls</code> is used to sort the update log filenames into the right order.

</P>
<P>
This can be useful if you have to revert to backup files after a crash
and you want to redo the updates that occurred between the time of the backup
and the crash.

</P>



<H3><A NAME="Binary_log" HREF="manual_toc.html#Binary_log">5.9.4  The Binary Log</A></H3>

<P>
<A NAME="IDX647"></A>
<A NAME="IDX648"></A>

</P>
<P>
The binary log has replaced the old update log, which is unavailable
starting from MySQL 5.0. The binary log contains all information that is
available in the update log in a more efficient format and in a manner
that is transactionally safe.

</P>
<P>
The binary log contains all statements which updated data or (starting from
MySQL 4.1.3) could potentially have updated it (for example, a <code>DELETE</code>
which matched no rows).

</P>
<P>
The binary log also contains information about how long each statement took
that updated the database.  It doesn't contain statements that don't modify
any data.  If you want to log all statements (for example, to identify a problem
query) you should use the general query log. See section <A HREF="manual_MySQL_Database_Administration.html#Query_log">5.9.2  The General Query Log</A>.

</P>
<P>
The primary purpose of the binary log is to be able to update the database
during a restore operation as fully as possible, because the binary log will
contain all updates done after a backup was made.

</P>
<P>
The binary log is also used on master replication servers as a record of the
statements to be sent to slave servers.
See section <A HREF="manual_Replication.html#Replication">6  Replication in MySQL</A>.

</P>
<P>
Running the server with the binary log enabled makes performance about 1%
slower. However, the benefits of the binary log for restore operations and
in allowing you to set up replication generally outweigh this minor
performance decrement.

</P>
<P>
When started with the <code>--log-bin[=<var>file_name</var>]</code> option, <code>mysqld</code>
writes a log file containing all SQL commands that update data. If no
<var>file_name</var> value is given, the default name is the name of the host machine followed
by <code>-bin</code>. If file name is given, but it doesn't contain a path, the
file is written in the data directory.

</P>
<P>
If you supply an extension in the log name (for example,
<code>--log-bin=<var>file_name.extension</var></code>), the
extension is silently removed and ignored.

</P>
<P>
<code>mysqld</code> appends a numeric extension to the binary log name. The number
is incremented each time you start the server or flush the logs.
A new binary log also is created
automatically when the current log's size reaches 
<code>max_binlog_size</code>. A binary log may become larger than
<code>max_binlog_size</code> if you are using large transactions: A transaction is
written to the binary log in one piece, never split between binary logs.

</P>
<P>
To be able to know which different binary log files have been used,
<code>mysqld</code> also creates a binary log index file that
contains the name of all used binary log files. By default this has the
same name as the binary log file, with the extension <code>'.index'</code>.
You can change the name of the binary log index file with the
<code>--log-bin-index[=<var>file_name</var>]</code> option.
You should not manually edit this file while <code>mysqld</code> is running;
doing so would confuse <code>mysqld</code>.

</P>
<P>
You can delete all binary log files with the <code>RESET MASTER</code> statement,
or only some of them with <code>PURGE MASTER LOGS</code>.
See section <A HREF="manual_SQL_Syntax.html#RESET">13.5.5.5  <code>RESET</code> Syntax</A> and section <A HREF="manual_SQL_Syntax.html#Replication_Master_SQL">13.6.1  SQL Statements for Controlling Master Servers</A>.

</P>
<P>
The binary log format has some known limitations which can affect recovery from
backups, especially in old versions. These caveats which also affect
replication are listed at section <A HREF="manual_Replication.html#Replication_Features">6.7  Replication Features and Known Problems</A>. One caveat which does not
affect replication but only recovery with <code>mysqlbinlog</code>: before MySQL 4.1,
<code>mysqlbinlog</code> could not prepare output suitable for <code>mysql</code> if
the binary log contained interlaced statements originating from different
clients that used temporary tables of the same name. This is fixed in MySQL
4.1. However, the problem still existed for <code>LOAD DATA INFILE</code> statements
until it was fixed in MySQL 4.1.8.

</P>
<P>
You can use the following options to <code>mysqld</code> to affect what is logged
to the binary log. See also the discussion that follows this option list.

</P>
<DL COMPACT>

<DT><code>--binlog-do-db=<var>db_name</var></code>
<DD>
Tells the master that it should log updates to the binary log if the current
database (that is, the one selected by <code>USE</code>) is <var>db_name</var>. All
other databases that are not explicitly mentioned are ignored.  If you use
this, you should ensure that you only do updates in the current database.

Observe that there is an exception to the <code>CREATE/ALTER/DROP
DATABASE</code> statements, which use the database manipulated to decide if
it should log the statement rather than the current database.

An example of what does not work as you might expect: If the server is
started with <code>binlog-do-db=sales</code>, and you do
<code>USE prices; UPDATE sales.january SET amount=amount+1000;</code>,
this statement will not be written into the binary log.

<DT><code>--binlog-ignore-db=<var>db_name</var></code>
<DD>
Tells the master that updates where the current database
(that is, the one selected by <code>USE</code>) is
<var>db_name</var> should not be stored in the binary log.  If
you use this, you should ensure that you only do updates in the current
database.

An example of what does not work as you might expect: If the server is
started with <code>binlog-ignore-db=sales</code>, and you do
<code>USE prices; UPDATE sales.january SET amount=amount+1000;</code>,
this statement will be written into the binary log.

Similar to the case for <code>--binlog-do-db</code>, there is an exception
to the <code>CREATE/ALTER/DROP DATABASE</code> statements, which use the
database manipulated to decide if it should log the statement rather
than the current database.

</DL>

<P>
To log or ignore multiple databases, specify the appropriate option multiple
times, once for each database.

</P>
<P>
The rules for logging or ignoring updates to the binary log are
evaluated according to the following rules. Observe that there is an
exception for <code>CREATE/ALTER/DROP DATABASE</code> statements. In those
cases, the database being <em>created/altered/dropped</em> replace the
current database in the rules below.

</P>

<OL>
<LI>

Are there <code>binlog-do-db</code> or <code>binlog-ignore-db</code> rules?

<UL>
<LI>No:

Write the statement to the binary log and exit.
<LI>Yes:

Go to the next step.
</UL>

<LI>

There are some rules (<code>binlog-do-db</code> or
<code>binlog-ignore-db</code> or both). Is there a current database (has any
database been selected by <code>USE</code>?)?

<UL>
<LI>No:

Do <em>not</em> write the statement, and exit.
<LI>Yes:

Go to the next step.
</UL>

<LI>

There is a current database. Are there some <code>binlog-do-db</code> rules?

<UL>
<LI>Yes:

Does the current database match any of the <code>binlog-do-db</code>
rules?

<UL>
<LI>Yes:

Write the statement and exit.
<LI>No:

Do <em>not</em> write the statement, and exit.
</UL>

<LI>No:

Go to the next step.
</UL>

<LI>

There are some <code>binlog-ignore-db</code> rules.
Does the current database match any of the <code>binlog-ignore-db</code>
rules?

<UL>
<LI>Yes:

Do not write the statement, and exit.
<LI>No:

Write the query and exit.
</UL>

</OL>

<P>
For example, a slave running with only <code>binlog-do-db=sales</code>
will not write to the binary log any statement whose current database is
different from <code>sales</code> (in other words, <code>binlog-do-db</code> can
sometimes mean ``ignore other databases'').

</P>
<P>
If you are using replication, you should not delete old binary log
files until you are sure that no slave still needs to use them.
One way to do this is to do <code>mysqladmin flush-logs</code> once a day and then
remove any logs that are more than three days old. You can remove them
manually, or preferably using <code>PURGE MASTER LOGS</code>
(see section <A HREF="manual_SQL_Syntax.html#Replication_Master_SQL">13.6.1  SQL Statements for Controlling Master Servers</A>), which will also safely update the binary 
log index file for you  (and which can take a date argument since
MySQL 4.1)

</P>
<P>
A client with the <code>SUPER</code> privilege can disable binary
logging of its own statements by using a <code>SET
SQL_LOG_BIN=0</code> statement. See section <A HREF="manual_SQL_Syntax.html#SET_OPTION">13.5.3  <code>SET</code> Syntax</A>.

</P>
<P>
You can examine the binary log file with the <code>mysqlbinlog</code> utility.
This can be useful when you want to reprocess statements in the log.
For example, you can update a MySQL server from the binary log
as follows:

</P>

<PRE>
shell&#62; mysqlbinlog log-file | mysql -h server_name
</PRE>

<P>
See section <A HREF="manual_Client-Side_Scripts.html#mysqlbinlog">8.5  The <code>mysqlbinlog</code> Binary Log Utility</A> for more information on the
<code>mysqlbinlog</code> utility and how to use it.

</P>
<P>
If you are using transactions, you must
use the MySQL binary log for backups instead of the old update log.

</P>
<P>
The binary logging is done immediately after a query completes but before
any locks are released or any commit is done. This ensures that the log
will be logged in the execution order.

</P>
<P>
Updates to non-transactional tables are stored in the binary log
immediately after execution.  For transactional tables such as <code>BDB</code>
or <code>InnoDB</code> tables, all updates (<code>UPDATE</code>, <code>DELETE</code>,
or <code>INSERT</code>) that change tables are cached until a <code>COMMIT</code>
statement is received by the server. At that point, <code>mysqld</code> writes the
whole transaction to the binary log before the <code>COMMIT</code> is executed.
When the thread that handles the transaction starts, it allocates a buffer
of <code>binlog_cache_size</code> to buffer queries.  If a statement is bigger
than this, the thread opens a temporary file to store the transaction.  The
temporary file is deleted when the thread ends.

</P>
<P>
The <code>Binlog_cache_use</code> status variable shows the number of transactions
that used this buffer (and possibly a temporary file) for storing statements.
The <code>Binlog_cache_disk_use</code> status variable shows how many of those
transactions actually did have to use a temporary file. These two variables
can be used for tuning <code>binlog_cache_size</code> to a large enough value that
avoids the use of temporary files.

</P>
<P>
The <code>max_binlog_cache_size</code> (default 4GB) can be used to restrict the
total size used to cache a multiple-statement transaction.  If a transaction
is larger than this, it will fail and roll back.

</P>
<P>
If you are using the update log or binary log, concurrent inserts will
be converted to normal inserts when using <code>CREATE ... SELECT</code> or
<code>INSERT ... SELECT</code>.
This is to ensure that you can re-create an exact copy of your tables by
applying the log on a backup.

</P>
<P>
The binary log format is different in versions 3.23, 4.0, and 5.0.0.
Those format changes were required to implement enhancements to replication.
MySQL 4.1 has the same binary log format as 4.0.
See section <A HREF="manual_Replication.html#Replication_Compatibility">6.5  Replication Compatibility Between MySQL Versions</A>.

</P>
<P>
By default, the binary log is not synchronized to disk at each write. So
if the operating system or machine (not only the MySQL server) crashes
there is a chance that the last statements of the binary log are lost. To
prevent this, you can make the binary log be synchronized to disk after
every Nth binary log write, with the <code>sync_binlog</code> global variable
(1 being the safest value, but also the slowest). See section <A HREF="manual_MySQL_Database_Administration.html#Server_system_variables">5.2.3  Server System Variables</A>.  Even with this set to 1, there is still the chance of an
inconsistency between the tables content and the binary log content in
case of crash. For example, if using <code>InnoDB</code> tables, and the MySQL
server processes a <code>COMMIT</code> statement, it writes the whole transaction
to the binary log and then commits this transaction into <code>InnoDB</code>. If
it crashes between those two operations, at restart the transaction will be
rolled back by InnoDB but still exist in the binary log. This problem can be
solved with the <code>--innodb-safe-binlog</code> option (available starting from
MySQL 4.1.3), which adds consistency between the content of <code>InnoDB</code>
tables and the binary log. For this option to really bring safety to you,
the MySQL server should also be configured to synchronize to disk, at every
transaction, the binary log (<code>sync_binlog=1</code>) and (which is true by
default) the <code>InnoDB</code> logs.  The effect of this option is that at restart
after a crash,
after doing a rollback of transactions, the MySQL server will cut rolled
back <code>InnoDB</code> transactions from the binary log. This ensures that the
binary log reflects the exact data of <code>InnoDB</code> tables, and so, that
the slave remains in sync with the master (not receiving a statement which
has been rolled back).  Note that <code>--innodb-safe-binlog</code> can be used
even if the MySQL server updates other storage engines than InnoDB. Only
statements/transactions affecting <code>InnoDB</code> tables are subject to
being removed from the binary log at <code>InnoDB</code>'s crash recovery.  If at
crash recovery the MySQL server discovers that the binary log is shorter
than it should have been (that is, it lacks at least one successfully committed
<code>InnoDB</code> transaction), which should not happen if <code>sync_binlog=1</code>
and the disk/filesystem do an actual sync when they are requested to (some
don't), it will print an error message ("The binary log &#60;name&#62; is shorter
than its expected size"). In this case, this binary log is not correct,
replication should be restarted from a fresh master's data snapshot.

</P>
<P>
Before MySQL 4.1.9, a write to a binary log file or binary log index file
that failed due to a full disk or an exceeded quota resulted in corruption
of the file.  Starting from MySQL 4.1.9, writes to the binary log file and
binary log index file are handled the same way as writes to <code>MyISAM</code>
tables.
See section <A HREF="manual_Problems.html#Full_disk">A.4.3  How MySQL Handles a Full Disk</A>.

</P>


<H3><A NAME="Slow_query_log" HREF="manual_toc.html#Slow_query_log">5.9.5  The Slow Query Log</A></H3>

<P>
<A NAME="IDX649"></A>
<A NAME="IDX650"></A>

</P>
<P>
When started with the <code>--log-slow-queries[=<var>file_name</var>]</code> option,
<code>mysqld</code> writes a log file containing all SQL statements that took
more than <code>long_query_time</code> seconds to execute. The time to acquire
the initial table locks are not counted as execution time.

</P>
<P>
If no <var>file_name</var> value is given, the default is the name of the
host machine with a suffix of <code>-slow.log</code>. If a filename is given,
but doesn't contain a path, the file is written in the data directory.

</P>
<P>
A statement is logged to the slow query log after it has been executed
and after all locks have been released. Log order may be different from
execution order.

</P>
<P>
The slow query log can be used to find queries that take a long time to
execute and are therefore candidates for optimization. However, examining a long
slow query log can become a difficult task. To make this easier, you
can pipe the slow query log through the <code>mysqldumpslow</code> command to
get a summary of the queries that appear in the log.

</P>

<P>
If you also use the <code>--log-long-format</code> when logging slow queries,
then queries that are not using indexes are logged as well.  See section <A HREF="manual_MySQL_Database_Administration.html#Server_options">5.2.1  <code>mysqld</code> Command-Line Options</A>.

</P>



<H3><A NAME="Log_file_maintenance" HREF="manual_toc.html#Log_file_maintenance">5.9.6  Log File Maintenance</A></H3>

<P>
<A NAME="IDX651"></A>
<A NAME="IDX652"></A>
<A NAME="IDX653"></A>

</P>
<P>
The MySQL Server can create a number of different log files that make
it easy to see what is going on. See section <A HREF="manual_MySQL_Database_Administration.html#Log_Files">5.9  The MySQL Log Files</A>. However, you must
clean up these files regularly to ensure that the logs don't take up
too much disk space.

</P>
<P>
When using MySQL with logging enabled, you will want to back up and remove
old log files from time to time and tell MySQL to start logging to new files.
See section <A HREF="manual_MySQL_Database_Administration.html#Backup">5.7.1  Database Backups</A>.

</P>
<P>
On a Linux (Red Hat) installation, you can use the
<code>mysql-log-rotate</code> script for this. If you installed MySQL
from an RPM distribution, the script should have been installed
automatically.  You should be careful with this script if you are
using the binary log for replication! (You should not remove binary logs until
you are certain that their contents have been processed by all slaves.)

</P>
<P>
On other systems, you must install a short script yourself that you
start from <code>cron</code> to handle log files.

</P>
<P>
You can force MySQL to start using new log files by using
<code>mysqladmin flush-logs</code> or by using the SQL statement <code>FLUSH LOGS</code>.
If you are using MySQL 3.21, you must use <code>mysqladmin refresh</code>.

</P>
<P>
A log flushing operation does the following:

</P>

<UL>
<LI>

If standard logging (<code>--log</code>) or slow query logging
(<code>--log-slow-queries</code>) is used, closes and reopens the log file
(<tt>`mysql.log'</tt> and <tt>``hostname`-slow.log'</tt> as default).
<LI>

If update logging (<code>--log-update</code>) or binary logging (<code>--log-bin</code>)
is used, closes the log and opens a new log file with a higher sequence number.
</UL>

<P>
If you are using only an update log, you only have to rename the log file
and then flush the logs before making a backup. For example, you can do
something like this:

</P>

<PRE>
shell&#62; cd mysql-data-directory
shell&#62; mv mysql.log mysql.old
shell&#62; mysqladmin flush-logs
</PRE>

<P>
Then make a backup and remove <tt>`mysql.old'</tt>.

</P>



<H2><A NAME="Multiple_servers" HREF="manual_toc.html#Multiple_servers">5.10  Running Multiple MySQL Servers on the Same Machine</A></H2>

<P>
<A NAME="IDX654"></A>
<A NAME="IDX655"></A>
<A NAME="IDX656"></A>
<A NAME="IDX657"></A>
<A NAME="IDX658"></A>

</P>

<P>
In some cases, you might want to run multiple <code>mysqld</code> servers
on the same machine.  You might want to test a new
MySQL release while leaving your existing production setup undisturbed.
Or you may want to give different users access to different <code>mysqld</code>
servers that they manage themselves.  (For example, you might be an
Internet Service Provider that wants to provide independent MySQL
installations for different customers.)

</P>
<P>
To run multiple servers on a single machine, each server must have
unique values for several operating parameters. These can be set on the
command line or in option files.
See section <A HREF="manual_Using_MySQL_Programs.html#Program_Options">4.3  Specifying Program Options</A>.

</P>
<P>
At least the following options must be different for each server:

</P>
<DL COMPACT>

<DT><code>--port=<var>port_num</var></code>
<DD>
<code>--port</code> controls the port number for TCP/IP connections.

<DT><code>--socket=<var>path</var></code>
<DD>
<code>--socket</code> controls the Unix socket file path on Unix and the name of the
named pipe on Windows. On Windows, it's necessary to specify distinct pipe names
only for those servers that support named pipe connections.

<DT><code>--shared-memory-base-name=<var>name</var></code>
<DD>
This option currently is used only on Windows.
It designates the shared memory name used by a
Windows server to allow clients to connect via shared memory.
This option is new in MySQL 4.1.

<DT><code>--pid-file=<var>path</var></code>
<DD>
This option is used only on Unix.
It indicates the name of the file in which the server writes its process ID.

</DL>

<P>
If you use the following log file options, they must be different for
each server:

</P>


<UL>
<LI><code>--log=<var>path</var></code>

<LI><code>--log-bin=<var>path</var></code>

<LI><code>--log-update=<var>path</var></code>

<LI><code>--log-error=<var>path</var></code>

<LI><code>--log-isam=<var>path</var></code>

<LI><code>--bdb-logdir=<var>path</var></code>

</UL>

<P>
Log file options are described in section <A HREF="manual_MySQL_Database_Administration.html#Log_file_maintenance">5.9.6  Log File Maintenance</A>.

</P>
<P>
If you want more performance, you can also specify the following options
differently for each server, to spread the load between several physical disks:

</P>

<UL>
<LI><code>--tmpdir=<var>path</var></code>

<LI><code>--bdb-tmpdir=<var>path</var></code>

</UL>

<P>
Having different temporary directories is also recommended, to make
it easier to determine which MySQL server created any given
temporary file.

</P>
<P>
Generally, each server should also use a different data directory, which is
specified using the <code>--datadir=path</code> option.

</P>
<P>
<strong>Warning:</strong> Normally you should never have two servers that
update data in the same databases!  This may lead to unpleasant
surprises if your operating system doesn't support fault-free system
locking!
If (despite this warning) you run multiple servers using
the same data directory and they have logging enabled, you must
use the appropriate options to specify log filenames that are
unique to each server.  Otherwise, the servers will try to log to
the same files.
Please note that this kind of setup will only work with <code>ISAM</code>,
<code>MyISAM</code> and <code>MERGE</code> tables, and not with any of the other
storage engines.

</P>
<P>
The warning against sharing a data directory among servers also applies
in an NFS environment.  Allowing multiple MySQL servers to access a common
data directory over NFS is a <em>bad idea</em>!

</P>

<UL>

<LI>

The primary problem is that NFS will become the speed bottleneck.
It is not meant for such use.

<LI>

Another risk with NFS is that you will have to come up with a way
to make sure that two or more servers do not interfere with each
other.  Usually NFS file locking is handled by the <code>lockd</code>
daemon, but at the moment there is no platform that will perform
locking 100% reliably in every situation.

</UL>

<P>
Make it easy for yourself: Forget about sharing a data directory
among servers over NFS. A better solution is to have one computer
that contains several CPUs and use an operating system that
handles threads efficiently.

</P>
<P>
If you have multiple MySQL installations in different locations, normally
you can specify the base installation directory for each server with the
<code>--basedir=path</code> option to cause each server to use a different data
directory, log files, and PID file. (The defaults for all these values are
determined relative to the base directory). In that case, the only other
options you need to specify are the <code>--socket</code> and <code>--port</code>
options.  For example, suppose that you install different versions of MySQL using
<tt>`tar'</tt> file binary distributions. These will install in different
locations, so you can start the server for each installation using the
command <code>bin/mysqld_safe</code> under its corresponding base directory.
<code>mysqld_safe</code> will determine the proper
<code>--basedir</code> option to pass to <code>mysqld</code>, and you need specify
only the <code>--socket</code> and <code>--port</code> options to <code>mysqld_safe</code>.
(For versions of MySQL older than 4.0, use <code>safe_mysqld</code>
rather than <code>mysqld_safe</code>.)

</P>
<P>
As discussed in the following sections, it is possible to start additional
servers by setting environment variables or by specifying appropriate
command-line options.  However, if you need to run multiple servers on
a more permanent basis, it will be more convenient to use option files
to specify for each server those option values that must be unique to it.

</P>



<H3><A NAME="Multiple_Windows_servers" HREF="manual_toc.html#Multiple_Windows_servers">5.10.1  Running Multiple Servers on Windows</A></H3>

<P>
You can run multiple servers on Windows by starting them manually from the
command line, each with appropriate operating parameters. On Windows NT-based
systems, you also have the option of installing several servers as Windows services
and running them that way. General instructions for running MySQL servers
from the command line or as services are given in section <A HREF="manual_Installing.html#Windows_installation">2.3  Installing MySQL on Windows</A>. This section
describes how to make sure that you start each server with different values for
those startup options that must be unique per server, such as the data
directory.  These options are described in section <A HREF="manual_MySQL_Database_Administration.html#Multiple_servers">5.10  Running Multiple MySQL Servers on the Same Machine</A>.

</P>



<H4><A NAME="Multiple_Windows_command-line_servers" HREF="manual_toc.html#Multiple_Windows_command-line_servers">5.10.1.1  Starting Multiple Windows Servers at the Command Line</A></H4>

<P>
To start multiple servers manually from the command line, you can specify the appropriate options on
the command line or in an option file. It's more convenient to place the
options in an option file, but it's necessary to make sure that each server
gets its own set of options. To do this, create an option file for each
server and tell the server the filename with a <code>--defaults-file</code> option
when you run it.

</P>
<P>
Suppose that you want to run <code>mysqld</code> on port 3307 with a
data directory of <tt>`C:\mydata1'</tt>, and <code>mysqld-max</code> on port 3308 with a
data directory of <tt>`C:\mydata2'</tt>. (To do this, make sure that before you
start the servers, each data directory exists and has its own copy of the
<code>mysql</code> database that contains the grant tables.)

</P>
<P>
Then create two option
files. For example, create one file named <tt>`C:\my-opts1.cnf'</tt> that looks
like this:

</P>

<PRE>
[mysqld]
datadir = C:/mydata1
port = 3307
</PRE>

<P>
Create a second file named <tt>`C:\my-opts2.cnf'</tt> that looks like this:

</P>

<PRE>
[mysqld]
datadir = C:/mydata2
port = 3308
</PRE>

<P>
Then start each server with its own option file:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqld --defaults-file=C:\my-opts1.cnf
C:\&#62; C:\mysql\bin\mysqld-max --defaults-file=C:\my-opts2.cnf
</PRE>

<P>
On NT, each server will start in the foreground (no new prompt appears until
the server exits later); you'll need to issue those two commands in separate
console windows.

</P>
<P>
To shut down the servers, you must connect to the appropriate port number:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqladmin --port=3307 shutdown
C:\&#62; C:\mysql\bin\mysqladmin --port=3308 shutdown
</PRE>

<P>
Servers configured as just described will allow clients to connect over
TCP/IP.  If your version of Windows supports named pipes and you also want
to allow named pipe connections, use the <code>mysqld-nt</code> or
<code>mysqld-max-nt</code> servers and specify options that enable the named pipe
and specify its name. Each server that supports named pipe connections must
use a unique pipe name.  For example, the <tt>`C:\my-opts1.cnf'</tt> file might
be written like this:

</P>

<PRE>
[mysqld]
datadir = C:/mydata1
port = 3307
enable-named-pipe
socket = mypipe1
</PRE>

<P>
Then start the server this way:

</P>

<PRE>
C:\&#62; C:\mysql\bin\mysqld-nt --defaults-file=C:\my-opts1.cnf
</PRE>

<P>
Modify <tt>`C:\my-opts2.cnf'</tt> similarly for use by the second server.

</P>


<H4><A NAME="Multiple_Windows_services" HREF="manual_toc.html#Multiple_Windows_services">5.10.1.2  Starting Multiple Windows Servers as Services</A></H4>

<P>
On NT-based systems, a MySQL server can be run as a Windows service. The
procedures for installing, controlling, and removing a single MySQL service are
described in section <A HREF="manual_Installing.html#Windows_start_service">2.3.12  Starting MySQL as a Windows Service</A>.

</P>
<P>
As of MySQL 4.0.2, you can install multiple servers as services.
In this case, you must make sure that each server uses a different
service name in addition to all the other parameters that must be unique per
server.

</P>
<P>
For the following instructions, assume that you want to run the <code>mysqld-nt</code>
server from two different versions of MySQL that are installed at
<tt>`C:\mysql-4.0.8'</tt> and <tt>`C:\mysql-4.0.17'</tt>, respectively. (This might be
the case if you're running 4.0.8 as your production server, but want to test
4.0.17 before upgrading to it.)

</P>
<P>
The following principles apply when installing a MySQL service with the
<code>--install</code> or <code>--install-manual</code> option:

</P>

<UL>

<LI>

If you specify no service name, the server uses the default service name of
<code>MySQL</code> and the server reads options from the <code>[mysqld]</code> group in
the standard option files.

<LI>

If you specify a service name after the
<code>--install</code> option, the server ignores the <code>[mysqld]</code> option
group and instead reads options from the group that has the same name as the
service. The server reads options from the standard option files.

<LI>

If you specify a <code>--defaults-file</code> option after the service name,
the server ignores the standard option files and reads options only from the
<code>[mysqld]</code> group of the named file.

</UL>

<P>
<strong>Note</strong>: Before MySQL 4.0.17, only a server installed using the default service
name (<code>MySQL</code>) or one installed explicitly with a service name of
<code>mysqld</code> will read the <code>[mysqld]</code> group in the standard option
files. As of 4.0.17, all servers read the <code>[mysqld]</code> group if they read
the standard option files, even if they are installed using another service
name. This allows you to use the <code>[mysqld]</code> group for options that should
be used by all MySQL services, and an option group named after each service
for use by the server installed with that service name.

</P>

<P>
Based on the preceding information, you have several ways to set
up multiple services.  The following instructions describe some
examples. Before trying any of them, be sure that you shut down and
remove any existing MySQL services first.

</P>

<UL>

<LI>

<strong>Approach 1:</strong>
Specify the options for all services in one of the standard option files.
To do this, use a different service name for each server.
Suppose that you want to run the 4.0.8 <code>mysqld-nt</code> using the service
name of <code>mysqld1</code> and the 4.0.17 <code>mysqld-nt</code> using the service name <code>mysqld2</code>.
In this case, you can use the <code>[mysqld1]</code> group for 4.0.8 and the
<code>[mysqld2]</code> group for 4.0.17.
For example, you can set up <tt>`C:\my.cnf'</tt> like this:


<PRE>
# options for mysqld1 service
[mysqld1]
basedir = C:/mysql-4.0.8
port = 3307
enable-named-pipe
socket = mypipe1

# options for mysqld2 service
[mysqld2]
basedir = C:/mysql-4.0.17
port = 3308
enable-named-pipe
socket = mypipe2
</PRE>

Install the services as follows, using the full server pathnames to ensure
that Windows registers the correct executable program for each service:


<PRE>
C:\&#62; C:\mysql-4.0.8\bin\mysqld-nt --install mysqld1
C:\&#62; C:\mysql-4.0.17\bin\mysqld-nt --install mysqld2
</PRE>

To start the services, use the services manager, or use <code>NET START</code>
with the appropriate service names:


<PRE>
C:\&#62; NET START mysqld1
C:\&#62; NET START mysqld2
</PRE>

To stop the services, use the services manager, or use <code>NET STOP</code>
with the appropriate service names:


<PRE>
C:\&#62; NET STOP mysqld1
C:\&#62; NET STOP mysqld2
</PRE>

<LI>

<strong>Approach 2:</strong>
Specify options for each server in separate files and use
<code>--defaults-file</code> when you install the services to tell each server
what file to use.  In this case, each file should list options using a
<code>[mysqld]</code> group.

With this approach, to specify options for the 4.0.8 <code>mysqld-nt</code>,
create a file <tt>`C:\my-opts1.cnf'</tt> that looks like this:


<PRE>
[mysqld]
basedir = C:/mysql-4.0.8
port = 3307
enable-named-pipe
socket = mypipe1
</PRE>

For the 4.0.17 <code>mysqld-nt</code>, create a file
<tt>`C:\my-opts2.cnf'</tt> that looks like this:


<PRE>
[mysqld]
basedir = C:/mysql-4.0.17
port = 3308
enable-named-pipe
socket = mypipe2
</PRE>

Install the services as follows (enter each command on a single line):


<PRE>
C:\&#62; C:\mysql-4.0.8\bin\mysqld-nt --install mysqld1
           --defaults-file=C:\my-opts1.cnf
C:\&#62; C:\mysql-4.0.17\bin\mysqld-nt --install mysqld2
           --defaults-file=C:\my-opts2.cnf
</PRE>

To use a <code>--defaults-file</code> option when you install a MySQL server as a
service, you must precede the option with the service name.

After installing the services, start and stop them the same way as in the
preceding example.

</UL>

<P>
To remove multiple services, use <code>mysqld --remove</code> for each one,
specifying a service name following the <code>--remove</code> option. If the
service name is the default (<code>MySQL</code>), you can omit it.

</P>



<H3><A NAME="Multiple_Unix_servers" HREF="manual_toc.html#Multiple_Unix_servers">5.10.2  Running Multiple Servers on Unix</A></H3>

<P>
The easiest way is to run multiple servers on Unix is to compile them
with different TCP/IP ports and Unix socket files so that each one is listening on
different network interfaces. Also, by compiling in different base directories
for each installation, that automatically results in different compiled-in
data directory, log file, and PID file locations for each of your servers.

</P>
<P>
Assume that an existing server is configured for the default TCP/IP port
number (3306) and Unix socket file (<tt>`/tmp/mysql.sock'</tt>).  To configure a
new server to have different operating parameters, use a <code>configure</code>
command something like this:

</P>

<PRE>
shell&#62; ./configure --with-tcp-port=<var>port_number</var> \
             --with-unix-socket-path=<var>file_name</var> \
             --prefix=/usr/local/mysql-4.0.17
</PRE>

<P>
Here, <var>port_number</var> and <var>file_name</var> must be different from the
default TCP/IP port number and Unix socket file pathname, and the
<code>--prefix</code> value should specify an installation directory different
than the one under which the existing MySQL installation is located.

</P>
<P>
If you have a MySQL server listening on a given port number, you can use the
following command to find out what operating parameters it is using for
several important configurable variables, including the base directory and
Unix socket filename:

</P>

<PRE>
shell&#62; mysqladmin --host=<var>host_name</var> --port=<var>port_number</var> variables
</PRE>

<P>
With the information displayed by that command, you can tell what option
values <em>not</em> to use when configuring an additional server.

</P>
<P>
Note that if you specify <code>localhost</code> as a hostname, <code>mysqladmin</code>
will default to using a Unix socket file connection rather than TCP/IP.
In MySQL 4.1, you can explicitly specify the connection protocol to use by
using the <code>--protocol={TCP | SOCKET | PIPE | MEMORY}</code> option.

</P>
<P>
You don't have to compile a new MySQL server just to start with a different
Unix socket file and TCP/IP port number.  It is also possible to specify
those values at runtime. One way to do so is by using command-line options:

</P>

<PRE>
shell&#62; mysqld_safe --socket=<var>file_name</var> --port=<var>port_number</var>
</PRE>

<P>
To start a second server, provide different <code>--socket</code> and
<code>--port</code> option values, and pass a <code>--datadir=<var>path</var></code> option to
<code>mysqld_safe</code> so that the server uses a different data directory.

</P>
<P>
Another way to achieve a similar effect is to use environment variables
to set the Unix socket filename and TCP/IP port number:

</P>
<P>
<A NAME="IDX659"></A>
<A NAME="IDX660"></A>
<A NAME="IDX661"></A>
<A NAME="IDX662"></A>

<PRE>
shell&#62; MYSQL_UNIX_PORT=/tmp/mysqld-new.sock
shell&#62; MYSQL_TCP_PORT=3307
shell&#62; export MYSQL_UNIX_PORT MYSQL_TCP_PORT
shell&#62; mysql_install_db --user=mysql
shell&#62; mysqld_safe --datadir=/path/to/datadir &#38;
</PRE>

<P>
This is a quick way of starting a second server to use
for testing.  The nice thing about this method is that the environment
variable settings will apply to any client programs that you invoke from
the same shell. Thus, connections for those clients automatically will
be directed to the second server!

</P>
<P>
section <A HREF="manual_Environment_variables.html#Environment_variables">F  Environment Variables</A> includes a list of other environment
variables you can use to affect <code>mysqld</code>.

</P>
<P>
For automatic server execution, your startup script that is executed
at boot time should execute the following command once for each
server with an appropriate option file path for each command:

</P>

<PRE>
mysqld_safe --defaults-file=path
</PRE>

<P>
Each option file should contain option values specific to a given server.

</P>
<P>
On Unix,
the <code>mysqld_multi</code> script is another way to start multiple servers.
See section <A HREF="manual_MySQL_Database_Administration.html#mysqld_multi">5.1.5  The <code>mysqld_multi</code> Program for Managing Multiple MySQL Servers</A>.

</P>



<H3><A NAME="Multiple-server_clients" HREF="manual_toc.html#Multiple-server_clients">5.10.3  Using Client Programs in a Multiple-Server Environment</A></H3>

<P>
When you want to connect with a client program to a MySQL server that is
listening to different network interfaces than those compiled into your
client, you can use one of the following methods:

</P>

<UL>
<LI>

Start the client with <code>--host=<var>host_name</var> --port=<var>port_number</var></code> to connect
via TCP/IP to a remote server, with <code>--host=127.0.0.1
--port=port_number</code> to connect via TCP/IP to a local server, or with
<code>--host=localhost --socket=<var>file_name</var></code> to connect to a local server via
a Unix socket file or a Windows named pipe.

<LI>

As of MySQL 4.1, start the client with <code>--protocol=tcp</code> to connect
via TCP/IP, <code>--protocol=socket</code> to connect via a Unix socket file,
<code>--protocol=pipe</code> to connect via a named pipe, or
<code>--protocol=memory</code> to connect via shared memory.  For TCP/IP
connections, you may also need to specify <code>--host</code> and <code>--port</code>
options.  For the other types of connections, you may need to specify
a <code>--socket</code> option to specify a Unix socket file or named pipe name, or a
<code>--shared-memory-base-name</code> option to specify the shared memory name.
Shared memory connections are supported only on Windows.

<LI>

<A NAME="IDX663"></A>
<A NAME="IDX664"></A>
<A NAME="IDX665"></A>
<A NAME="IDX666"></A>
On Unix, set the <code>MYSQL_UNIX_PORT</code> and <code>MYSQL_TCP_PORT</code>
environment variables to point to the Unix socket file and TCP/IP port
number before you start your clients.  If you normally use a specific socket
file or port number, you can place commands to set these environment
variables in your <tt>`.login'</tt> file so that they apply each time you log
in.
See section <A HREF="manual_Environment_variables.html#Environment_variables">F  Environment Variables</A>.

<LI>

<A NAME="IDX667"></A>
<A NAME="IDX668"></A>
Specify the default Unix socket file and TCP/IP port number in the
<code>[client]</code> group of an option file. For example, you can use
<tt>`C:\my.cnf'</tt> on Windows, or the <tt>`.my.cnf'</tt> file in your home
directory on Unix.
See section <A HREF="manual_Using_MySQL_Programs.html#Option_files">4.3.2  Using Option Files</A>.

<LI>

In a C program, you can specify the socket file or port number arguments in the
<code>mysql_real_connect()</code> call.  You can also have the program read
option files by calling <code>mysql_options()</code>.
See section <A HREF="manual_MySQL_APIs.html#C_API_functions">21.2.3  C API Function Descriptions</A>.

<LI>

If you are using the Perl <code>DBD::mysql</code> module, you can read options
from MySQL option files. For example:


<PRE>
$dsn = "DBI:mysql:test;mysql_read_default_group=client;"
        . "mysql_read_default_file=/usr/local/mysql/data/my.cnf";
$dbh = DBI-&#62;connect($dsn, $user, $password);
</PRE>

See section <A HREF="manual_MySQL_APIs.html#Perl">21.4  MySQL Perl API</A>.

Other programming interfaces may provide similar capabilities for reading
option files.

</UL>



<H2><A NAME="Query_Cache" HREF="manual_toc.html#Query_Cache">5.11  The MySQL Query Cache</A></H2>

<P>
<A NAME="IDX669"></A>
<A NAME="IDX670"></A>

</P>
<P>
From version 4.0.1 on, MySQL Server features a query cache.
When in use, the query cache stores the text of a <code>SELECT</code> query
together with the corresponding result that was sent to the client.
If the identical query is received later, the server retrieves
the results from the query cache rather than parsing and executing the
query again.

</P>
<P>
The query cache is extremely useful in an environment where (some)
tables don't change very often and you have a lot of identical queries.
This is a typical situation for many Web servers that generate a lot of
dynamic pages based on database content.

</P>
<P>
<strong>Note</strong>: The query cache does not return stale data. When tables
are modified, any relevant entries in the query cache are flushed.

</P>
<P>
<strong>Note</strong>: The query cache does not work in an environment where you
have many <code>mysqld</code> servers updating the same <code>MyISAM</code> tables.

</P>
<P>
Some performance data for the query cache follow. These results were 
generated by running the MySQL benchmark suite on a Linux Alpha
2 x 500MHz system with 2GB RAM and a 64MB query cache.

</P>

<UL>

<LI>

If all the queries you're performing are simple (such as selecting a row
from a table with one row), but still differ so that the queries cannot be
cached, the overhead for having the query cache active is 13%.  This could
be regarded as the worst case scenario. In real life, queries tend to be
much more complicated, so the overhead normally is significantly lower.

<LI>

Searches for a single row in a single-row table are 238% faster with the
query cache than without it.  This can be regarded as close to the minimum
speedup to be expected for a query that is cached.

</UL>

<P>
To disable the query cache at server startup, set the
<code>query_cache_size</code> system variable to 0.  By disabling the query cache
code, there is no noticeable overhead.  Query cache capabilities can be
excluded from the server entirely by using the <code>--without-query-cache</code>
option to <code>configure</code> when compiling MySQL.

</P>



<H3><A NAME="Query_Cache_How" HREF="manual_toc.html#Query_Cache_How">5.11.1  How the Query Cache Operates</A></H3>

<P>
This section describes how the query cache works when it is operational.
section <A HREF="manual_MySQL_Database_Administration.html#Query_Cache_Configuration">5.11.3  Query Cache Configuration</A> describes how to control whether or not it
is operational.

</P>
<P>
Queries are compared before parsing, so the following two queries are
regarded as different by the query cache:

</P>

<PRE>
SELECT * FROM <var>tbl_name</var>
Select * from <var>tbl_name</var>
</PRE>

<P>
Queries must be exactly the same (byte for byte) to be seen as identical.
In addition, query strings that are identical may be treated as different
for other reasons.  Queries that use different databases, different protocol
versions, or different default character sets are considered different
queries and are cached separately.

</P>
<P>
If a query result is returned from query cache, the server increments the
<code>Qcache_hits</code> status variable, not <code>Com_select</code>.
See section <A HREF="manual_MySQL_Database_Administration.html#Query_Cache_Status_and_Maintenance">5.11.4  Query Cache Status and Maintenance</A>.

</P>
<P>
If a table changes, then all cached queries that use the table become
invalid and are removed from the cache.  This includes queries that use
<code>MERGE</code> tables that map to the changed table.  A table can be changed
by many types of statements, such as <code>INSERT</code>, <code>UPDATE</code>,
<code>DELETE</code>, <code>TRUNCATE</code>, <code>ALTER TABLE</code>, <code>DROP TABLE</code>, or
<code>DROP DATABASE</code>.

</P>
<P>
Transactional <code>InnoDB</code> tables that have been changed are invalidated
when a <code>COMMIT</code> is performed.

</P>
<P>
In MySQL 4.0, the query cache is disabled within transactions (it does
not return results). Beginning with MySQL 4.1.1, the query cache also
works within transactions when using <code>InnoDB</code> tables (it uses the
table version number to detect whether or not its contents are still current).

</P>
<P>
Before MySQL 5.0, a query that begins with a leading comment might be cached,
but could not be fetched from the cache. This problem is fixed in MySQL 5.0.

</P>
<P>
The query cache works for <code>SELECT SQL_CALC_FOUND_ROWS ...</code> and
<code>SELECT FOUND_ROWS()</code> type queries.  <code>FOUND_ROWS()</code> returns
the correct value even if the preceding query was fetched from the cache
because the number of found rows is also stored in the cache.

</P>
<P>
A query cannot be cached if it contains any of the following functions:

</P>
<TABLE BORDER>
<TR><TD><code>BENCHMARK()</code>
 </TD><TD> <code>CONNECTION_ID()</code>
 </TD><TD> <code>CURDATE()</code>
</TD></TR>
<TR><TD><code>CURRENT_DATE()</code>
 </TD><TD> <code>CURRENT_TIME()</code>
 </TD><TD> <code>CURRENT_TIMESTAMP()</code>
</TD></TR>
<TR><TD><code>CURTIME()</code>
 </TD><TD> <code>DATABASE()</code>
 </TD><TD> <code>ENCRYPT()</code> with one parameter
</TD></TR>
<TR><TD><code>FOUND_ROWS()</code>
 </TD><TD> <code>GET_LOCK()</code>
 </TD><TD> <code>LAST_INSERT_ID()</code>
</TD></TR>
<TR><TD><code>LOAD_FILE()</code>
 </TD><TD> <code>MASTER_POS_WAIT()</code>
 </TD><TD> <code>NOW()</code>
</TD></TR>
<TR><TD><code>RAND()</code>
 </TD><TD> <code>RELEASE_LOCK()</code>
 </TD><TD> <code>SYSDATE()</code>
</TD></TR>
<TR><TD><code>UNIX_TIMESTAMP()</code> with no parameters
 </TD><TD> <code>USER()</code>
</TD></TR>
</TABLE>

<P>
A query also will not be cached under these conditions:

</P>

<UL>
<LI>

It contains user-defined functions (UDFs).

<LI>

It contains user variables.

<LI>

It refers to the tables in the <code>mysql</code> system database.

<LI>

It is of any of the following forms:


<PRE>
SELECT ... IN SHARE MODE
SELECT ... INTO OUTFILE ...
SELECT ... INTO DUMPFILE ...
SELECT * FROM ... WHERE autoincrement_col IS NULL
</PRE>

The last form is not cached because it is used as the ODBC workaround for
obtaining the last insert ID value.
See section <A HREF="manual_MySQL_Connectors.html#ODBC_and_last_insert_id">22.1.14.1  How to Get the Value of an <code>AUTO_INCREMENT</code> Column in ODBC</A>.

<LI>

It uses <code>TEMPORARY</code> tables.

<LI>

It does not use any tables.

<LI>

The user has a column-level privilege for any of the involved tables.

<LI>

Before a query is fetched from the query cache, MySQL checks that
the user has <code>SELECT</code> privilege for all the involved databases and
tables. If this is not the case, the cached result is not used.

</UL>



<H3><A NAME="Query_Cache_in_SELECT" HREF="manual_toc.html#Query_Cache_in_SELECT">5.11.2  Query Cache <code>SELECT</code> Options</A></H3>

<P>
There are two query cache-related options that may be
specified in a <code>SELECT</code> statement:

</P>
<P>
<A NAME="IDX671"></A>
<A NAME="IDX672"></A>

</P>
<DL COMPACT>

<DT><code>SQL_CACHE</code>
<DD>
The query result is cached if the value of the <code>query_cache_type</code>
system variable is <code>ON</code> or <code>DEMAND</code>.

<DT><code>SQL_NO_CACHE</code>
<DD>
The query result is not cached.

</DL>

<P>
Examples:

</P>

<PRE>
SELECT SQL_CACHE id, name FROM customer;
SELECT SQL_NO_CACHE id, name FROM customer;
</PRE>



<H3><A NAME="Query_Cache_Configuration" HREF="manual_toc.html#Query_Cache_Configuration">5.11.3  Query Cache Configuration</A></H3>

<P>
The <code>have_query_cache</code> server system variable indicates whether the query
cache is available:

</P>

<PRE>
mysql&#62; SHOW VARIABLES LIKE 'have_query_cache';
+------------------+-------+
| Variable_name    | Value |
+------------------+-------+
| have_query_cache | YES   |
+------------------+-------+
</PRE>

<P>
Several other system variables control query cache operation.
These can be set in an option file or on the command line
when starting <code>mysqld</code>.
The query cache-related system variables all have names that begin with
<code>query_cache_</code>. They are described briefly in section <A HREF="manual_MySQL_Database_Administration.html#Server_system_variables">5.2.3  Server System Variables</A>, with additional configuration information given here.

</P>
<P>
To set the size of the query cache, set the <code>query_cache_size</code> system
variable. Setting it to 0 disables the query cache. The default cache size
is 0; that is, the query cache is disabled.

</P>
<P>
If the query cache is enabled, the <code>query_cache_type</code> variable
influences how it works. This variable can be set to the following values:

</P>

<UL>
<LI>

A value of <code>0</code> or <code>OFF</code> prevents caching or retrieval of cached
results.

<LI>

A value of <code>1</code> or <code>ON</code> allows caching except of those statements
that begin with <code>SELECT SQL_NO_CACHE</code>.

<LI>

A value of <code>2</code> or <code>DEMAND</code> causes caching of only those statements
that begin with <code>SELECT SQL_CACHE</code>.

</UL>

<P>
Setting the <code>GLOBAL</code> value of <code>query_cache_type</code> determines query
cache behavior for all clients that connect after the change is made.
Individual clients can control cache behavior for their own connection by
setting the <code>SESSION</code> value of <code>query_cache_type</code>. For example, a
client can disable use of the query cache for its own queries like this:

</P>

<PRE>
mysql&#62; SET SESSION query_cache_type = OFF;
</PRE>

<P>
To control the maximum size of individual query results that can be cached,
set the <code>query_cache_limit</code> variable. The default value is 1MB.

</P>
<P>
The result of a query (the data sent to the client) is stored in the query
cache during result retrieval. Therefore the data usually is not handled in
one big chunk. The query cache allocates blocks for storing this data on
demand, so when one block is filled, a new block is allocated.  Because
memory allocation operation is costly (timewise), the query cache allocates
blocks with a minimum size given by the <code>query_cache_min_res_unit</code>
system variable.  When a query is executed, the last result block is trimmed
to the actual data size so that unused memory is freed.
Depending on the types of queries your server executes, you might find it
helpful to tune the value of <code>query_cache_min_res_unit</code>:

</P>

<UL>

<LI>

The default value of <code>query_cache_min_res_unit</code> is 4KB. This should
be adequate for most cases.

<LI>

If you have a lot of queries with small results, the default block size may
lead to memory fragmentation, as indicated by a large number of free blocks.
Fragmentation can force the query cache to prune (delete) queries from the
cache due to lack of memory.  In this case, you should decrease the value of
<code>query_cache_min_res_unit</code>.  The number of free blocks and queries
removed due to pruning are given by the values of the
<code>Qcache_free_blocks</code> and <code>Qcache_lowmem_prunes</code> status variables.

<LI>

If most of your queries have large results (check the
<code>Qcache_total_blocks</code> and <code>Qcache_queries_in_cache</code> status
variables), you can increase performance by increasing
<code>query_cache_min_res_unit</code>. However, be careful to not make it too
large (see the previous item).

</UL>

<P>
<code>query_cache_min_res_unit</code> is present from MySQL 4.1.

</P>



<H3><A NAME="Query_Cache_Status_and_Maintenance" HREF="manual_toc.html#Query_Cache_Status_and_Maintenance">5.11.4  Query Cache Status and Maintenance</A></H3>

<P>
You can check whether the query cache is present in your MySQL server using
the following statement:

</P>

<PRE>
mysql&#62; SHOW VARIABLES LIKE 'have_query_cache';
+------------------+-------+
| Variable_name    | Value |
+------------------+-------+
| have_query_cache | YES   |
+------------------+-------+
</PRE>

<P>
You can defragment the query cache to better utilize its memory
with the <code>FLUSH QUERY CACHE</code> statement.
The statement does not remove any queries from the cache.

</P>
<P>
The <code>RESET QUERY CACHE</code> statement removes all query results from the
query cache.  The <code>FLUSH TABLES</code> statement also does this.

</P>
<P>
To monitor query cache performance, use <code>SHOW STATUS</code> to view
the cache status variables:

</P>

<PRE>
mysql&#62; SHOW STATUS LIKE 'Qcache%';
+-------------------------+--------+
| Variable_name           | Value  |
+-------------------------+--------+
| Qcache_free_blocks      | 36     |
| Qcache_free_memory      | 138488 |
| Qcache_hits             | 79570  |
| Qcache_inserts          | 27087  |
| Qcache_lowmem_prunes    | 3114   |
| Qcache_not_cached       | 22989  |
| Qcache_queries_in_cache | 415    |
| Qcache_total_blocks     | 912    |
+-------------------------+--------+
</PRE>

<P>
Descriptions of each of these variables are given in
section <A HREF="manual_MySQL_Database_Administration.html#Server_status_variables">5.2.4  Server Status Variables</A>.  Some uses for them are described here.

</P>
<P>
The total number of <code>SELECT</code> queries is equal to:

</P>

<PRE>
  Com_select
+ Qcache_hits
+ queries with errors found by parser
</PRE>

<P>
The <code>Com_select</code> value is equal to:

</P>

<PRE>
  Qcache_inserts
+ Qcache_not_cached
+ queries with errors found during columns/rights check
</PRE>

<P>
The query cache uses variable-length blocks, so <code>Qcache_total_blocks</code>
and <code>Qcache_free_blocks</code> may indicate query cache memory fragmentation.
After <code>FLUSH QUERY CACHE</code>, only a single free block remains.

</P>
<P>
Every cached query requires a minimum of two blocks (one for the query
text and one or more for the query results). Also, every table that is used
by a query requires one block. However, if two or more queries use the same
table, only one block needs to be allocated.

</P>
<P>
The information provided by the <code>Qcache_lowmem_prunes</code> status variable
can help you tune the query cache size. It counts the number of queries that
have been removed from the cache to free up memory for caching new queries.
The query cache uses a least recently used (LRU) strategy to decide which
queries to remove from the cache. Tuning information is given in section <A HREF="manual_MySQL_Database_Administration.html#Query_Cache_Configuration">5.11.3  Query Cache Configuration</A>.

</P>

<P><HR><P>
Go to the <A HREF="manual_Introduction.html">first</A>, <A HREF="manual_Using_MySQL_Programs.html">previous</A>, <A HREF="manual_Replication.html">next</A>, <A HREF="manual_Concept_Index.html">last</A> section, <A HREF="manual_toc.html">table of contents</A>.
 </BODY>
 </HTML>
